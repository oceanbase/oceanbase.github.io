<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-blogs/arch/ob-430" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">OceanBase 4.3 - Milestone release for real-time AP analysis | OceanBase</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://oceanbase.github.io/docs/blogs/arch/ob-430"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="OceanBase 4.3 - Milestone release for real-time AP analysis | OceanBase"><meta data-rh="true" name="description" content="1713848983"><meta data-rh="true" property="og:description" content="1713848983"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://oceanbase.github.io/docs/blogs/arch/ob-430"><link data-rh="true" rel="alternate" href="https://oceanbase.github.io/docs/blogs/arch/ob-430" hreflang="en"><link data-rh="true" rel="alternate" href="https://oceanbase.github.io/docs/blogs/arch/ob-430" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6JQM9QDU5V-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.7e3a93fe.css">
<script src="/assets/js/runtime~main.063975e3.js" defer="defer"></script>
<script src="/assets/js/main.55b600f0.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="OceanBase Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="OceanBase Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">OceanBase</b></a><a class="navbar__item navbar__link" href="/docs/blogs/arch/all-in-one">Blogs</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Docs</a><ul class="dropdown__menu"><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">Product Docs</a><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">User Manual</a><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">Developer Manual</a></ul><ul class="dropdown__menu" style="left:160px;display:none"></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">Special Interest Group(SIG)</a><span><li><a href="http://github.com/oceanbase/oceanbase/discussions" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub Discussion<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://join.slack.com/t/oceanbase/shared_invite/zt-1e25oz3ol-lJ6YNqPHaKwY_mhhioyEuw" target="_blank" rel="noopener noreferrer" class="dropdown__link">Slack<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Forum (in Chinese)<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://stackoverflow.com/questions/tagged/oceanbase" target="_blank" rel="noopener noreferrer" class="dropdown__link">Stack Overflow<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span></ul><ul class="dropdown__menu" style="left:160px;display:none"></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Data + AI</a><ul class="dropdown__menu"><span><li><a href="https://oceanbase-devhub.github.io" target="_blank" rel="noopener noreferrer" class="dropdown__link">Devhub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><div style="padding: 0.25rem 0.5rem; font-size: 14px; color: #4e7ff1;">AI Workshops</div></li></span><span><li><a href="https://oceanbase-devhub.github.io/ai-workshop-2024" target="_blank" rel="noopener noreferrer" class="dropdown__link">RAG Bot<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://oceanbase-devhub.github.io/dify/dify@oceanbase-workshop" target="_blank" rel="noopener noreferrer" class="dropdown__link">Dify (MySQL Compatible)<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://oceanbase-devhub.github.io/DB-GPT/docker/compose_examples/ob_dbgpt_tutorial" target="_blank" rel="noopener noreferrer" class="dropdown__link">DB-GPT<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span></ul><ul class="dropdown__menu" style="left:160px;display:none"></ul></div><a href="https://en.oceanbase.com/softwarecenter" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Downloads<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/oceanbase" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/blogs/arch/all-in-one">Architectural Introduction</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/blogs/arch/all-in-one">Work with developers to create an all-in-one database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/blogs/arch/miniaturization">OceanBase 4.0 interpretation: Reduce the threshold of distributed database use, talk about our thinking on small specifications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/blogs/arch/ob-430">OceanBase 4.3 - Milestone release for real-time AP analysis</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/blogs/feat/io-isolation">Features Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/blogs/tech/adaptive-sql-execution-engine">Technical Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/blogs/users/AXA">Corporate Cases</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/blogs/showcases/architectural-evolution">Highlights</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/blogs/others/flink-and-ob">Others</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Architectural Introduction</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">OceanBase 4.3 - Milestone release for real-time AP analysis</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>OceanBase 4.3 - Milestone release for real-time AP analysis</h1></header><p><img decoding="async" loading="lazy" src="https://obcommunityprod.oss-cn-shanghai.aliyuncs.com/prod/blog/2024-04/1713848982839.png" alt="1713848983" class="img_ev3q"></p>
<p>In early 2023, OceanBase Database V4.1 was released. It is the first milestone version of the V4.x series and supports an integrated architecture for standalone and distributed modes. Such integrated architecture reduces the recovery time objective (RTO), a database reliability indicator, to less than 8 seconds, ensuring rapid database recovery from an unexpected failure. Unlike the V3.x series, the new version does not limit the number of partitions, providing higher capacity for processing large transactions. Core features such as the arbitration replica are supported to cut costs.</p>
<p>In September 2023, OceanBase Database V4.2.1 was released. As the first long-term supported (LTS) version of the V4.x series, it augments all core features of the V3.x series, and demonstrates improved performance in many aspects such as stability, scalability, support for small specifications, and ease of diagnostics. Six months after its release, hundreds of customers have deployed this LTS version in their production environments for stable operations.</p>
<p>To meet higher expectations on ease-of-use and capabilities of tackling miscellaneous workloads, we have released OceanBase Database V4.3.0, which is rigorously implemented on top of open design after thorough research.</p>
<p>OceanBase Database V4.3.0 sets a significant milestone on our roadmap to achieve real-time analytical processing (AP). This version provides a columnar engine based on the log-structured merge-tree (LSM-tree) architecture, which implements hybrid columnar and row-based storage. The database also introduces a new vectorized engine based on column data format descriptions and a cost model based on columnar storage. This way, wide tables can be effectively processed and the query performance in AP scenarios is significantly improved without affecting transactional processing (TP) business scenarios. Overall, the new OceanBase Database version is well-suited for mixed workload scenarios involving complex analytics, real-time reporting, real-time data warehousing, and online transactions. The materialized view feature is provided. Query results are pre-calculated and stored in materialized views to improve real-time query performance, and support rapid report generation and data analysis. The kernel in the new version also extends online DDL and adds support for tenant cloning. It has optimized performance and system resource usage, and provides better system usability. In a test with the same hardware configurations, the performance of OceanBase Database V4.3.0 in wide-table queries is comparable with mainstream columnstore databases in the industry.</p>
<p>Now, let&#x27;s take a closer look at key updates of OceanBase Database V4.3.0:</p>
<p>○ TP and AP integration</p>
<p>○ High-performance kernel</p>
<p>○ Higher computing performance</p>
<p>○ Ease-of-use enhancements</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="i-tp-and-ap-integration"><strong>I. TP and AP integration</strong><a href="#i-tp-and-ap-integration" class="hash-link" aria-label="Direct link to i-tp-and-ap-integration" title="Direct link to i-tp-and-ap-integration">​</a></h2>
<p>In addition to features of V4.2, such as highly concurrent real-time row updates, and point queries of the primary key indexes, OceanBase Database V4.3.0 introduces more AP services. Its scalable distributed architecture also supports high availability, strong consistency, and geo-disaster recovery. The new version provides a columnar engine and enhances vectorized execution, parallel computing, and distributed plan optimization. This way, the database supports both TP and AP business.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-integrated-columnar-and-row-based-storage"><strong>(1) Integrated columnar and row-based storage</strong><a href="#1-integrated-columnar-and-row-based-storage" class="hash-link" aria-label="Direct link to 1-integrated-columnar-and-row-based-storage" title="Direct link to 1-integrated-columnar-and-row-based-storage">​</a></h3>
<p>Columnar storage is one of the key capabilities of AP databases in complex large-scale data analysis and ad hoc queries of massive data. Columnar storage is a way to organize data files. Different from row-based storage, columnar storage physically arranges data in a table by column. When data is stored by column, the system can scan only the columns involved in the query and calculation, instead of scanning the entire row. This way, the consumption of resources such as I/O and memory is reduced and the calculation is accelerated. Moreover, columnar storage naturally provides better data compression conditions, making it easier to achieve higher compression ratios, thereby reducing storage space and network transmission bandwidth.</p>
<p>However, columnar engines generally assume limited random updates and attempt to ensure that data in columnar storage is static. When a large amount of data is updated randomly, system performance will inevitably degrade. The LSM-tree architecture of OceanBase Database can process baseline data and incremental data separately, and therefore can solve the performance issue. Therefore, OceanBase Database V4.3.0 supports the columnar engine based on the current architecture, implementing integrated columnar and row-based data storage on an OBServer node with only one set of code and one architecture, and ensuring the performance of both TP and AP queries.</p>
<p>To help users with AP requirements smoothly use the new version, OceanBase Database has adapted and optimized several modules, including the optimizer, executor, DDL, and transaction processing, for the columnar engine. These optimizations introduce a new cost model and vectorized engine based on columnar storage, enhancements to the query pushdown feature, and features like skip index, a new column-based encoding algorithm, and adaptive compactions.</p>
<p>To make AP queries easy, we recommend that you run the following command in a MySQL or Oracle tenant of OceanBase Database to create a columnstore table by default:</p>
<div class="language-SQL language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">alter</span><span class="token plain"> system </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> default_table_store_format </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;column&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can flexibly create a business table as a rowstore table, columnstore table, or hybrid rowstore-columnstore table based on the load type. You can also create a columnstore index for a rowstore table.</p>
<p><img decoding="async" loading="lazy" src="https://obcommunityprod.oss-cn-shanghai.aliyuncs.com/prod/blog/2024-04/1713849285226.png" alt="1713849286" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="https://obcommunityprod.oss-cn-shanghai.aliyuncs.com/prod/blog/2024-04/1713849296536.png" alt="1713849297" class="img_ev3q"></p>
<p>The optimizer determines, based on estimated costs, whether to scan a hybrid rowstore-columnstore table by row or by column.</p>
<p><img decoding="async" loading="lazy" src="https://obcommunityprod.oss-cn-shanghai.aliyuncs.com/prod/blog/2024-04/1713849310310.png" alt="1713849311" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-new-vectorized-engine"><strong>(2) New vectorized engine</strong><a href="#2-new-vectorized-engine" class="hash-link" aria-label="Direct link to 2-new-vectorized-engine" title="Direct link to 2-new-vectorized-engine">​</a></h3>
<p>Earlier versions of OceanBase Database have implemented a vectorized engine based on uniform data format descriptions, offering performance significantly better than that of non-vectorized engines. However, the engine still has some performance deficiencies in deep AP scenarios. OceanBase Database V4.3.0 implements the vectorized engine 2.0, which is based on column data format descriptions, avoiding the memory usage, serialization, and read/write access overhead caused by ObDatum maintenance. Based on the reconstruction of data format descriptions, the new vectorized engine also reimplements more than 10 commonly used operators such as HashJoin, AGGR, HashGroupBy, and Exchange (DTL Shuffle), as well as over 20 MySQL expressions including relational operations, logical operations, and arithmetic operations. Subsequent V4.3.x versions will further improve and implement other operators and expressions based on the new vectorized engine to achieve better performance.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-materialized-views"><strong>(3) Materialized views</strong><a href="#3-materialized-views" class="hash-link" aria-label="Direct link to 3-materialized-views" title="Direct link to 3-materialized-views">​</a></h3>
<p>OceanBase Database V4.3.0 introduces materialized views. Materialized views are a key feature for AP business scenarios. By precomputing and storing the query results of views, real-time calculations are reduced to improve query performance and simplify complex query logic. Materialized views are commonly used for rapid report generation and data analysis scenarios.</p>
<p>Materialized views need to store query result sets to optimize the query performance. Due to data dependency between a materialized view and its base tables, data in the materialized view must be refreshed accordingly when data in any base tables changes. Therefore, the materialized view refresh mechanism is also introduced in the new version, including complete refresh and incremental refresh strategies. Complete refresh is a relatively direct method. Each time a refresh operation is performed, the system re-executes the corresponding query statement of a materialized view to recalculate and overwrite the original result set. This method is applicable to scenarios with a small amount of data. Incremental refresh, by contrast, only deals with data that has been changed since the last refresh. To achieve accurate incremental refresh, OceanBase Database implements a materialized view log feature that is similar to Oracle Materialized View Log (MLOG). The feature tracks incremental data updates in base tables and records the updates in logs. This ensures that materialized views can be refreshed incrementally in a short period. Incremental refresh is particularly useful in business scenarios with large data volume and frequent data changes.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ii-high-performance-kernel"><strong>II. High-performance kernel</strong><a href="#ii-high-performance-kernel" class="hash-link" aria-label="Direct link to ii-high-performance-kernel" title="Direct link to ii-high-performance-kernel">​</a></h2>
<p>The kernel in the new version has enhanced the cost model, added support for tenant cloning, extended online DDL, and Amazon Simple Storage Service (S3) as the backup and restore media, restructured the session management module, and optimized log stream state machine and system resource usage, to improve database performance and stability in handling key business workloads.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-enhanced-row-estimation-system"><strong>(1) Enhanced row estimation system</strong><a href="#1-enhanced-row-estimation-system" class="hash-link" aria-label="Direct link to 1-enhanced-row-estimation-system" title="Direct link to 1-enhanced-row-estimation-system">​</a></h3>
<p>As the OceanBase Database version evolves, more cost estimation methods are available for the optimizer. For row estimation of each operator, a variety of algorithms, such as row estimation based on the storage layer, row estimation based on statistics, dynamic sampling, and default statistics, are supported. However, there are no clear strategies and complete control methods for using row estimation. OceanBase Database V4.3.0 reconstructs the row estimation system. Specifically, it prioritizes row estimation strategies based on scenarios and provides methods such as hints and system variables for you to manually intervene the selection of a row estimation strategy. This version also enhances the predicate selectivity and number of distinct values (NDV) calculation framework to improve the accuracy of cost estimation by the optimizer.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-enhanced-statistics"><strong>(2) Enhanced statistics</strong><a href="#2-enhanced-statistics" class="hash-link" aria-label="Direct link to 2-enhanced-statistics" title="Direct link to 2-enhanced-statistics">​</a></h3>
<p>OceanBase Database V4.3.0 improves the statistics feature, statistics collection performance, and the compatibility and usability of statistics. Specifically, this version reconstructs the offline statistics collection process to improve the collection efficiency, optimizes the statistics collection strategies to automatically collect information about index histograms by default and collect statistics in a deductive manner, and ensures transaction consistency for online statistics collection. It is compatible with the <code>DBMS_STATS.COPY_TABLE_STATS</code> procedure of Oracle for statistics copying, and is also compatible with the <code>ANALYZE TABLE</code> statement of MySQL. It provides a command to cancel statistics collection, enriches the monitoring on the statistics collection progress, and enhances maintenance usability. It also supports the parallel deletion of statistics.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-adaptive-cost-model"><strong>(3) Adaptive cost model</strong><a href="#3-adaptive-cost-model" class="hash-link" aria-label="Direct link to 3-adaptive-cost-model" title="Direct link to 3-adaptive-cost-model">​</a></h3>
<p>In earlier versions of OceanBase Database, the cost model uses constant parameters measured by internal machines to represent hardware system statistics, and describes the execution overhead of each operator by using a series of formulas and constant parameters. However, in real business scenarios, different hardware environments may have different CPU clock frequencies, sequential or random read speeds, and NIC bandwidths, thereby resulting in cost estimation deviations. The optimizer cannot generate optimal plans in different business environments because of these deviations. The new version implements the cost model in an optimized way to support the <code>DBMS_STATS</code> package for collecting or setting system statistics coefficients, thus adapting the cost model to hardware. It also provides the <code>DBA_OB_AUX_STATISTICS</code> view to display the system statistics coefficients of the current tenant.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-fixed-session-variables-for-function-based-indexes"><strong>(4) Fixed session variables for function-based indexes</strong><a href="#4-fixed-session-variables-for-function-based-indexes" class="hash-link" aria-label="Direct link to 4-fixed-session-variables-for-function-based-indexes" title="Direct link to 4-fixed-session-variables-for-function-based-indexes">​</a></h3>
<p>When a function-based index is created on a table, a hidden virtual generated column is added to the table and defined as the index key of the function-based index. The values of the virtual generated column are stored in the index table. The results of some built-in system functions are affected by session variables. The calculation result of a function varies based on the values of session variables, even if the input arguments are the same. When a function-based index or generated column is created in this version, session variables on which the function-based index or generated column depends are fixed in the column schema to improve stability. When values of the indexed column or generated column are calculated, fixed session variable values are used. Therefore, the calculation result is not affected by variable values in the current session. OceanBase Database V4.3.0 supports fixed values of the system variables <code>timezone_info</code>, <code>nls_format</code>, <code>nls_collation</code>, and <code>sql_mode</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-online-ddl-expansion-in-mysql-mode"><strong>(5) Online DDL expansion in MySQL mode</strong><a href="#5-online-ddl-expansion-in-mysql-mode" class="hash-link" aria-label="Direct link to 5-online-ddl-expansion-in-mysql-mode" title="Direct link to 5-online-ddl-expansion-in-mysql-mode">​</a></h3>
<p>OceanBase Database V4.3.0 supports more online DDL scenarios for column type changes, including:</p>
<p>○ Conversion of integer types: Online DDL operations, instead of offline DDL operations, are performed to change the data type of a primary key column, index column, generated column, column on which a generated column depends, or column with a <code>UNIQUE</code> or <code>CHECK</code> constraint to an integer type with a larger value range.</p>
<p>○ Conversion of the DECIMAL data type: For columns that support the DECIMAL data type, online DDL operations are performed to increase the precision within any of the [1,9], [10,18], [19,38], and [39,76] ranges without changing the scale.</p>
<p>○ Conversion of the BIT or CHAR data type: For columns that support the BIT or CHAR data type, online DDL operations are performed to increase the width.</p>
<p>○ Conversion of the VARCHAR or VARBINARY data type: For columns that support the VARCHAR or VARBINARY data type, online DDL operations are performed to increase the width.</p>
<p>○ Conversion of the LOB data type: To change the data type of a column that supports LOB data types to a LOB data type with a larger value range, offline DDL operations are performed for columns of the TINYTEXT or TINYBLOB data type, and online DDL operations are performed for columns of other data types.</p>
<p>○ Conversion between the TINYTEXT and VARCHAR data types: For columns that support the TINYTEXT data type, online DDL operations are performed to change the VARCHAR(x) data type to the TINYTEXT data type if <code>x &lt;= 255</code>, and offline DDL operations are performed if otherwise. For columns that support the VARCHAR data type, online DDL operations are performed to change the TINYTEXT data type to the VARCHAR(x) data type if <code>x &gt;= 255</code>, and offline DDL operations are performed if otherwise.</p>
<p>○ Conversion between the TINYBLOB and VARBINARY data types: For columns that support the TINYBLOB data type, online DDL operations are performed to change the VARBINARY(x) data type to the TINYBLOB data type if <code>x &lt;= 255</code>, and offline DDL operations are performed if otherwise. For columns that support the VARBINARY data type, online DDL operations are performed to change the TINYBLOB data type to the VARBINARY(x) data type if <code>x &gt;= 255</code>, and offline DDL operations are performed if otherwise.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="6-globally-unique-client-session-id"><strong>(6) Globally unique client session ID</strong><a href="#6-globally-unique-client-session-id" class="hash-link" aria-label="Direct link to 6-globally-unique-client-session-id" title="Direct link to 6-globally-unique-client-session-id">​</a></h3>
<p>Prior to OceanBase Database V4.3.0 and OceanBase Database Proxy (ODP) V4.2.3, when the client executes <code>SHOW PROCESSLIST</code> through ODP, the client session ID in ODP is returned. However, when the client queries the session ID by using an expression such as <code>connection_id</code> or from a system view, the session ID on the server is returned. A client session ID corresponds to multiple server session IDs. This causes confusion in session information queries and makes user session management difficult. In the new version, the client session ID generation and maintenance process is reconstructed. When the version of OceanBase Database is not earlier than V4.3.0 and the version of ODP is not earlier than V4.2.3, the session IDs returned by various channels, such as the <code>SHOW PROCESSLIST</code> command, the <code>information_schema.PROCESSLIST</code> and <code>GV$OB_PROCESSLIST</code> views, and the <code>connection_id</code>, <code>userenv(&#x27;sid&#x27;)</code>, <code>userenv(&#x27;sessionid&#x27;)</code>, <code>sys_context(&#x27;userenv&#x27;,&#x27;sid&#x27;)</code>, and <code>sys_context(&#x27;userenv&#x27;,&#x27;sessionid&#x27;)</code> expressions, are all client session IDs. You can specify a client session ID in the SQL or PL command <code>KILL</code> to terminate the corresponding session. If the preceding version requirements for OceanBase Database and ODP are not met, the handling method in earlier versions is used.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="7-improvement-of-the-log-stream-state-machine"><strong>(7) Improvement of the log stream state machine</strong><a href="#7-improvement-of-the-log-stream-state-machine" class="hash-link" aria-label="Direct link to 7-improvement-of-the-log-stream-state-machine" title="Direct link to 7-improvement-of-the-log-stream-state-machine">​</a></h3>
<p>In OceanBase Database V4.3.0, the log stream status is split into the in-memory status and persistent status. The persistent status indicates the life cycle of a log stream. After the OBServer node where a log stream resides breaks down and then restarts, the system determines whether the log stream should exist and what the in-memory status of the log stream should be based on the persistent status of the log stream. The in-memory status indicates the runtime status of a log stream, representing the overall status of the log stream and the status of key submodules. Based on the explicit status and status sequence of the log stream, underlying modules can determine which operations are safe to the log stream and whether the log stream has gone through a status change of the ABA type. For backup and restore or migration processes, the working status of a log stream is optimized after the OBServer node where the log stream resides restarts. This feature improves the stability of log stream-related features and enhances the concurrency control on log streams.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="8-tenant-cloning"><strong>(8) Tenant cloning</strong><a href="#8-tenant-cloning" class="hash-link" aria-label="Direct link to 8-tenant-cloning" title="Direct link to 8-tenant-cloning">​</a></h3>
<p>OceanBase Database V4.3.0 supports tenant cloning. You can quickly clone a specified tenant by executing an SQL statement in the sys tenant. After a tenant cloning job is completed, the created new tenant is a standby tenant. You can convert the standby tenant into the primary tenant to provide services. The new tenant and the source tenant share physical macroblocks in the initial state, but new data changes and resource usage are isolated between the tenants. You can clone an online tenant for temporary data analysis with high resource consumption or other high-risk operations to avoid risking the online tenant. In addition, you can also clone a tenant for disaster recovery. When irrecoverable misoperations are performed in the source tenant, you can use the new tenant for data rollback.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="9-support-for-s3-as-the-backup-and-restore-media"><strong>(9) Support for S3 as the backup and restore media</strong><a href="#9-support-for-s3-as-the-backup-and-restore-media" class="hash-link" aria-label="Direct link to 9-support-for-s3-as-the-backup-and-restore-media" title="Direct link to 9-support-for-s3-as-the-backup-and-restore-media">​</a></h3>
<p>Earlier versions of OceanBase Database support two types of storage media for backup and restore: file storage (NFS) and object storage such as Alibaba Cloud Object Storage Service (OSS) and Tencent Cloud Object Storage (COS). The new version supports Amazon Simple Storage Service (S3) and S3-compatible object storage like Huawei Cloud Object Storage Service (OBS) and Google Cloud Storage (GCS) as the log archive and data backup destination. You can also use backup data on S3 and S3-compatible object storage for physical restore.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="10-proactive-broadcastrefresh-of-tablet-locations"><strong>(10) Proactive broadcast/refresh of tablet locations</strong><a href="#10-proactive-broadcastrefresh-of-tablet-locations" class="hash-link" aria-label="Direct link to 10-proactive-broadcastrefresh-of-tablet-locations" title="Direct link to 10-proactive-broadcastrefresh-of-tablet-locations">​</a></h3>
<p>In earlier versions, OceanBase Database provides the periodic location cache refresh mechanism to ensure that the location information of log streams is updated in real time and consistent. However, tablet location information can only be passively refreshed. Changes in the mappings between tablets and log streams can trigger SQL retries and read/write errors with a certain probability. OceanBase Database V4.3.0 supports proactive broadcast of tablet locations to reduce SQL retries and read/write errors caused by changes in mappings after transfer. It also supports proactive refresh to avoid unrecoverable read/write errors.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-migration-of-active-transactions-during-tablet-transfer"><strong>(11) Migration of active transactions during tablet transfer</strong><a href="#11-migration-of-active-transactions-during-tablet-transfer" class="hash-link" aria-label="Direct link to 11-migration-of-active-transactions-during-tablet-transfer" title="Direct link to 11-migration-of-active-transactions-during-tablet-transfer">​</a></h3>
<p>In the design of standalone log streams, data is in the unit of tablets, while logs are in the unit of log streams. Multiple tablets are aggregated into one log stream, saving the high cost of two-phase commit of transactions within a single log stream. To balance data and traffic among different log streams, tablets can be flexibly transferred between log streams. However, during the tablet transfer process, active transactions may still be handling the data, and even a simple operation may damage the atomicity, consistency, isolation, and durability (ACID) of the transactions. For example, if active transaction data on the transfer source cannot be completely migrated to the transfer destination during concurrent transaction execution, the atomicity of the transactions cannot be guaranteed. In earlier versions, active transactions were killed during the transfer to avoid transaction problems. This mechanism affects the normal execution of transactions to some extent. To solve this problem, the new version supports the migration of active transactions during tablet transfer, which enables concurrent execution of active transactions and ensures that no abnormal rollbacks or consistency issues occur in concurrent transactions due to the transfer.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-memory-throttling-mechanism"><strong>(12) Memory throttling mechanism</strong><a href="#12-memory-throttling-mechanism" class="hash-link" aria-label="Direct link to 12-memory-throttling-mechanism" title="Direct link to 12-memory-throttling-mechanism">​</a></h3>
<p>Prior to OceanBase Database V4.x, only a few modules release memory based on freezes and minor compactions, and the MemTable is the largest part among them. Therefore, in earlier versions, an upper limit is set for memory usage of the MemTable, enabling it to run as smoothly as possible within the memory usage limit and avoiding writing failures caused by sudden memory exhaustion. In OceanBase Database V4.x, more modules that release memory based on freezes and minor compactions are introduced, such as the transaction data module. The new version provides more refined means to control the memory usage of various modules and supports the memory upper limit control of TxData and metadata service (MDS) modules. The two modules share memory space with the MemTable. When the sum of the memory usage of the three modules reaches <code>Tenant memory × _tx_share_memory_limit_percentage% × writing_throttling_trigger_percentage%</code>, overall memory throttling is triggered for the three modules. The new version also supports freezes and minor compactions of the transaction data table by time to reduce the memory usage of the transaction data module. By default, the transaction data table is frozen once every 1,800 seconds.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="13-optimization-of-ddl-temporary-result-space"><strong>(13) Optimization of DDL temporary result space</strong><a href="#13-optimization-of-ddl-temporary-result-space" class="hash-link" aria-label="Direct link to 13-optimization-of-ddl-temporary-result-space" title="Direct link to 13-optimization-of-ddl-temporary-result-space">​</a></h3>
<p>During the DDL operations, many processes may store temporary results in materialized structures. Here are two typical scenarios: (1) During index creation, the system scans data in the base data table and sorts and inserts the obtained data to the index table. If the memory is insufficient during the sorting process, current data in the memory space will be temporarily stored in materialized structures to release the memory space for subsequent scanning. Data in the materialized structures is then merged and sorted. (2) In the columnar storage bypass import scenario, the system first temporarily stores the data to be inserted into each column group in materialized structures, and then obtains data from the materialized structures for insertion. These materialized structures can be used in the <code>SORT</code> operator to store intermediate data required for external sorting. When the system inserts data into column groups, the data can be cached in materialized structures, avoiding additional overhead caused by repeated table scanning. As a result, the temporary files occupy considerable disk space. The new version eliminates unnecessary redundant structures to simplify the data flow, and supports encoding and compression of temporary results for storage on disks. This greatly reduces the disk space occupied by temporary files.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="iii-higher-computing-performance"><strong>III. Higher computing performance</strong><a href="#iii-higher-computing-performance" class="hash-link" aria-label="Direct link to iii-higher-computing-performance" title="Direct link to iii-higher-computing-performance">​</a></h2>
<p>The online analytical processing (OLAP) capabilities are significantly enhanced in the new version, achieving a performance boost in TPC-H 1TB and TPC-DS 1TB tests. The new version also optimizes PDML, read and write operations in OBKV, bypass import performance of LOB data, and node restart performance.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-increased-performance-in-the-tpc-h-1tb-test"><strong>(1) Increased performance in the TPC-H 1TB test</strong><a href="#1-increased-performance-in-the-tpc-h-1tb-test" class="hash-link" aria-label="Direct link to 1-increased-performance-in-the-tpc-h-1tb-test" title="Direct link to 1-increased-performance-in-the-tpc-h-1tb-test">​</a></h3>
<p>The following figure shows the performance of a tenant with 80 CPU cores and 500 GB of memory of different OceanBase Database versions in the TPC-H 1TB test. Overall, the performance of V4.3.0 is about 25% higher than that of V4.2.0.</p>
<p><img decoding="async" loading="lazy" src="https://obcommunityprod.oss-cn-shanghai.aliyuncs.com/prod/blog/2024-04/1713849771931.png" alt="1713849772" class="img_ev3q"></p>
<p>Figure 1: Performance of V4.3.0 and V4.2.0 in the TPC-H 1TB test</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-increased-performance-in-tpc-ds-1tb-test"><strong>(2) Increased performance in TPC-DS 1TB test</strong><a href="#2-increased-performance-in-tpc-ds-1tb-test" class="hash-link" aria-label="Direct link to 2-increased-performance-in-tpc-ds-1tb-test" title="Direct link to 2-increased-performance-in-tpc-ds-1tb-test">​</a></h3>
<p>The following figure shows the performance of a tenant with 80 CPU cores and 500 GB of memory of different OceanBase Database versions in the TPC-DS 1TB test. Overall, the performance of V4.3.0 is about 111% higher than that of V4.2.0.</p>
<p><img decoding="async" loading="lazy" src="https://obcommunityprod.oss-cn-shanghai.aliyuncs.com/prod/blog/2024-04/1713849828408.png" alt="1713849829" class="img_ev3q"></p>
<p>Figure 2: Performance of V4.3.0 and V4.2.0 in the TPC-DS 1TB test</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-obkv-performance-optimization"><strong>(3) OBKV performance optimization</strong><a href="#3-obkv-performance-optimization" class="hash-link" aria-label="Direct link to 3-obkv-performance-optimization" title="Direct link to 3-obkv-performance-optimization">​</a></h3>
<p>Compared with those in V4.2.1, the OBKV single-row read-write performance is improved by about 70%, and the batch read-write performance is improved by 80% to 220%.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-pdml-transaction-optimization"><strong>(4) PDML transaction optimization</strong><a href="#4-pdml-transaction-optimization" class="hash-link" aria-label="Direct link to 4-pdml-transaction-optimization" title="Direct link to 4-pdml-transaction-optimization">​</a></h3>
<p>The new version implements optimizations at the transaction layer by supporting parallel commit, log replay, and partition-level rollbacks within transaction participants. Compared with earlier V4.x versions, the new version significantly improves the PDML execution performance and scalability in high concurrency scenarios.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-io-usage-optimization-for-loading-tablet-metadata"><strong>(5) I/O usage optimization for loading tablet metadata</strong><a href="#5-io-usage-optimization-for-loading-tablet-metadata" class="hash-link" aria-label="Direct link to 5-io-usage-optimization-for-loading-tablet-metadata" title="Direct link to 5-io-usage-optimization-for-loading-tablet-metadata">​</a></h3>
<p>OceanBase Database V4.x supports millions of partitions on a single machine. As the memory may fail to hold the metadata of millions of tablets, OceanBase Database V4.x supports on-demand loading of tablet metadata. OceanBase Database supports on-demand loading of metadata at the partition level and the subclass level within partitions. In a partition, metadata is split into multiple subclasses for hierarchical storage. In scenarios where background tasks require deeper metadata, the data read consumes more I/O resources. These I/O overheads are not a problem for local SSD disks, but may affect system performance when HDD disks or cloud disks are used. OceanBase Database V4.3.0 aggregates frequently accessed metadata in storage, and only one I/O operation is required to access the metadata. This greatly reduces the I/O overhead in zero load scenarios and avoids the impact on foreground query performance caused by background task I/O overhead. In addition, the metadata loading process during the restart of an OBServer node is optimized. Tablet metadata is loaded in batches at the granularity of macroblocks, greatly reducing discrete I/O reads and speeding up the restart by several or even dozens of times.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="iv-ease-of-use-enhancements"><strong>IV. Ease-of-use enhancements</strong><a href="#iv-ease-of-use-enhancements" class="hash-link" aria-label="Direct link to iv-ease-of-use-enhancements" title="Direct link to iv-ease-of-use-enhancements">​</a></h2>
<p>The new version provides the index use monitoring feature to help you identify and delete invalid indexes, and allows you to import a small amount of local data from the client. Features such as LOB INROW threshold configuration, Remote Procedure Call (RPC) authentication certificate management, and parameter resetting are also provided to improve system usability.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-index-use-monitoring"><strong>(1) Index use monitoring</strong><a href="#1-index-use-monitoring" class="hash-link" aria-label="Direct link to 1-index-use-monitoring" title="Direct link to 1-index-use-monitoring">​</a></h3>
<p>We usually create indexes to improve the query performance of the database. However, more and more indexes are created as data tables are used in more business scenarios by more operators. Unused indexes are a waste of storage space and increase the overhead of DML operations. In this case, you need to drop useless indexes to alleviate burden on the system. However, you can hardly identify all useless indexes by manual efforts. Therefore, OceanBase Database V4.3.0 provides the index monitoring feature. After you enable this feature and set the sampling method, the index usage information that meets the rules is recorded in the memory of a user tenant and refreshed to the internal table once every 15 minutes. You can then query the DBA_INDEX_USAGE view to find out whether an index is referenced and drop useless indexes to release space.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-local-import-from-the-client"><strong>(2) Local import from the client</strong><a href="#2-local-import-from-the-client" class="hash-link" aria-label="Direct link to 2-local-import-from-the-client" title="Direct link to 2-local-import-from-the-client">​</a></h3>
<p>OceanBase Database V4.3.0 supports the <code>LOAD DATA LOCAL INFILE</code> statement for local import from the client. You can use the feature to import local files through streaming file processing. Based on this feature, developers can import local files for testing without uploading files to the server or object storage, improving the efficiency of importing a small amount of data.</p>
<p>Note: To import local data from the client, make sure that:</p>
<p>a. The version of OceanBase Client (OBClient) is V2.2.4 or later.</p>
<p>b. The version of ODP is V3.2.4 or later. If you directly connect to an OBServer node, ignore this requirement.</p>
<p>c. The version of OceanBase Connector/J is V2.4.8 or later if you use Java and OceanBase Connector/J.</p>
<p>You can directly use a MySQL client or a native MariaDB client of any version.</p>
<p>The <code>SECURE_FILE_PRIV</code> variable is used to specify the server paths that can be accessed by the OBServer node. This variable does not affect local import from a client, and therefore does not need to be specified for local import.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-lob-inrow-threshold-configuration"><strong>(3) LOB INROW threshold configuration</strong><a href="#3-lob-inrow-threshold-configuration" class="hash-link" aria-label="Direct link to 3-lob-inrow-threshold-configuration" title="Direct link to 3-lob-inrow-threshold-configuration">​</a></h3>
<p>By default, LOB data of a size less than or equal to 4 KB is stored in INROW mode, and LOB data of a size greater than 4 KB is stored in the LOB auxiliary table. In some scenarios, INROW storage provides higher performance than auxiliary table-based storage. Therefore, this version supports dynamic configuration of the LOB storage mode. You can adjust the INROW threshold based on your business needs, provided that the threshold does not exceed the limit for INROW storage.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-rpc-authentication-certificate-management"><strong>(4) RPC authentication certificate management</strong><a href="#4-rpc-authentication-certificate-management" class="hash-link" aria-label="Direct link to 4-rpc-authentication-certificate-management" title="Direct link to 4-rpc-authentication-certificate-management">​</a></h3>
<p>When RPC authentication is enabled for a cluster, for an access request from a client, such as the arbitration service, primary/standby database, or OceanBase Change Data Capture (CDC), you need to place the root CA certificate of the client in the deployment directory of each OBServer node in the cluster, and then perform related configurations. This whole process is complicated. OceanBase Database V4.3.0 supports the internal certificate management feature. You can use the <code>DBMS_TRUSTED_CERTIFICATE_MANAGER</code> system package provided in the sys tenant to add, delete, and modify root CA certificates trusted by an OceanBase cluster. The DBA_OB_TRUSTED_ROOT_CERTIFICATE view is also provided in the sys tenant to display the list of client root CA certificates added to OBServer nodes in the cluster and the certificate expiration time.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-parameter-resetting"><strong>(5) Parameter resetting</strong><a href="#5-parameter-resetting" class="hash-link" aria-label="Direct link to 5-parameter-resetting" title="Direct link to 5-parameter-resetting">​</a></h3>
<p>In earlier versions, if you want to reset a parameter to the default value, you need to query the default value of the parameter first, and then manually set the parameter to the default value. The new version provides the <code>ALTER SYSTEM [RESET] parameter_name [SCOPE = {MEMORY | SPFILE | BOTH}] {TENANT [=] &#x27;tenant_name&#x27;}</code> syntax for you to reset a parameter to the default value. The default value is obtained from the node that executes the statement. You can reset cluster-level parameters or parameters of a specified tenant in the sys tenant. You can also reset parameters for the current user tenant. On OBServer nodes, whether the <code>SCOPE</code> option is specified or not does not affect the implementation logic. For a parameter that takes effect statically, the default value is only stored on the disk but not updated to the memory. For a parameter that takes effect dynamically, the default value is stored on the disk and updated to the memory.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="v-afterword"><strong>V. Afterword</strong><a href="#v-afterword" class="hash-link" aria-label="Direct link to v-afterword" title="Direct link to v-afterword">​</a></h2>
<p>OceanBase Database V4.3.0 sets a significant milestone on our roadmap to achieve real-time AP. We will keep updating AP features of subsequent versions to overcome challenges in real-world business scenarios.</p>
<p>We would like to thank all our users and developers for their contributions to OceanBase Database V4.3.0. Their valuable suggestions are a powerful driving force that pushes OceanBase forward. We look forward to working with every user and developer in tackling critical workloads, developing modern data architectures, and building better and more user-friendly distributed databases.</p>
<p>You can visit <a href="https://www.oceanbase.com/product/oceanbase-database-rn/releaseNote" target="_blank" rel="noopener noreferrer"><strong>Release Notes</strong></a> to learn more about the new OceanBase Database V4.3.0.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/oceanbase/oceanbase.github.io/tree/main/docs/blogs/arch/ob-430.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/blogs/arch/miniaturization"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">OceanBase 4.0 interpretation: Reduce the threshold of distributed database use, talk about our thinking on small specifications</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/blogs/feat/io-isolation"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">OceanBase provides users with sufficiently flexible and simple I/O resource isolation experiences.</div></a></nav><div>Loading...</div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#i-tp-and-ap-integration" class="table-of-contents__link toc-highlight"><strong>I. TP and AP integration</strong></a><ul><li><a href="#1-integrated-columnar-and-row-based-storage" class="table-of-contents__link toc-highlight"><strong>(1) Integrated columnar and row-based storage</strong></a></li><li><a href="#2-new-vectorized-engine" class="table-of-contents__link toc-highlight"><strong>(2) New vectorized engine</strong></a></li><li><a href="#3-materialized-views" class="table-of-contents__link toc-highlight"><strong>(3) Materialized views</strong></a></li></ul></li><li><a href="#ii-high-performance-kernel" class="table-of-contents__link toc-highlight"><strong>II. High-performance kernel</strong></a><ul><li><a href="#1-enhanced-row-estimation-system" class="table-of-contents__link toc-highlight"><strong>(1) Enhanced row estimation system</strong></a></li><li><a href="#2-enhanced-statistics" class="table-of-contents__link toc-highlight"><strong>(2) Enhanced statistics</strong></a></li><li><a href="#3-adaptive-cost-model" class="table-of-contents__link toc-highlight"><strong>(3) Adaptive cost model</strong></a></li><li><a href="#4-fixed-session-variables-for-function-based-indexes" class="table-of-contents__link toc-highlight"><strong>(4) Fixed session variables for function-based indexes</strong></a></li><li><a href="#5-online-ddl-expansion-in-mysql-mode" class="table-of-contents__link toc-highlight"><strong>(5) Online DDL expansion in MySQL mode</strong></a></li><li><a href="#6-globally-unique-client-session-id" class="table-of-contents__link toc-highlight"><strong>(6) Globally unique client session ID</strong></a></li><li><a href="#7-improvement-of-the-log-stream-state-machine" class="table-of-contents__link toc-highlight"><strong>(7) Improvement of the log stream state machine</strong></a></li><li><a href="#8-tenant-cloning" class="table-of-contents__link toc-highlight"><strong>(8) Tenant cloning</strong></a></li><li><a href="#9-support-for-s3-as-the-backup-and-restore-media" class="table-of-contents__link toc-highlight"><strong>(9) Support for S3 as the backup and restore media</strong></a></li><li><a href="#10-proactive-broadcastrefresh-of-tablet-locations" class="table-of-contents__link toc-highlight"><strong>(10) Proactive broadcast/refresh of tablet locations</strong></a></li><li><a href="#11-migration-of-active-transactions-during-tablet-transfer" class="table-of-contents__link toc-highlight"><strong>(11) Migration of active transactions during tablet transfer</strong></a></li><li><a href="#12-memory-throttling-mechanism" class="table-of-contents__link toc-highlight"><strong>(12) Memory throttling mechanism</strong></a></li><li><a href="#13-optimization-of-ddl-temporary-result-space" class="table-of-contents__link toc-highlight"><strong>(13) Optimization of DDL temporary result space</strong></a></li></ul></li><li><a href="#iii-higher-computing-performance" class="table-of-contents__link toc-highlight"><strong>III. Higher computing performance</strong></a><ul><li><a href="#1-increased-performance-in-the-tpc-h-1tb-test" class="table-of-contents__link toc-highlight"><strong>(1) Increased performance in the TPC-H 1TB test</strong></a></li><li><a href="#2-increased-performance-in-tpc-ds-1tb-test" class="table-of-contents__link toc-highlight"><strong>(2) Increased performance in TPC-DS 1TB test</strong></a></li><li><a href="#3-obkv-performance-optimization" class="table-of-contents__link toc-highlight"><strong>(3) OBKV performance optimization</strong></a></li><li><a href="#4-pdml-transaction-optimization" class="table-of-contents__link toc-highlight"><strong>(4) PDML transaction optimization</strong></a></li><li><a href="#5-io-usage-optimization-for-loading-tablet-metadata" class="table-of-contents__link toc-highlight"><strong>(5) I/O usage optimization for loading tablet metadata</strong></a></li></ul></li><li><a href="#iv-ease-of-use-enhancements" class="table-of-contents__link toc-highlight"><strong>IV. Ease-of-use enhancements</strong></a><ul><li><a href="#1-index-use-monitoring" class="table-of-contents__link toc-highlight"><strong>(1) Index use monitoring</strong></a></li><li><a href="#2-local-import-from-the-client" class="table-of-contents__link toc-highlight"><strong>(2) Local import from the client</strong></a></li><li><a href="#3-lob-inrow-threshold-configuration" class="table-of-contents__link toc-highlight"><strong>(3) LOB INROW threshold configuration</strong></a></li><li><a href="#4-rpc-authentication-certificate-management" class="table-of-contents__link toc-highlight"><strong>(4) RPC authentication certificate management</strong></a></li><li><a href="#5-parameter-resetting" class="table-of-contents__link toc-highlight"><strong>(5) Parameter resetting</strong></a></li></ul></li><li><a href="#v-afterword" class="table-of-contents__link toc-highlight"><strong>V. Afterword</strong></a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="http://github.com/oceanbase/oceanbase/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussion<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://join.slack.com/t/oceanbase/shared_invite/zt-1e25oz3ol-lJ6YNqPHaKwY_mhhioyEuw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/oceanbase" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum (in Chinese)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">SIG</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/sig/AI/sig_intro">AI</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/cloud-native/sig_intro">cloud-native</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/compilation/sig_intro">compilation</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/develop-tools/sig_intro">develop-tools</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/miniob/sig_intro">MiniOB</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/obdiag/sig_intro">obdiag</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/operation/sig_intro">operation</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://en.oceanbase.com/about" target="_blank" rel="noopener noreferrer" class="footer__link-item">About OceanBase<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/blogs/arch/all-in-one">Blogs</a></li><li class="footer__item"><a href="https://github.com/oceanbase/oceanbase" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 OceanBase, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>