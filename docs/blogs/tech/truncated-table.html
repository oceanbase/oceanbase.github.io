<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-blogs/tech/truncated-table" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Why Truncated Tables Cannot Be Recycled in OceanBase Database V4.x? | OceanBase</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://oceanbase.github.io/docs/blogs/tech/truncated-table"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Why Truncated Tables Cannot Be Recycled in OceanBase Database V4.x? | OceanBase"><meta data-rh="true" name="description" content="I have been questioned a lot lately that &quot;OceanBase Database V3.x supports the recycle of truncated tables. Why is this feature removed in OceanBase Database V4.x?&quot;"><meta data-rh="true" property="og:description" content="I have been questioned a lot lately that &quot;OceanBase Database V3.x supports the recycle of truncated tables. Why is this feature removed in OceanBase Database V4.x?&quot;"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://oceanbase.github.io/docs/blogs/tech/truncated-table"><link data-rh="true" rel="alternate" href="https://oceanbase.github.io/docs/blogs/tech/truncated-table" hreflang="en"><link data-rh="true" rel="alternate" href="https://oceanbase.github.io/docs/blogs/tech/truncated-table" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6JQM9QDU5V-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.7e3a93fe.css">
<script src="/assets/js/runtime~main.6adb4f57.js" defer="defer"></script>
<script src="/assets/js/main.5def480d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="OceanBase Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="OceanBase Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">OceanBase</b></a><a class="navbar__item navbar__link" href="/docs/blogs/arch/all-in-one">Blogs</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Docs</a><ul class="dropdown__menu"><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">Product Docs</a><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">User Manual</a><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">Developer Manual</a></ul><ul class="dropdown__menu" style="left:160px;display:none"></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><span><li><a class="dropdown__link" href="/docs/sig/overview/list">Special Interest Group(SIG)</a></li></span><span><li><a class="dropdown__link" href="/docs/honor/overview">Community Honors</a></li></span><span><li><a href="http://github.com/oceanbase/oceanbase/discussions" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub Discussion<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://join.slack.com/t/oceanbase/shared_invite/zt-1e25oz3ol-lJ6YNqPHaKwY_mhhioyEuw" target="_blank" rel="noopener noreferrer" class="dropdown__link">Slack<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Forum (in Chinese)<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://stackoverflow.com/questions/tagged/oceanbase" target="_blank" rel="noopener noreferrer" class="dropdown__link">Stack Overflow<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span></ul><ul class="dropdown__menu" style="left:160px;display:none"></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Data + AI</a><ul class="dropdown__menu"><span><li><a href="https://oceanbase-devhub.github.io" target="_blank" rel="noopener noreferrer" class="dropdown__link">Devhub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><div style="padding: 0.25rem 0.5rem; font-size: 14px; color: #4e7ff1;">AI Workshops</div></li></span><span><li><a href="https://oceanbase-devhub.github.io/ai-workshop-2024" target="_blank" rel="noopener noreferrer" class="dropdown__link">RAG Bot<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://oceanbase-devhub.github.io/dify/dify@oceanbase-workshop" target="_blank" rel="noopener noreferrer" class="dropdown__link">Dify (MySQL Compatible)<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://oceanbase-devhub.github.io/DB-GPT/docker/compose_examples/ob_dbgpt_tutorial" target="_blank" rel="noopener noreferrer" class="dropdown__link">DB-GPT<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span></ul><ul class="dropdown__menu" style="left:160px;display:none"></ul></div><a href="https://en.oceanbase.com/softwarecenter" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Downloads<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/oceanbase" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/blogs/arch/all-in-one">Architectural Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/blogs/feat/io-isolation">Features Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/blogs/tech/adaptive-sql-execution-engine">Technical Introduction</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/blogs/tech/adaptive-sql-execution-engine">Adaptive Techniques in the OceanBase SQL Execution Engine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/blogs/tech/alter-table">Principles of ALTER TABLE in OceanBase Database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/blogs/tech/distributed-push-down">OceanBase Distributed Pushdown Technology</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/blogs/tech/high-concurrency">OceanBase Technical Insights for High-Concurrency Scenarios</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/blogs/tech/ob-schema">What Is a Schema in OceanBase Database?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/blogs/tech/parallel-execution-I">Mastering Parallel Execution in OceanBase Database: Part 1 - Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/blogs/tech/parallel-execution-II">Mastering Parallel Execution in OceanBase Database: Part 2 - Set the DOP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/blogs/tech/parallel-execution-III">Mastering Parallel Execution in OceanBase Database: Part 3 - Concurrency Control and Queuing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/blogs/tech/parallel-execution-IV">Mastering Parallel Execution in OceanBase Database: Part 4 - Parallel Execution Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/blogs/tech/query-engines">Evolution of Database Query Engines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/blogs/tech/refine-performance">How We Approach Improving Distributed Query Performance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/blogs/tech/storage-engine">Storage Engine of OceanBase Database V4.x Cuts Historical Database Costs by over 50%</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/blogs/tech/tp-to-ap">From OLTP to OLAP: Exploration and practice of the OceanBase SQL engine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/blogs/tech/trans-recovery">Principles and Practices of Transaction Recovery in Distributed Databases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/blogs/tech/truncated-table">Why Truncated Tables Cannot Be Recycled in OceanBase Database V4.x?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/blogs/tech/vector-search">Vector capabilities of OceanBase Database: find similar images in a blink</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/blogs/users/AXA">Corporate Cases</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/blogs/showcases/architectural-evolution">Highlights</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/blogs/others/flink-and-ob">Others</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Technical Introduction</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Why Truncated Tables Cannot Be Recycled in OceanBase Database V4.x?</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Why Truncated Tables Cannot Be Recycled in OceanBase Database V4.x?</h1></header>
<blockquote>
<p>I have been questioned a lot lately that &quot;OceanBase Database V3.x supports the recycle of truncated tables. Why is this feature removed in OceanBase Database V4.x?&quot;<br>
<!-- -->In this article, I will explain why truncated tables are not moved to the recycle bin in OceanBase Database V4.x.</p>
</blockquote>
<h1>Background</h1>
<p>MySQL does not provide a recycle bin, which, however, is necessary for a database administrator (DBA) to quickly and losslessly restore accidentally deleted data. In response to the strong request of Ant Group DBAs, OceanBase Database has supported the recycle bin feature in MySQL mode, which is similar to that in Oracle 10g. For more information, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001029493" target="_blank" rel="noopener noreferrer">Overview</a>.</p>
<p>In OceanBase Database V3.x, if the session-level system variable <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001030833" target="_blank" rel="noopener noreferrer">ob_enable_truncate_flashback</a> is set to <code>on</code>, you can perform a <code>FLASHBACK</code> operation to restore the data truncated from a table.</p>
<p>For example, you can execute the following SQL sequence to restore the data truncated from table <code>t1</code> to a table named <code>truncated_t1</code>:
<img decoding="async" loading="lazy" alt="1" src="/assets/images/1-8c07377795ad02c52be589807767cb32.png" width="1746" height="714" class="img_ev3q"></p>
<p>In OceanBase Database V4.x, a truncated table is not moved to the recycle bin, as shown in the following example:
<img decoding="async" loading="lazy" alt="2" src="/assets/images/2-c246df9002f5ec6312e8ceabe49bb387.png" width="1346" height="450" class="img_ev3q"></p>
<h1>Cause Analysis</h1>
<p>Let&#x27;s start with the implementation of the recycle bin in OceanBase Database and the implementation of the <code>TRUNCATE TABLE</code> statement in OceanBase Database V3.x and V4.x.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="implementation-of-the-recycle-bin">Implementation of the Recycle Bin<a href="#implementation-of-the-recycle-bin" class="hash-link" aria-label="Direct link to Implementation of the Recycle Bin" title="Direct link to Implementation of the Recycle Bin">​</a></h2>
<p>The recycle bin is implemented by logically deleting data, where deleted objects are labeled with an internal identifier, making them invisible to users. Objects in the recycle bin have only their metadata changed. Their underlying data remains unchanged.</p>
<p>You can execute the <code>SHOW RECYCLEBIN</code> statement to view the information about all objects in the recycle bin. The object information is stored in an internal table named <code>__all_recyclebin</code>. When you move an object to the recycle bin, a record is inserted into the <code>__all_recyclebin</code> table. When you perform a <code>FLASHBACK</code> or <code>PURGE</code> operation, that record is deleted from the <code>__all_recyclebin</code> table.
<img decoding="async" loading="lazy" alt="3" src="/assets/images/3-1688af58d62dd16f446f44382117ef36.png" width="2150" height="1470" class="img_ev3q"></p>
<p>To retain dropped tables in the recycle bin, OceanBase Database adds a default <code>__recyclebin</code> database whose <code>database_id</code> is <code>201004</code> for each tenant.
<img decoding="async" loading="lazy" alt="4" src="/assets/images/4-df05023bdc9903dcc111010053c6bc88.png" width="798" height="434" class="img_ev3q"></p>
<p>Dropping a table into the recycle bin is moving the table from its original database to the <code>__recyclebin</code> database, during which the <code>database_id</code> and <code>table_name</code> of the table are changed. The indexes on the dropped table are also moved to the recycle bin.
<img decoding="async" loading="lazy" alt="5" src="/assets/images/5-0ad8324831b585aa7379ae4c64a597f2.png" width="2334" height="856" class="img_ev3q"></p>
<p>Therefore, the procedure of dropping a table into the recycle bin is as follows:</p>
<ol>
<li>The <code>database_id</code> and <code>table_name</code> values of the table are modified. The new database name is <code>__recyclebin</code>, and the new table name starts with <code>__recycle</code>.</li>
<li>The table is moved to the recycle bin and a corresponding record is inserted into the <code>__all_recyclebin</code> table.</li>
<li>The preceding steps are performed for the index tables of the dropped table.</li>
</ol>
<p>The <code>FLASHBACK</code> operation restores a dropped table from the recycle bin. For more information, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001029495" target="_blank" rel="noopener noreferrer">Restore objects from the recycle bin</a>.</p>
<p>The <code>PURGE</code> operation purges the recycle bin. It first deletes the information about an object from <code>__recyclebin</code> and then deletes the object from <code>__all_table</code> and <code>__all_table_history</code>. For more information, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001029492" target="_blank" rel="noopener noreferrer">Purge the recycle bin</a>.</p>
<p>Other objects such as tenants and databases are dropped into the recycle bin in a similar way.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="implementation-of-truncate-table">Implementation of TRUNCATE TABLE<a href="#implementation-of-truncate-table" class="hash-link" aria-label="Direct link to Implementation of TRUNCATE TABLE" title="Direct link to Implementation of TRUNCATE TABLE">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="truncate-table-in-oceanbase-database-v3x">TRUNCATE TABLE in OceanBase Database V3.x<a href="#truncate-table-in-oceanbase-database-v3x" class="hash-link" aria-label="Direct link to TRUNCATE TABLE in OceanBase Database V3.x" title="Direct link to TRUNCATE TABLE in OceanBase Database V3.x">​</a></h3>
<p>In OceanBase Database V3.x, a <code>TRUNCATE TABLE</code> statement is essentially the combination of a <code>DROP TABLE</code> statement and a <code>CREATE TABLE</code> statement. For example, if you execute <code>TRUNCATE TABLE t1</code>, <code>DROP TABLE t1</code> and <code>CREATE TABLE t1</code> are executed within the same transaction.</p>
<p>In other words, a truncated table and its data in OceanBase Database V3.x are moved into the recycle bin when the <code>DROP TABLE</code> statement is executed. This is why you can perform a <code>FLASHBACK</code> operation in OceanBase Database V3.x to restore an accidentally truncated table and its data.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="truncate-table-in-oceanbase-database-v4x">TRUNCATE TABLE in OceanBase Database V4.x<a href="#truncate-table-in-oceanbase-database-v4x" class="hash-link" aria-label="Direct link to TRUNCATE TABLE in OceanBase Database V4.x" title="Direct link to TRUNCATE TABLE in OceanBase Database V4.x">​</a></h3>
<p>OceanBase Database V4.x has introduced the concept of tablets. Tablets, imperceptible to users, are migratable data blocks at the physical storage layer. For more information, see <a href="https://open.oceanbase.com/blog/1249578496" target="_blank" rel="noopener noreferrer">What Are Tablets in OceanBase Database V4.0?</a> The <code>TRUNCATE TABLE</code> statement in OceanBase Database V4.x is implemented by modifying the corresponding tablets of partitions, instead of executing a <code>DROP TABLE</code> statement and a <code>CREATE TABLE</code> statement as in OceanBase Database V3.x. To be specific, truncating a table in OceanBase Database V4.x deletes old tablets and creates new tablets. This boosts performance in scenarios where a table has many associated objects such as columns, constraints, foreign keys, partitions, and indexes.</p>
<p>As <code>TRUNCATE TABLE</code> in OceanBase Database V4.x does not involve <code>DROP TABLE</code>, a truncated table is not moved to the recycle bin. When you truncate a table in OceanBase Database V4.x, the metadata of the table remains unchanged, and only the corresponding tablets are modified.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="why-the-change-in-oceanbase-database-v4x">Why the Change in OceanBase Database V4.x?<a href="#why-the-change-in-oceanbase-database-v4x" class="hash-link" aria-label="Direct link to Why the Change in OceanBase Database V4.x?" title="Direct link to Why the Change in OceanBase Database V4.x?">​</a></h3>
<p>Users frequently truncating tables in OceanBase Database V3.x have found that the performance of the <code>TRUNCATE TABLE</code> statement in OceanBase Database was lower than that in Oracle. The performance overhead comes from two aspects: updating system tables and creating partitions. In OceanBase Database V3.x, partition creation requires creating Paxos groups and thereby involves many steps. In OceanBase Database V4.x, which adopts a single-log stream architecture, partition creation involves only operations on the data within the log stream, leading to a significant improvement in performance. To eliminate the performance overhead caused by updating system tables, the <code>TRUNCATE TABLE</code> statement must be implemented differently.</p>
<p>A user of OceanBase Database V3.x maintains tens of thousands of tables, each with hundreds of columns and check constraints. For each table, hundreds of records are stored in the <code>__all_column</code> and <code>__all_constraint</code> system tables. Every time when they perform a <code>TRUNCATE TABLE</code> operation, the system deletes metadata during the <code>DROP TABLE</code> operation and rewrites metadata during the <code>CREATE TABLE</code> operation. If the table is associated with many objects, this process takes forever to complete.</p>
<p>In OceanBase Database V4.x, <code>TRUNCATE TABLE</code> no longer modifies the metadata of a table, leaving system tables such as <code>__all_column</code> and <code>__all_constraint</code> unchanged during the truncation. Data is cleared by replacing tablets. The <code>__all_table</code> table has a column named <code>tablet_id</code> added to record the tablet of each table. When you truncate a table, OceanBase Database creates an empty tablet, uses the <code>tablet_id</code> value of the new tablet to overwrite the old value in the <code>__all_table</code> table, and then deletes the old tablet. For a partitioned table, a <code>tablet_id</code> value is recorded in the <code>__all_part</code> table for each partition. When you truncate a partitioned table, OceanBase Database replaces the corresponding tablet with a new, empty tablet for each partition.</p>
<p>The implementation of <code>TRUNCATE TABLE</code> in OceanBase Database V4.x is similar to that in Oracle. You can think of <code>table_id</code> and <code>tablet_id</code> in OceanBase Database V4.x as <code>object_id</code> and <code>data_object_id</code> in Oracle.</p>
<h1>Other Noteworthy Points</h1>
<p>Here are a few interesting but often overlooked aspects of the recycle bin feature.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="flash-back-a-table-by-using-original_name">Flash Back a Table by Using original_name<a href="#flash-back-a-table-by-using-original_name" class="hash-link" aria-label="Direct link to Flash Back a Table by Using original_name" title="Direct link to Flash Back a Table by Using original_name">​</a></h2>
<p>As stated in <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001031748" target="_blank" rel="noopener noreferrer">FLASHBACK</a>, a topic currently dated September 12, 2023, when restoring a table from the recycle bin by using the <code>FLASHBACK</code> statement, you can only specify the corresponding object name (<code>object_name</code>) of the table in the recycle bin, not the original name (<code>original_name</code>) of the table before it was dropped.</p>
<p>Actually, OceanBase Database also allows you to specify <code>original_name</code>. If the recycle bin contains tables with the same original name, the <code>FLASHBACK original_name</code> statement restores the table that was last moved to the recycle bin. This is consistent with the recycle bin feature of Oracle.</p>
<p>Here is an example:
<img decoding="async" loading="lazy" alt="6" src="/assets/images/6-4ee7f93a4bbea589729bc18321a05de2.png" width="2470" height="1138" class="img_ev3q">
<img decoding="async" loading="lazy" alt="7" src="/assets/images/7-0d7140ea8972faa07982de31b281e3e7.png" width="2434" height="1224" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="purge-a-table-by-using-original_name">Purge a Table by Using original_name<a href="#purge-a-table-by-using-original_name" class="hash-link" aria-label="Direct link to Purge a Table by Using original_name" title="Direct link to Purge a Table by Using original_name">​</a></h2>
<p>As stated in <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001031730" target="_blank" rel="noopener noreferrer">PURGE</a>, a topic currently dated September 12, 2023, when purging a table from the recycle bin by using the <code>PURGE</code> statement, you can only specify the corresponding object name (<code>object_name</code>) of the table in the recycle bin, not the original name (<code>original_name</code>) of the table before it was dropped.</p>
<p>Actually, OceanBase Database also allows you to specify <code>original_name</code>. If the recycle bin contains tables with the same original name, the <code>PURGE original_name</code> statement purges the table that was first moved to the recycle bin. This is consistent with the recycle bin feature of Oracle.</p>
<p>Here is an example:
<img decoding="async" loading="lazy" alt="8" src="/assets/images/8-5d4f18f60d5c5ace61e6ff24539ee20a.png" width="2446" height="1140" class="img_ev3q">
<img decoding="async" loading="lazy" alt="9" src="/assets/images/9-20b491736c2e908e86747d6f08d99725.png" width="2414" height="1222" class="img_ev3q"></p>
<p>Let me put an end here. For any questions about the recycle bin feature of OceanBase Database, feel free to leave a comment.</p>
<h1>References</h1>
<p>   If you are interested, read the following posts:</p>
<p>   <a href="https://oceanbase.github.io/docs/blogs/tech/ob-schema" target="_blank" rel="noopener noreferrer">What Is a Schema in OceanBase Database?</a></p>
<p>   <a href="https://oceanbase.github.io/docs/blogs/tech/adaptive-sql-execution-engine" target="_blank" rel="noopener noreferrer">Adaptive Techniques in the OceanBase Database Execution Engine</a></p>
<p>   <a href="https://open.oceanbase.com/blog/5382203648" target="_blank" rel="noopener noreferrer">Pushdown Techniques in OceanBase Database</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/oceanbase/oceanbase.github.io/tree/main/docs/blogs/tech/truncated-table.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/blogs/tech/trans-recovery"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Principles and Practices of Transaction Recovery in Distributed Databases</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/blogs/tech/vector-search"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Vector capabilities of OceanBase Database: find similar images in a blink</div></a></nav><div>Loading...</div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#implementation-of-the-recycle-bin" class="table-of-contents__link toc-highlight">Implementation of the Recycle Bin</a></li><li><a href="#implementation-of-truncate-table" class="table-of-contents__link toc-highlight">Implementation of TRUNCATE TABLE</a><ul><li><a href="#truncate-table-in-oceanbase-database-v3x" class="table-of-contents__link toc-highlight">TRUNCATE TABLE in OceanBase Database V3.x</a></li><li><a href="#truncate-table-in-oceanbase-database-v4x" class="table-of-contents__link toc-highlight">TRUNCATE TABLE in OceanBase Database V4.x</a></li><li><a href="#why-the-change-in-oceanbase-database-v4x" class="table-of-contents__link toc-highlight">Why the Change in OceanBase Database V4.x?</a></li></ul></li><li><a href="#flash-back-a-table-by-using-original_name" class="table-of-contents__link toc-highlight">Flash Back a Table by Using original_name</a></li><li><a href="#purge-a-table-by-using-original_name" class="table-of-contents__link toc-highlight">Purge a Table by Using original_name</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="http://github.com/oceanbase/oceanbase/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussion<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://join.slack.com/t/oceanbase/shared_invite/zt-1e25oz3ol-lJ6YNqPHaKwY_mhhioyEuw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/oceanbase" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum (in Chinese)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">SIG</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/sig/AI/sig_intro">AI</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/cloud-native/sig_intro">cloud-native</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/compilation/sig_intro">compilation</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/develop-tools/sig_intro">develop-tools</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/miniob/sig_intro">MiniOB</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/obdiag/sig_intro">obdiag</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/operation/sig_intro">operation</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://en.oceanbase.com/about" target="_blank" rel="noopener noreferrer" class="footer__link-item">About OceanBase<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/blogs/arch/all-in-one">Blogs</a></li><li class="footer__item"><a href="https://github.com/oceanbase/oceanbase" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 OceanBase, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>