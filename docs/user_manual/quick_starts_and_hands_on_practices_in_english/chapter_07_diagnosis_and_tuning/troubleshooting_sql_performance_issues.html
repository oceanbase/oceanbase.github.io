<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/troubleshooting_sql_performance_issues" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Typical scenarios and troubleshooting logic for SQL performance issues | OceanBase</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://oceanbase.github.io/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/troubleshooting_sql_performance_issues"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Typical scenarios and troubleshooting logic for SQL performance issues | OceanBase"><meta data-rh="true" name="description" content="This topic describes how to diagnose SQL performance issues. For more information about SQL tuning, see &#x27;7.5 Read and manage SQL execution plans in OceanBase Database&#x27; and &#x27;7.6 Common SQL tuning methods&#x27;."><meta data-rh="true" property="og:description" content="This topic describes how to diagnose SQL performance issues. For more information about SQL tuning, see &#x27;7.5 Read and manage SQL execution plans in OceanBase Database&#x27; and &#x27;7.6 Common SQL tuning methods&#x27;."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://oceanbase.github.io/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/troubleshooting_sql_performance_issues"><link data-rh="true" rel="alternate" href="https://oceanbase.github.io/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/troubleshooting_sql_performance_issues" hreflang="en"><link data-rh="true" rel="alternate" href="https://oceanbase.github.io/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/troubleshooting_sql_performance_issues" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6JQM9QDU5V-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.7e3a93fe.css">
<script src="/assets/js/runtime~main.6adb4f57.js" defer="defer"></script>
<script src="/assets/js/main.5def480d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="OceanBase Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="OceanBase Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">OceanBase</b></a><a class="navbar__item navbar__link" href="/docs/blogs/arch/all-in-one">Blogs</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Docs</a><ul class="dropdown__menu"><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">Product Docs</a><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">User Manual</a><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">Developer Manual</a></ul><ul class="dropdown__menu" style="left:160px;display:none"></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><span><li><a class="dropdown__link" href="/docs/sig/overview/list">Special Interest Group(SIG)</a></li></span><span><li><a class="dropdown__link" href="/docs/honor/overview">Community Honors</a></li></span><span><li><a href="http://github.com/oceanbase/oceanbase/discussions" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub Discussion<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://join.slack.com/t/oceanbase/shared_invite/zt-1e25oz3ol-lJ6YNqPHaKwY_mhhioyEuw" target="_blank" rel="noopener noreferrer" class="dropdown__link">Slack<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Forum (in Chinese)<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://stackoverflow.com/questions/tagged/oceanbase" target="_blank" rel="noopener noreferrer" class="dropdown__link">Stack Overflow<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span></ul><ul class="dropdown__menu" style="left:160px;display:none"></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Data + AI</a><ul class="dropdown__menu"><span><li><a href="https://oceanbase-devhub.github.io" target="_blank" rel="noopener noreferrer" class="dropdown__link">Devhub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><div style="padding: 0.25rem 0.5rem; font-size: 14px; color: #4e7ff1;">AI Workshops</div></li></span><span><li><a href="https://oceanbase-devhub.github.io/ai-workshop-2024" target="_blank" rel="noopener noreferrer" class="dropdown__link">RAG Bot<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://oceanbase-devhub.github.io/dify/dify@oceanbase-workshop" target="_blank" rel="noopener noreferrer" class="dropdown__link">Dify (MySQL Compatible)<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://oceanbase-devhub.github.io/DB-GPT/docker/compose_examples/ob_dbgpt_tutorial" target="_blank" rel="noopener noreferrer" class="dropdown__link">DB-GPT<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span></ul><ul class="dropdown__menu" style="left:160px;display:none"></ul></div><a href="https://en.oceanbase.com/softwarecenter" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Downloads<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/oceanbase" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_01_overview_of_the_oceanbase_database/introduction">Overview of the Oceanbase database</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_02_deploy_oceanbase_database/introduction">Deploy Oceanbase database</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_03_test_oceanbase_database/introduction">Test Oceanbase database</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_04_migration_and_synchronization_oceanbase/introduction">Migrate and synchronize data</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_05_operation_and_maintenance/introduction">Operation and maintenance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_06_using_ob_for_business_development/introduction">Using Oceanbase for business development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/introduction">Diagnosis_and_tuning</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/overview_of_diagnosis_and_tuning">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/odp_sql_route">Principles of ODP SQL routing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/manage_connections">Manage OceanBase Database connections</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/analyze_sql_monitoring_view">Perform analysis based on SQL monitoring views</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/management_execution_plan">Read and manage SQL execution plans in OceanBase Database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/sql_tuning">Common SQL tuning methods</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/troubleshooting_sql_performance_issues">Typical scenarios and troubleshooting logic for SQL performance issues</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/performance_diagnosis_by_sql_diagnoser">Use SQL Diagnoser to diagnose and analyze SQL performance issues</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/diagnose_and_analyze_through_obdiag">Use obdiag for diagnostics and analytics</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Diagnosis_and_tuning</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Typical scenarios and troubleshooting logic for SQL performance issues</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>7.7 Typical scenarios and troubleshooting logic for SQL performance issues</h1></header>
<p>This topic describes how to diagnose SQL performance issues. For more information about SQL tuning, see &#x27;7.5 Read and manage SQL execution plans in OceanBase Database&#x27; and &#x27;7.6 Common SQL tuning methods&#x27;.</p>
<p>Perform troubleshooting in the following procedure:</p>
<ol>
<li>
<p>Execute the <code>SHOW TRACE</code> statement to query the time spent in each phase and identify the phase that takes the longest time.</p>
</li>
<li>
<p>If the query result in Step 1 shows that an observer process is slow, query the <code>oceanbase.gv$ob_sql_audit</code> view for the phase that takes the longest time in the observer process.</p>
</li>
<li>
<p>If the query result in Step 2 shows that the execution phase takes the longest time, check for buffer tables, cardinality, and hard parsing.</p>
</li>
<li>
<p>If none of the preceding issues exists, execute the <code>EXPLAIN EXTENDED</code> statement to query the execution plan and check whether the number of rows estimated by the optimizer greatly differs from the actual one. If yes, manually collect statistics. If no, create a more appropriate index or use a hint to modify the plan or the degree of parallelism (DOP). For information about how to set a DOP for parallel execution, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001378909" target="_blank" rel="noopener noreferrer">Set a DOP for parallel execution</a>. For information about how to optimize an SQL statement by using the <code>EXPLAIN</code> statement, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001168989" target="_blank" rel="noopener noreferrer">SQL tuning practice with EXPLAIN</a>.</p>
</li>
</ol>
<p>This topic describes the tools commonly used for analyzing SQL performance issues and summarizes the typical scenarios and issues of SQL tuning.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tools-for-analyzing-sql-performance-issues">Tools for analyzing SQL performance issues<a href="#tools-for-analyzing-sql-performance-issues" class="hash-link" aria-label="Direct link to Tools for analyzing SQL performance issues" title="Direct link to Tools for analyzing SQL performance issues">​</a></h2>
<p>You can use the end-to-end tracing, SQL audit, and SQL plan monitor features to analyze SQL performance issues.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="end-to-end-tracing">End-to-end tracing<a href="#end-to-end-tracing" class="hash-link" aria-label="Direct link to End-to-end tracing" title="Direct link to End-to-end tracing">​</a></h3>
<p>Data is processed through the following link: <code>application server &lt;-&gt; OceanBase Database Proxy (ODP) &lt;-&gt; OBServer node</code>. Specifically, an application server connects to and sends requests to ODP by calling database drivers. Then, ODP forwards the requests to the most appropriate OBServer nodes of OceanBase Database, which stores user data in multiple partitions and replicas across OBServer nodes in its distributed architecture. OBServer nodes execute the requests and return the execution results to the user. OBServer nodes also support request forwarding. If a request cannot be executed on the current OBServer node, it is forwarded to the appropriate OBServer node.</p>
<p>In the case of an end-to-end performance issue, such as long response time (RT) detected on the application server, you need to first find the component that has caused the issue on the database access link, and then troubleshoot the component.</p>
<p><img decoding="async" loading="lazy" alt="End-to-end tracing 01" src="/assets/images/001-f5115849eeee0c637b340f8359bcaf41.png" width="1125" height="953" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="End-to-end tracing 02" src="data:image/png;base64,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" width="1125" height="214" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="End-to-end tracing 03" src="data:image/png;base64,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" width="1125" height="338" class="img_ev3q"></p>
<p>Two paths are involved in end-to-end tracing:</p>
<ul>
<li>
<p>An application sends a request to ODP through a client, such as Java Database Connectivity (JDBC) or Oracle Call Interface (OCI), ODP forwards the request to an OBServer node, and then the OBServer node returns the result to the application.</p>
</li>
<li>
<p>An application directly sends a request to an OBServer node through a client, and then the OBServer node returns the result to the application.</p>
</li>
</ul>
<p>Here is an example:</p>
<ol>
<li>
<p>Use ODP to connect to OceanBase Database, create a table, and insert data into the table.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">create</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">table</span><span class="token plain"> t1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c1 </span><span class="token keyword" style="color:#00009f">int</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">insert</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">into</span><span class="token plain"> t1 </span><span class="token keyword" style="color:#00009f">values</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">123</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Enable end-to-end tracing for the current session.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SET</span><span class="token plain"> ob_enable_show_trace </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ON</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute a simple query statement.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> c1 </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> t1 </span><span class="token keyword" style="color:#00009f">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| c1   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  123 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 row in set</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the <code>SHOW TRACE</code> statement.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SHOW</span><span class="token plain"> TRACE</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------------------------------------------------+----------------------------+------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Operation                                                 | StartTime                  | ElapseTime |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------------------------------------------------+----------------------------+------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| ob_proxy                                                  | 2024-03-20 15:07:46.419433 | 191.999 ms |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| ├── ob_proxy_partition_location_lookup                    | 2024-03-20 15:07:46.419494 | 181.839 ms |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| ├── ob_proxy_server_process_req                           | 2024-03-20 15:07:46.601697 | 9.138 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| └── com_query_process                                     | 2024-03-20 15:07:46.601920 | 8.824 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|     └── mpquery_single_stmt                               | 2024-03-20 15:07:46.601940 | 8.765 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         ├── sql_compile                                   | 2024-03-20 15:07:46.601984 | 7.666 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         │   ├── pc_get_plan                               | 2024-03-20 15:07:46.602051 | 0.029 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         │   └── hard_parse                                | 2024-03-20 15:07:46.602195 | 7.423 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         │       ├── parse                                 | 2024-03-20 15:07:46.602201 | 0.137 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         │       ├── resolve                               | 2024-03-20 15:07:46.602393 | 0.555 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         │       ├── rewrite                               | 2024-03-20 15:07:46.603104 | 1.055 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         │       ├── optimize                              | 2024-03-20 15:07:46.604194 | 4.298 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         │       │   ├── inner_execute_read                | 2024-03-20 15:07:46.605959 | 0.825 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         │       │   │   ├── sql_compile                   | 2024-03-20 15:07:46.606078 | 0.321 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         │       │   │   │   └── pc_get_plan               | 2024-03-20 15:07:46.606124 | 0.147 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         │       │   │   ├── open                          | 2024-03-20 15:07:46.606418 | 0.129 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         │       │   │   └── do_local_das_task             | 2024-03-20 15:07:46.606606 | 0.095 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         │       │   └── close                             | 2024-03-20 15:07:46.606813 | 0.240 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         │       │       ├── close_das_task                | 2024-03-20 15:07:46.606879 | 0.022 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         │       │       └── end_transaction               | 2024-03-20 15:07:46.607009 | 0.023 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         │       ├── code_generate                         | 2024-03-20 15:07:46.608527 | 0.374 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         │       └── pc_add_plan                           | 2024-03-20 15:07:46.609375 | 0.207 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         └── sql_execute                                   | 2024-03-20 15:07:46.609677 | 0.832 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|             ├── open                                      | 2024-03-20 15:07:46.609684 | 0.156 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|             ├── response_result                           | 2024-03-20 15:07:46.609875 | 0.327 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|             │   └── do_local_das_task                     | 2024-03-20 15:07:46.609905 | 0.136 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|             └── close                                     | 2024-03-20 15:07:46.610221 | 0.225 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                 ├── close_das_task                        | 2024-03-20 15:07:46.610229 | 0.029 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                 └── end_transaction                       | 2024-03-20 15:07:46.610410 | 0.019 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------------------------------------------------+----------------------------+------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">29 rows in set</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The query result shows that:</p>
<ul>
<li>
<p>The execution of the SQL statement took a total of 191.999 ms.</p>
</li>
<li>
<p>The <code>ob_proxy_partition_location_lookup</code> operation took 181.839 ms, which was the time taken by ODP to search for the location of the leader of the <code>t1</code> table. This operation took a long time because the <code>t1</code> table was newly created and ODP had not cached its location information in the location. However, ODP will directly get the location information from the location cache upon next access to the table.</p>
</li>
<li>
<p>The <code>com_query_process</code> operation on the OBServer node to which the SQL statement was forwarded took 8.824 ms.</p>
</li>
</ul>
</li>
<li>
<p>Execute the <code>SELECT c1 FROM t1 LIMIT 2;</code> statement in the same session again, and then execute the <code>SHOW TRACE</code> statement.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SHOW</span><span class="token plain"> TRACE</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------------------------------------+----------------------------+------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Operation                                     | StartTime                  | ElapseTime |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------------------------------------+----------------------------+------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| ob_proxy                                      | 2024-03-20 15:34:14.879559 | 7.390 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| ├── ob_proxy_partition_location_lookup        | 2024-03-20 15:34:14.879652 | 4.691 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| ├── ob_proxy_server_process_req               | 2024-03-20 15:34:14.884785 | 1.514 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| └── com_query_process                         | 2024-03-20 15:34:14.884943 | 1.237 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|     └── mpquery_single_stmt                   | 2024-03-20 15:34:14.884959 | 1.207 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         ├── sql_compile                       | 2024-03-20 15:34:14.884997 | 0.279 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         │   └── pc_get_plan                   | 2024-03-20 15:34:14.885042 | 0.071 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         └── sql_execute                       | 2024-03-20 15:34:14.885300 | 0.809 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|             ├── open                          | 2024-03-20 15:34:14.885310 | 0.139 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|             ├── response_result               | 2024-03-20 15:34:14.885513 | 0.314 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|             │   └── do_local_das_task         | 2024-03-20 15:34:14.885548 | 0.114 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|             └── close                         | 2024-03-20 15:34:14.885847 | 0.190 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                 ├── close_das_task            | 2024-03-20 15:34:14.885856 | 0.030 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                 └── end_transaction           | 2024-03-20 15:34:14.885997 | 0.019 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------------------------------------+----------------------------+------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">14 rows in set</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The query result shows that:</p>
<ul>
<li>
<p>The execution time of the SQL statement was shortened from 191.999 ms to 7.390 ms.</p>
</li>
<li>
<p>The time taken by ODP to search for routing information and forwarding the SQL statement was shortened from 181.839 ms to 4.691 ms. This is because ODP directly obtained the location information from the location cache.</p>
</li>
<li>
<p>The time taken by the <code>com_query_process</code> operation on the OBServer node to which the SQL statement was forwarded was shortened from 8.824 ms to 1.237 ms. The execution of the preceding SQL statement was divided into two phases. In the compilation phase, the optimizer generated an execution plan. In the execution phase, the execution engine calculated results based on the execution plan. During the second execution, the time spent in the compilation phase was shortened. This is because an execution plan (<code>pc_get_plan</code>) has been generated and stored in the plan cache during the first execution and no plan needed to be generated again during the second execution. This way, the overhead of the <code>hard_parse</code> operation to parse the SQL statement and generate a plan was eliminated.</p>
</li>
</ul>
</li>
<li>
<p>Directly connect to the OBServer node to log on to OceanBase Database, execute the <code>SELECT c1 FROM t1 LIMIT 2;</code> statement again, and then execute the <code>SHOW TRACE</code> statement.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SHOW</span><span class="token plain"> TRACE</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------------------------------+----------------------------+------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Operation                                 | StartTime                  | ElapseTime |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------------------------------+----------------------------+------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| com_query_process                         | 2024-03-20 15:54:38.772699 | 1.746 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| └── mpquery_single_stmt                   | 2024-03-20 15:54:38.772771 | 1.647 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|     ├── sql_compile                       | 2024-03-20 15:54:38.772835 | 0.356 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|     │   └── pc_get_plan                   | 2024-03-20 15:54:38.772900 | 0.143 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|     └── sql_execute                       | 2024-03-20 15:54:38.773209 | 1.052 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         ├── open                          | 2024-03-20 15:54:38.773232 | 0.150 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         ├── response_result               | 2024-03-20 15:54:38.773413 | 0.421 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         │   └── do_local_das_task         | 2024-03-20 15:54:38.773479 | 0.192 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         └── close                         | 2024-03-20 15:54:38.773857 | 0.379 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|             ├── close_das_task            | 2024-03-20 15:54:38.773913 | 0.069 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|             └── end_transaction           | 2024-03-20 15:54:38.774139 | 0.058 ms   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------------------------------+----------------------------+------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">11 rows in set</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The query result shows that:</p>
<ul>
<li>
<p>The direct connection to the OBServer node eliminated ODP-related overheads.</p>
</li>
<li>
<p>The execution plan for the SQL statement was stored in the plan cache of the OBServer node. Therefore, hard parsing was not required in the compilation phase of the next execution.</p>
</li>
</ul>
</li>
</ol>
<p>To sum up, the end-to-end tracing feature allows you to query the time spent in each phase of the execution of an SQL statement with unexpected performance. You can execute the <code>SHOW TRACE</code> statement to check whether ODP forwarding, plan generation, or execution takes the longest time. The <code>SHOW TRACE</code> statement returns details about the time spent in each phase for you to further analyze the slow operations. In the preceding example, the <code>SHOW TRACE</code> statement does not return many details because the SQL statement is simple and the plan cache is used.</p>
<p>If ODP forwarding is slow, check whether the network between ODP and the OBServer node fails or whether ODP has not cached location information. For information about ODP performance analysis, see <a href="https://en.oceanbase.com/docs/common-odp-doc-en-10000000001177457" target="_blank" rel="noopener noreferrer">Performance analysis</a>.</p>
<p>If the execution is slow, check whether the index used in the execution plan is inappropriate and perform SQL tuning as needed. For more information about execution plans, see the preceding topics.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sql-audit">SQL audit<a href="#sql-audit" class="hash-link" aria-label="Direct link to SQL audit" title="Direct link to SQL audit">​</a></h3>
<p>The <code>GV$OB_SQL_AUDIT</code> view is the most frequently used SQL monitoring view. It records the source, execution status, resource consumption, and wait events of each SQL statement. It also records key information such as the SQL text and execution plans. Therefore, it is a great tool for SQL diagnostics. For more information, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001169151" target="_blank" rel="noopener noreferrer">SQL audit</a>.</p>
<p>In case of an online RT jitter where the RT is not constantly high, you may consider executing the <code>alter system set ob_enable_sql_audit = 0;</code> statement to disable SQL audit after the jitter occurs. This ensures that the SQL statement causing the jitter is not evicted from the <code>GV$OB_SQL_AUDIT</code> view.</p>
<p>Then you can query the <code>GV$OB_SQL_AUDIT</code> view for the top N SQL statements with the longest execution time within a specified period.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">-- Query the top N SQL statements with the longest execution time within a specified period.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*+ parallel(15) */</span><span class="token plain"> sql_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> elapsed_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> trace_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> substr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">query_sql</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">-- For ease of display, query_sql is truncated.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gv$ob_sql_audit     </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> tenant_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> IS_EXECUTOR_RPC </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> request_time </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">time_to_usec</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10000000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> request_time </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> time_to_usec</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> elapsed_time </span><span class="token keyword" style="color:#00009f">desc</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">limit</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------------------+--------------+------------------------------------+-------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| sql_id                           | elapsed_time | trace_id                           | substr(query_sql, 1, 6) |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------------------+--------------+------------------------------------+-------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 3BD6E04969DEE524A788E629AFD1D202 |       124223 | Y584A0BA1CC5A-0006141213C0C8FD-0-0 | select                  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| B6F2A13C4C81145FFAA2F2A5CF9587A9 |        19367 | Y584E0BA1CC5A-00061412076765AD-0-0 | select                  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| B6F2A13C4C81145FFAA2F2A5CF9587A9 |        18789 | Y58480BA1CC5B-00061412075A8FD9-0-0 | select                  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| B6F2A13C4C81145FFAA2F2A5CF9587A9 |        18307 | Y584E0BA1CC5A-00061412076765AE-0-0 | select                  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| B6F2A13C4C81145FFAA2F2A5CF9587A9 |        17801 | Y584E0BA1CC5A-00061412076765AF-0-0 | select                  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| B6F2A13C4C81145FFAA2F2A5CF9587A9 |        17305 | Y58480BA1CC5B-00061412075A8FD8-0-0 | select                  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| B6F2A13C4C81145FFAA2F2A5CF9587A9 |        16928 | Y58480BA1CC5B-00061412075A8FD7-0-0 | select                  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| B6F2A13C4C81145FFAA2F2A5CF9587A9 |        12575 | Y584A0BA1CC5A-00061412076125CC-0-0 | select                  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| B6F2A13C4C81145FFAA2F2A5CF9587A9 |        11960 | Y584A0BA1CC5A-00061412076125CB-0-0 | select                  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| B6F2A13C4C81145FFAA2F2A5CF9587A9 |        11869 | Y584A0BA1CC5A-00061412076125CA-0-0 | select                  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------------------+--------------+------------------------------------+-------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10 rows in set</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can analyze SQL statement exceptions based on the fields in the <code>GV$OB_SQL_AUDIT</code> view.</p>
<ul>
<li>
<p>Check the <code>GET_PLAN_TIME</code> field for the time spent in getting the execution plan. A long period of time often comes with the value of <code>IS_HIT_PLAN</code> being <code>0</code>, which indicates that the plan cache is not hit and hard parsing is performed.</p>
</li>
<li>
<p>Check the <code>SSSTORE_READ_ROW_COUNT</code> and <code>MEMSTORE_READ_ROW_COUNT</code> fields for buffer tables. For more information, see the <a href="#Buffer%20table_issues">Buffer table issues</a> section.</p>
</li>
<li>
<p>Check the <code>QUEUE_TIME</code> field for the queue time. A long queue time indicates that worker threads of the tenant are waiting. For more information, see the <a href="#Wait_issues">Wait issues</a> section.</p>
</li>
<li>
<p>Check the <code>RETRY_CNT</code> field for the number of retries. If the number is large, check for lock conflicts or leader switchovers.</p>
</li>
<li>
<p>Check the <code>EXECUTE_TIME</code> field and analyze the execution plan in combination with the <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001168178" target="_blank" rel="noopener noreferrer">GV$OB_PLAN_CACHE_PLAN_EXPLAIN</a> dictionary view. If the execution plan is inappropriate, determine whether to create an appropriate index or use a hint to modify the join order or join algorithm. For more information, see &#x27;7.6 Common SQL tuning methods&#x27;.</p>
</li>
</ul>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> c1 </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> t1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> c1   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">123</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> last_trace_id</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">------------------------------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> last_trace_id</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">------------------------------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Y584A0B9E1F14</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0006104</span><span class="token plain">BC96894F3</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">------------------------------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> QUERY_SQL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PLAN_ID</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> RETURN_ROWS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> NET_WAIT_TIME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> QUEUE_TIME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> GET_PLAN_TIME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> EXECUTE_TIME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain">  oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GV$OB_SQL_AUDIT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> trace_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Y584A0B9E1F14-0006104BC96894F3-0-0&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">-------------------+---------+-------------+---------------+------------+---------------+--------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> QUERY_SQL         </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> PLAN_ID </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> RETURN_ROWS </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> NET_WAIT_TIME </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> QUEUE_TIME </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> GET_PLAN_TIME </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> EXECUTE_TIME </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">-------------------+---------+-------------+---------------+------------+---------------+--------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> c1 </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> t1 </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">53777</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">           </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">            </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">         </span><span class="token number" style="color:#36acaa">46</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">           </span><span class="token number" style="color:#36acaa">234</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">          </span><span class="token number" style="color:#36acaa">664</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">-------------------+---------+-------------+---------------+------------+---------------+--------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p><strong>Note</strong></p>
<p>If the SQL statement causing the RT jitter has been evicted from the <code>GV$OB_SQL_AUDIT</code> view, you must check for trace logs of slow queries at the time of jitter and analyze these trace logs, if any.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sql-plan-monitor-advanced">SQL plan monitor (advanced)<a href="#sql-plan-monitor-advanced" class="hash-link" aria-label="Direct link to SQL plan monitor (advanced)" title="Direct link to SQL plan monitor (advanced)">​</a></h3>
<p>The SQL plan monitor feature analyzes performance issues for SQL statements with high DOPs and complex execution plans. It is integrated in obdiag to monitor the real-time execution of operators for the following types of SQL statements:</p>
<ul>
<li>
<p>SQL statements containing the <code>/*+ monitor*/</code> hint</p>
</li>
<li>
<p>SQL statements using distributed execution plans with <code>parallel &gt; 1</code></p>
</li>
<li>
<p>SQL statements with their execution time exceeding 1s</p>
</li>
</ul>
<p>This feature is more complex than end-to-end tracing and SQL audit. Before you use it to analyze an SQL statement, you must read the execution plan for the SQL statement. You can use obdiag to collect the information recorded by SQL plan monitor. This way, you can identify slow operators and check whether tasks are evenly distributed to the threads of a slow operator in parallel execution or whether performance issues are caused by concentration of data in a few threads.</p>
<p>Here is an example: Perform an aggregation operation with a DOP of 3. If the generated plan is not a parallel plan, you must add the <code>/*+monitor*/</code> hint to enable SQL plan monitor.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*+parallel(3) */</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> t1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">-----------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">COUNT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">C1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">-----------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">110000000</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">-----------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> last_trace_id</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> dual</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">------------------------------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> LAST_TRACE_ID</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">                    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">------------------------------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Y58480B7C052B</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0005</span><span class="token plain">EB5FF9C060FC</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">------------------------------------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Collect the information recorded by SQL plan monitor based on the trace ID.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">admin</span><span class="token variable" style="color:#36acaa">@test001</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">obdiag</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">$ obdiag gather plan_monitor </span><span class="token comment" style="color:#999988;font-style:italic">--trace_id Y58480B7C052B-0005EB5FF9C060FC-0-0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>An HTML file is returned. You can open it to view the collected information.</p>
<p><img decoding="async" loading="lazy" alt="Sample information" src="/assets/images/004-d17fcd405b8ec34b03b22e8f308c529d.png" width="1393" height="319" class="img_ev3q"></p>
<p>The preceding SQL statement is simple and has a simple execution plan that involves <code>COUNT</code> operations in two phases. In the first phase, three threads of Operator 3 perform <code>COUNT</code> operations separately. In the second phase, Operator 0 calculates the sum of count results from all threads. The following figure shows the sample information returned by SQL plan monitor. You can view the number of threads used by each operator and the number of rows returned by each operator.</p>
<p><img decoding="async" loading="lazy" alt="Example" src="/assets/images/005-ff98d530922fc70c44187c10afb1a37e.png" width="1125" height="322" class="img_ev3q"></p>
<p>In the preceding figure, the granule count for the <code>PHY_GRANULE_ITERATOR</code> operator is highlighted in yellow. If multiple granules exist, one granule is distributed to each of the three threads at first. After a thread completes the granule distributed to it, it contends for other granules in the pool. You can move your pointer over the block highlighted in yellow to view the granule count. In the preceding figure, the job is divided into 12 granules. For more information about granules, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001378041" target="_blank" rel="noopener noreferrer">Introduction to parallel execution</a>.</p>
<p>The <code>RESCAN</code> column in the following figure shows that the three threads have processed data of 1+2, 1+3, and 1+4 granules respectively. 1 indicates the granule originally distributed to each thread. 2, 3, and 4 indicate the granules that the threads subsequently contended for from the pool.</p>
<p><img decoding="async" loading="lazy" alt="Details" src="/assets/images/006-d3016f80ae1cf1b1db4851446b87859f.png" width="1125" height="807" class="img_ev3q"></p>
<p>In this example, the granules are almost evenly distributed because the amount of data is very small.</p>
<p>When an operator involves a large amount of data, a large number of threads may be allocated to it. If only a few threads are working, you can collect the information recorded by SQL plan monitor and post it to the Q&amp;A module in the OceanBase community or send it to OceanBase Technical Support. For example, in the following figure, a few threads of the <code>HASH JOIN</code> operator processed most of the data.</p>
<p><img decoding="async" loading="lazy" alt="image" src="/assets/images/007-8e0bf3e29da9916eb9960e7bd50795ea.png" width="1204" height="466" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="typical-scenarios-of-sql-performance-issues-for-observer-nodes">Typical scenarios of SQL performance issues for OBServer nodes<a href="#typical-scenarios-of-sql-performance-issues-for-observer-nodes" class="hash-link" aria-label="Direct link to Typical scenarios of SQL performance issues for OBServer nodes" title="Direct link to Typical scenarios of SQL performance issues for OBServer nodes">​</a></h2>
<p>When an OBServer node hits a performance bottleneck, you need to first identify whether the worker thread is blocked or has been running for a long time. The former case indicates that the worker thread is waiting for a system object, and the latter case indicates that the worker thread is scanning a large amount of data or that resources are insufficient. You must use different solutions for performance bottlenecks due to different root causes.</p>
<p>OceanBase Database provides a variety of internal tables and system logs for you to locate performance bottlenecks of OBServer nodes. For example, you can analyze OBServer node behaviors by using the SQL audit feature.</p>
<ul>
<li>
<p>Running state exceptions</p>
<p>Running state exceptions are likely related to execution plans. For example, if the execution plan generated by the optimizer for the SQL query is not the optimal one, a large amount of data may be scanned. If the hit rate of the cache plan is low, the SQL execution may take extra time for compilation. Insufficient resource during the execution can also result in a running state exception. Generally, running state exceptions can be solved by adjusting the execution plan or increasing resources.</p>
</li>
<li>
<p>Blocked state exceptions</p>
<p>A worker thread of OceanBase Database is either running in the CPU or waiting for resources, such as I/O resources, network bandwidth, and critical sections. A worker thread is in the blocked state when it is waiting for resources. The blocking of worker threads indicates a concurrency bottleneck of the system and the throughput cannot be increased by adding more resources. To solve blocked state exceptions, you must first find the bottleneck and handle it with a specific optimization solution.</p>
</li>
</ul>
<p>The following figure shows the major types of OBServer node exceptions based on the preceding analysis:</p>
<p><img decoding="async" loading="lazy" alt="Performance jitter" src="/assets/images/008-0e80b1ed415106a12f3519c79bf97c5d.png" width="1125" height="689" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="execution-issues">Execution issues<a href="#execution-issues" class="hash-link" aria-label="Direct link to Execution issues" title="Direct link to Execution issues">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="non-optimal-plans">Non-optimal plans<a href="#non-optimal-plans" class="hash-link" aria-label="Direct link to Non-optimal plans" title="Direct link to Non-optimal plans">​</a></h4>
<p>The execution process of an SQL query is divided into a compilation phase and an execution phase. An execution plan is generated in the compilation phase, which consists of several sub-phases such as lexical parsing, syntax parsing, syntax optimization, and code generation. Then, the execution plan is submitted to the executor for execution, and the result is returned. The process of parsing an SQL query to generate the execution plan is known as hard parsing. Hard parsing consumes considerable resources and affects the duration of SQL execution. Therefore, a generated execution plans is stored in the plan cache. When the same SQL query is received next time, the system first checks whether it hits the plan cache. If yes, the cached plan is extracted and submitted to the executor for execution. This process is defined as soft parsing. This way, it is unnecessary to perform hard parsing for each SQL query, thereby reducing resource consumption. Therefore, the key to performance tuning is to make sure that SQL queries hit the plan cache and the plan is optimal.</p>
<p><img decoding="async" loading="lazy" alt="Execution process" src="/assets/images/009-c680e307dd11d6fb19dbbffc55ab3345.png" width="1125" height="703" class="img_ev3q"></p>
<p>The optimizer may generate suboptimal execution plans due to various reasons, such as missing indexes, outdated statistics, buffer tables, and cardinality. The execution of a suboptimal execution plan requires massive logical reads and scanning of a large amount of data. As a result, the time consumption increases and the throughput decreases.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="buffer-table-issues">Buffer table issues<a href="#buffer-table-issues" class="hash-link" aria-label="Direct link to Buffer table issues" title="Direct link to Buffer table issues">​</a></h5>
<p>Data is frequently inserted to or deleted from a buffer table. An index table is also a buffer table. When the indexed column of a primary table is updated, data is inserted to or deleted from the index table.</p>
<p>Buffer tables arise from the LSM-tree-based storage engine of OceanBase Database. In an LSM-tree architecture, deleted data is first labeled &quot;deleted&quot; but is physically deleted only after a major compaction. If a large amount of incremental data is labeled &quot;deleted&quot;, few rows are actually available for upper-layer applications. In addition, the labeled data may be processed during range queries, which is time-consuming and results in long execution time of SQL queries. In the presence of buffer tables, the optimizer is prone to generate suboptimal execution plans.</p>
<p>Buffer tables are an SQL exception that is triggered only when the following conditions are met: (1) Most data inserted into a table will be deleted soon, that is, only a small amount of data persists in the table. In general, OceanBase Database recycles data block holes (unused space) from the table to avoid exceptions. (2) A great deal of data is inserted and deleted in a short period of time, and data block holes of the table are not efficiently recycled, or data in the table piles up because the inserted data amount is larger than the deleted data amount. In this case, the database actually scans lots of data in the table, leading to SQL performance deterioration.</p>
<p>Here is an example: Insert 1,000 rows of data into a table, delete every other row to keep 500 rows, and then scan the table. Check the <code>physical_range_rows</code> and <code>logical_range_rows</code> fields in the execution plan for the number of physical rows actually scanned and the number of logical rows to be scanned in the table.</p>
<blockquote>
<p><strong>Note</strong></p>
<p>After the SQL statement is executed, you can also check the <code>SSSTORE_READ_ROW_COUNT</code> and <code>MEMSTORE_READ_ROW_COUNT</code> fields in the <code>GV$OB_SQL_AUDIT</code> view for the numbers of physical rows and logical rows scanned.</p>
</blockquote>
<ol>
<li>
<p>Create a table for buffer table testing.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">create</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">table</span><span class="token plain"> t1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c1 </span><span class="token keyword" style="color:#00009f">int</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Insert 1,000 rows of data into the table.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">insert</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">into</span><span class="token plain"> t1 </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> recursive cte</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">n</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> dual </span><span class="token keyword" style="color:#00009f">union</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">all</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> n </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> cte </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> n </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> n </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> cte</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Delete every other row to keep 500 rows.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">delete</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> t1 </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> c1 </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query the execution plan.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">explain</span><span class="token plain"> extended_noaddr </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> t1</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows. Check the <code>physical_range_rows</code> and <code>logical_range_rows</code> fields in the execution plan.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Query Plan                                                        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| ===============================================                   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| |ID|OPERATOR       |NAME|EST.ROWS|EST.TIME(us)|                   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| -----------------------------------------------                   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| |0 |TABLE FULL SCAN|t1  |501     |38          |                   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| ===============================================                   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Outputs &amp; filters:                                                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| -------------------------------------                             |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   0 - output([t1.c1]), filter(nil), rowset=256                    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       access([t1.c1]), partitions(p0)                             |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       is_index_back=false, is_global_index=false,                 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       range_key([t1.__pk_increment]), range(MIN ; MAX)always true |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| ......                                                            |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Optimization Info:                                                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| -------------------------------------                             |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   t1:                                                             |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       table_rows:501                                              |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       physical_range_rows:1000                                    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       logical_range_rows:500                                      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       index_back_rows:0                                           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       output_rows:501                                             |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       table_dop:1                                                 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       dop_method:Table DOP                                        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       avaiable_index_name: [t1]                                    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       stats version:0                                             |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       dynamic sampling level:0                                    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   Plan Type:                                                      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       LOCAL                                                       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   Note:                                                           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       Degree of Parallelisim is 1 because of table property       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">45 rows in set</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For more information about the <code>physical_range_rows</code> and <code>logical_range_rows</code> fields, see &#x27;7.5 Read and manage SQL execution plans in OceanBase Database&#x27;. The <code>logical_range_rows</code> field indicates that only 500 logical rows need to be scanned. However, in the LSM-tree architecture, deleted data is only labeled &quot;deleted&quot; but not physically deleted until a major compaction. Therefore, the number of physical rows actually scanned that is indicated by the <code>physical_range_rows</code> field is still 1000.</p>
<p>In this case, you can manually initiate a major compaction and then check the <code>physical_range_rows</code> and <code>logical_range_rows</code> fields in the execution plan.</p>
</li>
<li>
<p>Manually initiate a major compaction.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">ALTER</span><span class="token plain"> SYSTEM MAJOR FREEZE</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For more information, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001169027" target="_blank" rel="noopener noreferrer">Manually initiate a major compaction</a>.</p>
</li>
<li>
<p>Query the major compaction progress.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> START_TIME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> LAST_FINISH_TIME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">STATUS</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBA_OB_MAJOR_COMPACTION</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For more information, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001169024" target="_blank" rel="noopener noreferrer">View the major compaction process</a>.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------------+----------------------------+--------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| START_TIME                 | LAST_FINISH_TIME           | STATUS |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------------+----------------------------+--------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 2024-03-20 17:54:18.610008 | 2024-03-20 17:54:50.738156 | IDLE   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------------+----------------------------+--------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 row in set</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query the execution plan again.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">explain</span><span class="token plain"> extended_noaddr </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> t1</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows. Check the <code>physical_range_rows</code> and <code>logical_range_rows</code> fields in the execution plan.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Query Plan                                                        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| ===============================================                   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| |ID|OPERATOR       |NAME|EST.ROWS|EST.TIME(us)|                   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| -----------------------------------------------                   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| |0 |TABLE FULL SCAN|t1  |501     |21          |                   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| ===============================================                   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Outputs &amp; filters:                                                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| -------------------------------------                             |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   0 - output([t1.c1]), filter(nil), rowset=256                    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       access([t1.c1]), partitions(p0)                             |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       is_index_back=false, is_global_index=false,                 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       range_key([t1.__pk_increment]), range(MIN ; MAX)always true |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| ......                                                            |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Optimization Info:                                                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| -------------------------------------                             |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   t1:                                                             |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       table_rows:501                                              |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       physical_range_rows:500                                     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       logical_range_rows:500                                      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       index_back_rows:0                                           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       output_rows:501                                             |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       table_dop:1                                                 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       dop_method:Table DOP                                        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       avaiable_index_name: [t1]                                    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       stats version:0                                             |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       dynamic sampling level:0                                    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   Plan Type:                                                      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       LOCAL                                                       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   Note:                                                           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|       Degree of Parallelisim is 1 because of table property       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">45 rows in set</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The major compaction has physically deleted the data labeled &quot;deleted&quot; and removed data block holes. Therefore, the value of <code>physical_range_rows</code> is the same as that of <code>logical_range_rows</code>.</p>
</li>
</ol>
<p>To sum up, you can check the <code>physical_range_rows</code> and <code>logical_range_rows</code> fields in the execution plan for buffer tables. If the values of the two fields differ greatly, the table is a buffer table. You can manually initiate a major compaction to solve this problem. If you have concerns that the major compaction will take a long time, you can also use hints or outlines to optimize the execution plan.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="bad-case-of-the-plan-cache-cardinality">Bad case of the plan cache (cardinality)<a href="#bad-case-of-the-plan-cache-cardinality" class="hash-link" aria-label="Direct link to Bad case of the plan cache (cardinality)" title="Direct link to Bad case of the plan cache (cardinality)">​</a></h5>
<p>An optimal execution plan generated by the optimizer for the current dataset will be stored in the plan cache. However, this plan may not be optimal for subsequent datasets. As a result, a subsequent SQL query that hits the plan cache may take a long time. This is called a bad case of the plan cache.</p>
<p>For more information, see the <strong>Bad case of the plan cache</strong> section in &#x27;7.6 Common SQL tuning methods&#x27;.</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="hard-parsing">Hard parsing<a href="#hard-parsing" class="hash-link" aria-label="Direct link to Hard parsing" title="Direct link to Hard parsing">​</a></h5>
<p>Hard parsing is a complete SQL compilation process, which is frequently performed for SQL queries when the hit rate of the plan cache is low. Therefore, hard parsing increases the SQL execution duration. You can check the values of the <code>GET_PLAN_TIME</code> field in the <code>GV$OB_SQL_AUDIT</code> view to determine whether the time consumed to generate an execution plan is abnormal. The duration of plan generation is usually less than 0.1 ms, but can be increased to more than 100 ms in the case of a request exception.</p>
<p>This is usually because a small cache size is configured and execution plans are therefore frequently evicted. You can use the system variable <code>ob_plan_cache_percentage</code> to increase the percentage of tenant memory available for the plan cache. The absolute value of the maximum memory size available for the plan cache is calculated by using the following formula: Maximum memory size for the tenant × <code>ob_plan_cache_percentage</code>/100. The default value of <code>ob_plan_cache_percentage</code> is <code>5</code>.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">show</span><span class="token plain"> variables </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ob_plan_cache_percentage&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">--------------------------+-------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Variable_name            </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Value</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">--------------------------+-------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> ob_plan_cache_percentage </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain">     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">--------------------------+-------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">row</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.010</span><span class="token plain"> sec</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">-- Modify the system variable `ob_plan_cache_percentage` of the tenant.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">global</span><span class="token plain"> ob_plan_cache_percentage </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">show</span><span class="token plain"> variables </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ob_plan_cache_percentage&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">--------------------------+-------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Variable_name            </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">Value</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">--------------------------+-------+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> ob_plan_cache_percentage </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">+</span><span class="token comment" style="color:#999988;font-style:italic">--------------------------+-------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For more information, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001166969" target="_blank" rel="noopener noreferrer">Modify system variables of a tenant</a>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="capacity-issues-during-execution">Capacity issues during execution<a href="#capacity-issues-during-execution" class="hash-link" aria-label="Direct link to Capacity issues during execution" title="Direct link to Capacity issues during execution">​</a></h4>
<p>If you confirm that the performance bottleneck is not caused by the execution plan, it is likely caused by capacity issues.</p>
<p>If the performance bottleneck is caused by suboptimal plans, you can find a large number of logical reads and time-consuming SQL queries in the <code>GV$OB_SQL_AUDIT</code> view, and the execution duration is prolonged mainly due to the increase of CPU time.</p>
<p>You can query the <code>GV$OB_SQL_AUDIT</code> view. If the value of the <code>QUEUE_TIME</code> field increases significantly, and no SQL query involves a large number of logical reads or results in a large value for the <code>EXECUTE_TIME</code> field, the performance bottleneck is caused by capacity issues.</p>
<p>These issues may occur in the following scenarios:</p>
<ul>
<li>
<p>Increase of application traffic If the execution plans of top SQL statements are not changed, but the CPU utilization of the tenant and the number of SQL executions increase, the performance issue is likely caused by the increase of application traffic.</p>
</li>
<li>
<p>Changes of application workload Changes of application workload, such as the increase in the number of large queries, also cause performance issues.</p>
</li>
<li>
<p>Contention of computing resources at the infrastructure layer</p>
</li>
</ul>
<p>You can use the following methods to solve capacity issues:</p>
<ul>
<li>
<p>Throttle specific SQL statements. For more information about the throttling methods, see <a href="https://en.oceanbase.com/docs/common-ocp-10000000001188039" target="_blank" rel="noopener noreferrer">Apply throttling to an OceanBase cluster</a>.</p>
</li>
<li>
<p>Increase the maximum number of CPU cores for a tenant.</p>
</li>
<li>
<p>Adjust cluster parameters. The cluster parameter <code>cpu_quota_concurrency</code> specifies the number of worker threads provided by the CPU cores of a tenant. The minimum number of worker threads for a tenant is calculated by using the following formula: <code>cpu_quota_concurrency</code> × <code>MIN_CPU</code>. When a capacity issue occurs in a tenant, if the CPU workload of the physical server is not high, it indicates that most worker threads do not use CPU resources. You can set the <code>cpu_quota_concurrency</code> parameter to a proper larger value, so that more computing resources of the physical server are available for the worker threads. Note that an excessively large value leads to frequent context switching and frequent creation and termination of threads, which result in system issues. For more information about the <code>cpu_quota_concurrency</code> parameter, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001168673" target="_blank" rel="noopener noreferrer">cpu_quota_concurrency</a>.</p>
<ol>
<li>
<p>Query the value of the <code>cpu_quota_concurrency</code> parameter.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">show</span><span class="token plain"> parameters </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;cpu_quota_concurrency&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+--------------+----------+-----------------------+-----------+-------+--------------------------------------------------------+---------+--------+---------+-------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone  | svr_type | svr_ip       | svr_port | name                  | data_type | value | info                                                   | section | scope  | source  | edit_level        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+--------------+----------+-----------------------+-----------+-------+--------------------------------------------------------+---------+--------+---------+-------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | observer | 1.2.3.4      |    12345 | cpu_quota_concurrency | NULL      | 2     | max allowed concurrency for 1 CPU quota. Range: [1,20] | TENANT  | TENANT | DEFAULT | DYNAMIC_EFFECTIVE |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+--------------+----------+-----------------------+-----------+-------+--------------------------------------------------------+---------+--------+---------+-------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 row in set</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Modify the parameter.</p>
<p>We recommend that you set the parameter to <code>4</code>, or <code>2</code> in an advanced RISC machine (ARM) system. If you decrease the value of the parameter, performance and even stability may be affected. If you increase the value of the parameter, memory usage and CPU utilization may increase. Proceed with caution.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">ALTER</span><span class="token plain"> SYSTEM </span><span class="token keyword" style="color:#00009f">SET</span><span class="token plain"> cpu_quota_concurrency </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;4&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query the value of the parameter again.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">show</span><span class="token plain"> parameters </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;cpu_quota_concurrency&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+--------------+----------+-----------------------+-----------+-------+--------------------------------------------------------+---------+--------+---------+-------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone  | svr_type | svr_ip       | svr_port | name                  | data_type | value | info                                                   | section | scope  | source  | edit_level        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+--------------+----------+-----------------------+-----------+-------+--------------------------------------------------------+---------+--------+---------+-------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | observer | 1.2.3.4      |    12345 | cpu_quota_concurrency | NULL      | 4     | max allowed concurrency for 1 CPU quota. Range: [1,20] | TENANT  | TENANT | DEFAULT | DYNAMIC_EFFECTIVE |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+--------------+----------+-----------------------+-----------+-------+--------------------------------------------------------+---------+--------+---------+-------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 row in set</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
</li>
</ul>
<blockquote>
<p><strong>Note</strong></p>
<p>We recommend that you solve a capacity issue by increasing the maximum number of CPU cores for the tenant or the value of <code>cpu_quota_concurrency</code>. More worker threads require more memory resources. Therefore, you may also need to increase the maximum memory size for the tenant.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wait-issues">Wait issues<a href="#wait-issues" class="hash-link" aria-label="Direct link to Wait issues" title="Direct link to Wait issues">​</a></h3>
<p>If you confirm that the performance bottleneck is not caused by execution plans or resource capacity issues during the execution, it is likely caused by internal wait events.</p>
<p>In an internal wait event, the worker threads wait for the required resources, such as locks, latches, I/O, and memory.</p>
<p>You can query the <code>GV$OB_SQL_AUDIT</code> view. If you can find SQL queries that result in a large value of the <code>EXECUTE_TIME</code> field, and the execution duration is prolonged mainly due to the increase of the value of <code>TOTAL_WAIT_TIME_MICRO</code>, the performance bottleneck is caused by internal wait events. The value of <code>TOTAL_WAIT_TIME_MICRO</code> is the sum of the values of <code>APPLICATION_WAIT_TIME</code>, <code>CONCURRENCY_WAIT_TIME</code>, <code>USER_IO_WAIT_TIME</code>, and <code>SCHEDULE_TIME</code>. You can further determine the types of resources that the worker threads are waiting for.</p>
<p>The <code>GV$OB_SQL_AUDIT</code> view displays the following information about wait events:</p>
<ul>
<li>
<p>The wait time of four classes of wait events: <code>APPLICATION_WAIT_TIME</code>, <code>CONCURRENCY_WAIT_TIME</code>, <code>USER_IO_WAIT_TIME</code>, and <code>SCHEDULE_TIME</code>. Each class involves many specific wait events.</p>
</li>
<li>
<p>The name of the most time-consuming wait event, which is indicated by <code>EVENT</code>, and the time consumed, which is indicated by <code>WAIT_TIME_MICRO</code>.</p>
</li>
<li>
<p>The number of occurrences of all wait events, which is indicated by <code>TOTAL_WAITS</code>, and the total time consumed, which is indicated by <code>TOTAL_WAIT_TIME_MICRO</code>.</p>
</li>
</ul>
<p>If a large amount of time is consumed by wait events, you can check <code>EVENT</code> for the specific types of most time-consuming wait events. For example, the following SQL statement with a specified <code>trace_id</code> spent most time in waiting for an I/O operation to read data from the index.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> sql_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> elapsed_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> queue_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> get_plan_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> execute_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       application_wait_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> concurrency_wait_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> user_io_wait_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       schedule_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> wait_class</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> wait_time_micro</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> total_wait_time_micro </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gv$ob_sql_audit </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> trace_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;YB420B84FE35-0005648A67211DC9&#x27;</span><span class="token plain">\G</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">*************************** 1. row ***************************</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               sql_id: 5316DBF96556040831142D61BBD9014F</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         elapsed_time: 953</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           queue_time: 18</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        get_plan_time: 58</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         execute_time: 867</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">application_wait_time: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">concurrency_wait_time: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    user_io_wait_time: 550</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        schedule_time: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                event: db file data index read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           wait_class: USER_IO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      wait_time_micro: 352</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">total_wait_time_micro: 550</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then you can use the SQL audit feature to identify the SQL statements that cause a large number of disk I/O operations and result in I/O wait events in other worker threads of the tenant. For more information, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001166527" target="_blank" rel="noopener noreferrer">Cases</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="afterword">Afterword<a href="#afterword" class="hash-link" aria-label="Direct link to Afterword" title="Direct link to Afterword">​</a></h2>
<p>Sections 7.4 to 7.7 of Chapter 7 describe only commonly used analysis tools. You are not likely to become an expert in SQL performance analysis simply by reading them. You must also gradually accumulate experience in extensive practices.</p>
<p>Hopefully, this chapter can give you some inspiration in diagnosing SQL performance issues. If the methods described in this chapter cannot solve your problems, you can post your questions to the <a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer">Q&amp;A</a> forum in the OceanBase community. OceanBase Technical Support will help you out.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/oceanbase/oceanbase.github.io/tree/main/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/07_troubleshooting_sql_performance_issues.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/sql_tuning"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Common SQL tuning methods</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/performance_diagnosis_by_sql_diagnoser"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Use SQL Diagnoser to diagnose and analyze SQL performance issues</div></a></nav><div>Loading...</div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tools-for-analyzing-sql-performance-issues" class="table-of-contents__link toc-highlight">Tools for analyzing SQL performance issues</a><ul><li><a href="#end-to-end-tracing" class="table-of-contents__link toc-highlight">End-to-end tracing</a></li><li><a href="#sql-audit" class="table-of-contents__link toc-highlight">SQL audit</a></li><li><a href="#sql-plan-monitor-advanced" class="table-of-contents__link toc-highlight">SQL plan monitor (advanced)</a></li></ul></li><li><a href="#typical-scenarios-of-sql-performance-issues-for-observer-nodes" class="table-of-contents__link toc-highlight">Typical scenarios of SQL performance issues for OBServer nodes</a><ul><li><a href="#execution-issues" class="table-of-contents__link toc-highlight">Execution issues</a></li><li><a href="#wait-issues" class="table-of-contents__link toc-highlight">Wait issues</a></li></ul></li><li><a href="#afterword" class="table-of-contents__link toc-highlight">Afterword</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="http://github.com/oceanbase/oceanbase/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussion<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://join.slack.com/t/oceanbase/shared_invite/zt-1e25oz3ol-lJ6YNqPHaKwY_mhhioyEuw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/oceanbase" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum (in Chinese)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">SIG</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/sig/AI/sig_intro">AI</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/cloud-native/sig_intro">cloud-native</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/compilation/sig_intro">compilation</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/develop-tools/sig_intro">develop-tools</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/miniob/sig_intro">MiniOB</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/obdiag/sig_intro">obdiag</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/operation/sig_intro">operation</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://en.oceanbase.com/about" target="_blank" rel="noopener noreferrer" class="footer__link-item">About OceanBase<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/blogs/arch/all-in-one">Blogs</a></li><li class="footer__item"><a href="https://github.com/oceanbase/oceanbase" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 OceanBase, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>