<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-user_manual/quick_starts_and_hands_on_practices_in_english/chapter_05_operation_and_maintenance/o_m_by_sql" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Perform O&amp;M by using SQL statements | OceanBase</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://oceanbase.github.io/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_05_operation_and_maintenance/o_m_by_sql"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Perform O&amp;M by using SQL statements | OceanBase"><meta data-rh="true" name="description" content="This topic describes the common SQL statements and how to collect logs for troubleshooting in different database exception scenarios."><meta data-rh="true" property="og:description" content="This topic describes the common SQL statements and how to collect logs for troubleshooting in different database exception scenarios."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://oceanbase.github.io/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_05_operation_and_maintenance/o_m_by_sql"><link data-rh="true" rel="alternate" href="https://oceanbase.github.io/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_05_operation_and_maintenance/o_m_by_sql" hreflang="en"><link data-rh="true" rel="alternate" href="https://oceanbase.github.io/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_05_operation_and_maintenance/o_m_by_sql" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6JQM9QDU5V-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.7e3a93fe.css">
<script src="/assets/js/runtime~main.fbe61914.js" defer="defer"></script>
<script src="/assets/js/main.7c82b3e0.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="OceanBase Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="OceanBase Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">OceanBase</b></a><a class="navbar__item navbar__link" href="/docs/blogs/arch/all-in-one">Blogs</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Docs</a><ul class="dropdown__menu"><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">Product Docs</a><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">User Manual</a><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">Developer Manual</a></ul><ul class="dropdown__menu" style="left:160px;display:none"></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">Special Interest Group(SIG)</a><span><li><a href="http://github.com/oceanbase/oceanbase/discussions" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub Discussion<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://join.slack.com/t/oceanbase/shared_invite/zt-1e25oz3ol-lJ6YNqPHaKwY_mhhioyEuw" target="_blank" rel="noopener noreferrer" class="dropdown__link">Slack<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Forum (in Chinese)<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://stackoverflow.com/questions/tagged/oceanbase" target="_blank" rel="noopener noreferrer" class="dropdown__link">Stack Overflow<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span></ul><ul class="dropdown__menu" style="left:160px;display:none"></ul></div><a href="https://en.oceanbase.com/softwarecenter" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Downloads<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/oceanbase" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_01_overview_of_the_oceanbase_database/introduction">Overview of the Oceanbase database</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_02_deploy_oceanbase_database/introduction">Deploy Oceanbase database</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_03_test_oceanbase_database/introduction">Test Oceanbase database</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_04_migration_and_synchronization_oceanbase/introduction">Migrate and synchronize data</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_05_operation_and_maintenance/introduction">Operation and maintenance</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_05_operation_and_maintenance/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_05_operation_and_maintenance/o_m_by_ocp">Perform O&amp;M by using OCP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_05_operation_and_maintenance/o_m_by_obd">Perform O&amp;M by using OBD</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_05_operation_and_maintenance/o_m_by_ob-operator">Perform O&amp;M by using ob-operator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_05_operation_and_maintenance/o_m_by_sql">Perform O&amp;M by using SQL statements</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_06_using_ob_for_business_development/introduction">Using Oceanbase for business development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_07_diagnosis_and_tuning/introduction">Diagnosis_and_tuning</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Operation and maintenance</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Perform O&amp;M by using SQL statements</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>5.4 Perform O&amp;M by using SQL statements</h1></header>
<p>This topic describes the common SQL statements and how to collect logs for troubleshooting in different database exception scenarios.</p>
<blockquote>
<p><strong>Note</strong></p>
<p>The official documents referenced in this tutorial are of the latest version available at the time of writing or the Long-Term Support (LTS) version. You can switch to another version as needed in the upper-left corner of the document page.</p>
</blockquote>
<p>SQL statements are the most basic method for database O&amp;M. At present, basic cluster management operations are all performed by using SQL statements. For more information, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001103367" target="_blank" rel="noopener noreferrer">Manage</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="common-sql-statements">Common SQL statements<a href="#common-sql-statements" class="hash-link" aria-label="Direct link to Common SQL statements" title="Direct link to Common SQL statements">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sql-statements-for-basic-cluster-management">SQL statements for basic cluster management<a href="#sql-statements-for-basic-cluster-management" class="hash-link" aria-label="Direct link to SQL statements for basic cluster management" title="Direct link to SQL statements for basic cluster management">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="query-the-database-name">Query the database name<a href="#query-the-database-name" class="hash-link" aria-label="Direct link to Query the database name" title="Direct link to Query the database name">​</a></h4>
<p>When you log on to OceanBase Database through OceanBase Database Proxy (ODP), you may encounter the error <code>ERROR 4669 (HY000): cluster not exist</code>. The reason for this is an incorrect name of the OceanBase cluster (or the database name). For example, if OceanBase Database is deployed by using OBD, the <code>obd cluster list</code> command returns the name of the deployed cluster that the OceanBase Database component belongs to, rather than the database name. You can log on to OceanBase Database and execute the following statement to query the database name:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">show</span><span class="token plain"> parameters </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;cluster&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows, where the value in the <code>value</code> column is the database name, which is <code>metadb</code> in this example.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+----------------+----------+---------+-----------+--------+---------------------+----------+---------+---------+-------------------+---------------+-----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone  | svr_type | svr_ip         | svr_port | name    | data_type | value  | info                | section  | scope   | source  | edit_level        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+----------------+----------+---------+-----------+--------+---------------------+----------+---------+---------+-------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | observer | 10.10.10.1     |     2882 | cluster | STRING    | metadb | Name of the cluster | OBSERVER | CLUSTER | DEFAULT | DYNAMIC_EFFECTIVE |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+----------------+----------+---------+-----------+--------+---------------------+----------+---------+---------+-------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="query-the-database-version">Query the database version<a href="#query-the-database-version" class="hash-link" aria-label="Direct link to Query the database version" title="Direct link to Query the database version">​</a></h4>
<p>Apart from running the <code>./bin/observer --version</code> command to query the database version from a binary file, you can also execute the following statements in the database to query the version number:</p>
<ul>
<li>
<p>Query the parameter that specifies the database version</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SHOW</span><span class="token plain"> VARIABLES </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;version_comment&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------+------------------------------------------------------------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| Variable_name   | Value                                                                                                            |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------+------------------------------------------------------------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| version_comment | OceanBase_CE 4.2.1.2 (r102000042023120514-ccdde7d34de421336c5362483d64bf2b73348bd4) (Built Dec  5 2023 14:34:01) |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------+------------------------------------------------------------------------------------------------------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query the <code>DBA_OB_SERVERS</code> view for the database version</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> BUILD_VERSION </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBA_OB_SERVERS</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows. For more information about the <code>DBA_OB_SERVERS</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104271" target="_blank" rel="noopener noreferrer">oceanbase.DBA_OB_SERVERS</a>.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------------------------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| BUILD_VERSION                                                                             |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------------------------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 4.2.1.2_102000042023120514-ccdde7d34de421336c5362483d64bf2b73348bd4(Dec  5 2023 14:34:01) |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------------------------------------------------------------------------------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="query-the-rootservice-leader">Query the RootService leader<a href="#query-the-rootservice-leader" class="hash-link" aria-label="Direct link to Query the RootService leader" title="Direct link to Query the RootService leader">​</a></h4>
<p>RootService is the control center of a cluster and is responsible for resource management, disaster recovery, load balancing, and schema management. In a multi-zone cluster, RootService has multiple replicas but only one is the leader. The leader is responsible for cluster management and task coordination. When the RootService leader fails, you need to check its logs. You can execute the following statement to query the IP address of the leader:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> svr_ip </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> RootService </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBA_OB_SERVERS </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> with_rootserver</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;yes&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows. For more information about the <code>DBA_OB_SERVERS</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104271" target="_blank" rel="noopener noreferrer">oceanbase.DBA_OB_SERVERS</a>.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| RootService    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 10.10.10.1     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="query-the-status-idc-region-and-type-of-a-zone">Query the status, IDC, region, and type of a zone<a href="#query-the-status-idc-region-and-type-of-a-zone" class="hash-link" aria-label="Direct link to Query the status, IDC, region, and type of a zone" title="Direct link to Query the status, IDC, region, and type of a zone">​</a></h4>
<p>When you take over a cluster to OceanBase Cloud Platform (OCP), you may be prompted that the IDC or region of hosts does not match that of the cluster. You can execute the following statement to view the IDC and region of each zone and modify this information to ensure consistency with the host configurations.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBA_OB_ZONES</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows. For more information about the <code>DBA_OB_ZONES</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104331" target="_blank" rel="noopener noreferrer">oceanbase.DBA_OB_ZONES</a>.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------------------------+----------------------------+--------+-------------+------------+-----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| ZONE  | CREATE_TIME                | MODIFY_TIME                | STATUS | IDC         | REGION     | TYPE      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------------------------+----------------------------+--------+-------------+------------+-----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | 2024-06-04 11:21:23.398969 | 2024-06-04 11:21:45.087430 | ACTIVE | default_idc | sys_region | ReadWrite |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------------------------+----------------------------+--------+-------------+------------+-----------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="query-hidden-parameters">Query hidden parameters<a href="#query-hidden-parameters" class="hash-link" aria-label="Direct link to Query hidden parameters" title="Direct link to Query hidden parameters">​</a></h4>
<p>In OceanBase Database, the names of some parameters start with two underscores (<code>__</code>). These are hidden system parameters, and we recommend that you do not directly adjust them unless necessary. You cannot use the <code>show parameters</code> command to query hidden parameters. However, you can use the <code>alter system set</code> command to modify hidden parameters as you modify normal parameters. You can execute the following statement to query a hidden parameter.</p>
<p>Here, the <code>__min_full_resource_pool_memory</code> parameter is used an example.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GV$OB_PARAMETERS </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;__min_full_resource_pool_memory&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows. For more information about the <code>GV$OB_PARAMETERS</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104422" target="_blank" rel="noopener noreferrer">GV$OB_PARAMETERS</a>.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+----------+-------+---------+-----------+---------------------------------+-----------+------------+-------------------------------------------------------------------+--------------+-------------------+---------------+-----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| SVR_IP         | SVR_PORT | ZONE  | SCOPE   | TENANT_ID | NAME                            | DATA_TYPE | VALUE      | INFO                                                              | SECTION      | EDIT_LEVEL        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+----------+-------+---------+-----------+---------------------------------+-----------+------------+-------------------------------------------------------------------+--------------+-------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 10.10.10.1     |     2882 | zone1 | CLUSTER |      NULL | __min_full_resource_pool_memory | INT       | 2147483648 | the min memory value which is specified for a full resource pool. | LOAD_BALANCE | DYNAMIC_EFFECTIVE |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+----------+-------+---------+-----------+---------------------------------+-----------+------------+-------------------------------------------------------------------+--------------+-------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="query-all-tables-of-a-specific-type-in-a-tenant">Query all tables of a specific type in a tenant<a href="#query-all-tables-of-a-specific-type-in-a-tenant" class="hash-link" aria-label="Direct link to Query all tables of a specific type in a tenant" title="Direct link to Query all tables of a specific type in a tenant">​</a></h4>
<p>You can execute the following statement to query the <code>DBA_OBJECTS</code> view for the information about objects of different types in a user tenant. For more information about the <code>DBA_OBJECTS</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104302" target="_blank" rel="noopener noreferrer">oceanbase.DBA_OBJECTS</a>.</p>
<ol>
<li>
<p>Query object types.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">distinct</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">OBJECT_TYPE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBA_OBJECTS</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| OBJECT_TYPE   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| TABLE         |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| VIRTUAL TABLE |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| INDEX         |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| VIEW          |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| PACKAGE       |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| PACKAGE BODY  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| DATABASE      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| TABLEGROUP    |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query tables based on the object type.</p>
<p>The following sample statement queries all tables of the <code>TABLE</code> type in the tenant.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> OBJECT_NAME </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBA_OBJECTS </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> OBJECT_TYPE</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;TABLE&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="query-the-modification-records-of-a-parameter">Query the modification records of a parameter<a href="#query-the-modification-records-of-a-parameter" class="hash-link" aria-label="Direct link to Query the modification records of a parameter" title="Direct link to Query the modification records of a parameter">​</a></h4>
<p>You can execute the following statement to query the modification records of a parameter. This allows you to restore a parameter when necessary.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBA_OB_ROOTSERVICE_EVENT_HISTORY </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> event</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;admin_set_config&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> value2 </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;%xxxxx%&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The following output takes the <code>enable_rereplication</code> parameter as an example. For more information about the <code>DBA_OB_ROOTSERVICE_EVENT_HISTORY</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104248" target="_blank" rel="noopener noreferrer">oceanbase.DBA_OB_ROOTSERVICE_EVENT_HISTORY</a>.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------------+--------------+------------------+-------+--------+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+--------+-------+--------+-------+--------+-------+--------+------------+---------------+-------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| TIMESTAMP                  | MODULE       | EVENT            | NAME1 | VALUE1 | NAME2 | VALUE2                                                                                                                                                                  | NAME3    | VALUE3 | NAME4 | VALUE4 | NAME5 | VALUE5 | NAME6 | VALUE6 | EXTRA_INFO | RS_SVR_IP     | RS_SVR_PORT |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------------+--------------+------------------+-------+--------+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+--------+-------+--------+-------+--------+-------+--------+------------+---------------+-------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 2024-07-29 11:05:04.577456 | root_service | admin_set_config | ret   | 0      | arg   | {name:&quot; enable_rereplication&quot;, value:&quot; false&quot;, comment:&quot; &quot;, zone:&quot; &quot;, server:&quot; 0.0.0.0:0&quot;, tenant_name:&quot; &quot;, exec_tenant_id:1, tenant_ids: [], want_to_set_tenant_config:false} | is_inner | 0      |       |        |       |        |       |        |            | 10.10.10.1    |        2882 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------------+--------------+------------------+-------+--------+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+--------+-------+--------+-------+--------+-------+--------+------------+---------------+-------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="query-events-that-occurred-in-the-last-hour-in-a-cluster">Query events that occurred in the last hour in a cluster<a href="#query-events-that-occurred-in-the-last-hour-in-a-cluster" class="hash-link" aria-label="Direct link to Query events that occurred in the last hour in a cluster" title="Direct link to Query events that occurred in the last hour in a cluster">​</a></h4>
<p>You can execute the following statement to query the scheduling events that occurred within a specified period of time in different modules. This helps you learn about the stability of the cluster. For example, when a node fails, the RootService module responsible for node monitoring and scheduling will add the node to the blocklist, put the node permanently offline, or migrate the units on the node. In this case, you can query the scheduling events that occurred in RootService to learn about the automatic recovery process.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">TIMESTAMP</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">EVENT</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">name1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">value1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">name2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">value2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">rs_svr_ip </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBA_OB_ROOTSERVICE_EVENT_HISTORY </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> module </span><span class="token operator" style="color:#393A34">IN</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;server&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;root_service&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;balancer&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">TIMESTAMP</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> SUBDATE</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">  </span><span class="token keyword" style="color:#00009f">HOUR</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">TIMESTAMP</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">DESC</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">LIMIT</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------------+--------------+-------------------+-----------+--------+-------+-------------------------------------------------------------------------------+----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| TIMESTAMP                  | module       | EVENT             | name1     | value1 | name2 | value2                                                                        | rs_svr_ip      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------------+--------------+-------------------+-----------+--------+-------+-------------------------------------------------------------------------------+----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 2024-07-18 02:00:02.709958 | root_service | root_minor_freeze | ret       | 0      | arg   | {tenant_ids: [1], server_list: [], zone:&quot; &quot;, tablet_id: {id:0}, ls_id: {id: -1}}    | 10.10.10.1      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 2024-07-18 02:00:02.685112 | root_service | root_major_freeze | tenant_id | 1      | ret   | 0                                                                             | 10.10.10.1      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 2024-07-18 02:00:02.348725 | root_service | root_minor_freeze | ret       | 0      | arg   | {tenant_ids: [1002], server_list: [], zone:&quot; &quot;, tablet_id: {id:0}, ls_id: {id: -1}} | 10.10.10.1      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 2024-07-18 02:00:02.324432 | root_service | root_major_freeze | tenant_id | 1002   | ret   | 0                                                                             | 10.10.10.1     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 2024-07-18 02:00:02.291545 | root_service | root_minor_freeze | ret       | 0      | arg   | {tenant_ids: [1010], server_list: [], zone:&quot; &quot;, tablet_id: {id:0}, ls_id: {id: -1}} | 10.10.10.1      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 2024-07-18 02:00:02.262967 | root_service | root_major_freeze | tenant_id | 1010   | ret   | 0                                                                             | 10.10.10.1     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 2024-07-18 02:00:01.672662 | root_service | root_minor_freeze | ret       | 0      | arg   | {tenant_ids: [1009], server_list: [], zone:&quot; &quot;, tablet_id: {id:0}, ls_id: {id: -1}} | 10.10.10.1      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 2024-07-18 02:00:01.658700 | root_service | root_major_freeze | tenant_id | 1009   | ret   | 0                                                                             | 10.10.10.1     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 2024-07-18 02:00:01.216653 | root_service | root_minor_freeze | ret       | 0      | arg   | {tenant_ids: [1001], server_list: [], zone:&quot; &quot;, tablet_id: {id:0}, ls_id: {id: -1}} | 10.10.10.1      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 2024-07-18 02:00:01.202710 | root_service | root_major_freeze | tenant_id | 1001   | ret   | 0                                                                             | 10.10.10.1     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------------+--------------+-------------------+-----------+--------+-------+-------------------------------------------------------------------------------+----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For more information about the <code>DBA_OB_ROOTSERVICE_EVENT_HISTORY</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104248" target="_blank" rel="noopener noreferrer">oceanbase.DBA_OB_ROOTSERVICE_EVENT_HISTORY</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sql-statements-for-querying-cluster-resources">SQL statements for querying cluster resources<a href="#sql-statements-for-querying-cluster-resources" class="hash-link" aria-label="Direct link to SQL statements for querying cluster resources" title="Direct link to SQL statements for querying cluster resources">​</a></h3>
<ul>
<li>
<p>Query the CPU, memory, and disk parameter configurations in a cluster</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">show</span><span class="token plain"> parameters </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;memory_limit&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;memory_limit_percentage&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;system_memory&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;log_disk_size&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;log_disk_percentage&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;datafile_size&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;datafile_disk_percentage&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+----------------+----------+--------------------------+-----------+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+---------+---------+-------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone  | svr_type | svr_ip         | svr_port | name                     | data_type | value | info                                                                                                                                                                                                                                                                                                                                | section    | scope   | source  | edit_level        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+----------------+----------+--------------------------+-----------+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+---------+---------+-------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | observer | 10.10.10.1     |     2882 | log_disk_percentage      | NULL      | 0     | the percentage of disk space used by the log files. Range: [0,99] in integer;only effective when parameter log_disk_size is 0;when log_disk_percentage is 0: a) if the data and the log are on the same disk, means log_disk_percentage = 30 b) if the data and the log are on the different disks, means log_disk_perecentage = 90 | LOGSERVICE | CLUSTER | DEFAULT | DYNAMIC_EFFECTIVE |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | observer | 10.10.10.1     |     2882 | log_disk_size            | NULL      | 100G  | the size of disk space used by the log files. Range: [0, +∞)                                                                                                                                                                                                                                                                        | LOGSERVICE | CLUSTER | DEFAULT | DYNAMIC_EFFECTIVE |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | observer | 10.10.10.1     |     2882 | memory_limit_percentage  | NULL      | 80    | the size of the memory reserved for internal use(for testing purpose). Range: [10, 95]                                                                                                                                                                                                                                              | OBSERVER   | CLUSTER | DEFAULT | DYNAMIC_EFFECTIVE |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | observer | 10.10.10.1     |     2882 | system_memory            | NULL      | 3G    | the memory reserved for internal use which cannot be allocated to any outer-tenant, and should be determined to guarantee every server functions normally. Range: [0M,)                                                                                                                                                             | OBSERVER   | CLUSTER | DEFAULT | DYNAMIC_EFFECTIVE |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | observer | 10.10.10.1     |     2882 | memory_limit             | NULL      | 30G   | the size of the memory reserved for internal use(for testing purpose), 0 means follow memory_limit_percentage. Range: 0, [1G,).                                                                                                                                                                                                     | OBSERVER   | CLUSTER | DEFAULT | DYNAMIC_EFFECTIVE |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | observer | 10.10.10.1     |     2882 | datafile_disk_percentage | NULL      | 0     | the percentage of disk space used by the data files. Range: [0,99] in integer                                                                                                                                                                                                                                                       | SSTABLE    | CLUSTER | DEFAULT | DYNAMIC_EFFECTIVE |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | observer | 10.10.10.1     |     2882 | datafile_size            | NULL      | 100G  | size of the data file. Range: [0, +∞)                                                                                                                                                                                                                                                                                               | SSTABLE    | CLUSTER | DEFAULT | DYNAMIC_EFFECTIVE |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+----------------+----------+--------------------------+-----------+-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------+---------+---------+-------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query resource allocation at the server level in a cluster</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> zone</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SVR_IP</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;:&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">SVR_PORT</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> observer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cpu_capacity_max cpu_total</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">cpu_assigned_max cpu_assigned</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  cpu_capacity</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">cpu_assigned_max </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> cpu_free</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">memory_limit</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> memory_total</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">memory_limit</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">mem_capacity</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> system_memory</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mem_assigned</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> mem_assigned</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mem_capacity</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">mem_assigned</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> memory_free</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log_disk_capacity</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> log_disk_capacity</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log_disk_assigned</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> log_disk_assigned</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">log_disk_capacity</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">log_disk_assigned</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> log_disk_free</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data_disk_capacity</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> data_disk</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data_disk_in_use</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> data_disk_used</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data_disk_capacity</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">data_disk_in_use</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> data_disk_free</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GV$OB_SERVERS</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows. For more information about the <code>GV$OB_SERVERS</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104534" target="_blank" rel="noopener noreferrer">GV$OB_SERVERS</a>.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-------+---------------------+-----------+--------------+----------+--------------+---------------+--------------+-------------+-------------------+-------------------+---------------+-----------+----------------+----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone  | observer            | cpu_total | cpu_assigned | cpu_free | memory_total | system_memory | mem_assigned | memory_free | log_disk_capacity | log_disk_assigned | log_disk_free | data_disk | data_disk_used | data_disk_free |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+---------------------+-----------+--------------+----------+--------------+---------------+--------------+-------------+-------------------+-------------------+---------------+-----------+----------------+----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | 10.10.10.1:2882     |        16 |            7 |        9 |        30.00 |          3.00 |        10.00 |       17.00 |            100.00 |             27.00 |         73.00 |    100.00 |           1.52 |          98.48 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+---------------------+-----------+--------------+----------+--------------+---------------+--------------+-------------+-------------------+-------------------+---------------+-----------+----------------+----------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query resource allocation and disk usage at the tenant level in a cluster</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">zone</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">svr_ip</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tenant_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tenant_type</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">max_cpu</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">min_cpu</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">memory_size</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> memory_size_gb</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log_disk_size</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> log_disk_size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log_disk_in_use</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> log_disk_in_use</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data_disk_in_use</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> data_disk_in_use</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GV$OB_UNITS a </span><span class="token keyword" style="color:#00009f">join</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dba_ob_tenants b </span><span class="token keyword" style="color:#00009f">on</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tenant_id</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tenant_id </span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tenant_name</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows. For more information about the <code>GV$OB_UNITS</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104420" target="_blank" rel="noopener noreferrer">GV$OB_UNITS</a>.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------------+-------------+-------------+---------+---------+----------------+---------------+-----------------+------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone  | svr_ip         | tenant_name | tenant_type | max_cpu | min_cpu | memory_size_gb | log_disk_size | log_disk_in_use | data_disk_in_use |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------------+-------------+-------------+---------+---------+----------------+---------------+-----------------+------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | 10.10.10.1     | META$1002   | META        |    NULL |    NULL |           1.00 |          1.20 |            0.95 |             0.10 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | 10.10.10.1     | META$1004   | META        |    NULL |    NULL |           1.00 |          1.20 |            0.90 |             0.08 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | 10.10.10.1     | ocp_meta    | USER        |       2 |       2 |           3.00 |         10.80 |            4.31 |             0.92 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | 10.10.10.1     | ocp_monitor | USER        |       2 |       2 |           3.00 |         10.80 |            2.91 |             0.22 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | 10.10.10.1     | sys         | SYS         |       3 |       3 |           2.00 |          3.00 |            1.33 |             0.06 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------------+-------------+-------------+---------+---------+----------------+---------------+-----------------+------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query the size of disk space occupied by all tables in a tenant</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*+ query_timeout(30000000) */</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TENANT_ID</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DATABASE_NAME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TABLE_NAME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TABLE_ID</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">when</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nested_offset </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">then</span><span class="token plain"> IFNULL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data_block_count</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">index_block_count</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">linked_block_count</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1024</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1024</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> IFNULL</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024.0</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> data_size_in_GB </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CDB_OB_TABLE_LOCATIONS a </span><span class="token keyword" style="color:#00009f">inner</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">join</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> __all_virtual_table_mgr b </span><span class="token keyword" style="color:#00009f">on</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">svr_ip </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">svr_ip </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">svr_port</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">svr_port </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tenant_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tenant_id </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LS_ID </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LS_ID </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TABLET_ID </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TABLET_ID </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">role </span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;LEADER&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tenant_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ${tenant ID}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">table_type </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">size </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">group</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> a</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TABLE_ID</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You need to replace <code>${tenant ID}</code> with the ID of the target tenant. You can execute the <code>select * from oceanbase.DBA_OB_TENANTS;</code> statement to query the tenant ID. For more information about the <code>DBA_OB_TENANTS</code> and <code>CDB_OB_TABLE_LOCATIONS</code> views, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104223" target="_blank" rel="noopener noreferrer">oceanbase.DBA_OB_TENANTS</a> and <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104230" target="_blank" rel="noopener noreferrer">oceanbase.CDB_OB_TABLE_LOCATIONS</a>.</p>
</li>
<li>
<p>Query the size of disk space occupied by a single replica of a table</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> DATABASE_NAME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">TABLE_NAME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">TABLE_ID</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">PARTITION_NAME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">TABLET_ID</span><span class="token punctuation" style="color:#393A34">,</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">ROLE</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBA_OB_TABLE_LOCATIONS </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> AA </span><span class="token keyword" style="color:#00009f">full</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">join</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">distinct</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">TABLET_ID</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">size </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain">  oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GV$OB_SSTABLES </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> BB </span><span class="token keyword" style="color:#00009f">on</span><span class="token plain"> AA</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TABLET_ID</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">BB</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TABLET_ID  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain">  AA</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">role</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;leader&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> AA</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">table_name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;${table_name}&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You need to replace <code>${table_name}</code> with the name of the target table. The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+--------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| sum(size)/1024/1024/1024 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|           0.000017967074 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+--------------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For more information about the <code>DBA_OB_TABLE_LOCATIONS</code> and <code>GV$OB_SSTABLES</code> views, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104367" target="_blank" rel="noopener noreferrer">oceanbase.DBA_OB_TABLE_LOCATIONS</a> and <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104517" target="_blank" rel="noopener noreferrer">GV$OB_SSTABLES</a>.</p>
</li>
<li>
<p>Query the size of tenants</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tenant_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data_size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> data_size_gb</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">round</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">required_size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1024</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> required_size_gb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBA_OB_TENANTS t</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CDB_OB_TABLE_LOCATIONS t1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CDB_OB_TABLET_REPLICAS t2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tenant_id</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">t1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tenant_id </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> t1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">svr_ip</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">t2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">svr_ip </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> t1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tenant_id</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">t2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tenant_id </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> t1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ls_id</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">t2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ls_id </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> t1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tablet_id</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">t2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tablet_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">group</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tenant_name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">desc</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------------+--------------+------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| tenant_name           | data_size_gb | required_size_gb |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------------+--------------+------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| sys                   |         0.04 |             0.04 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| ob_archivedata_tenant |         0.02 |             0.02 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| META$1002             |         0.01 |             0.01 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| META$1010             |         0.01 |             0.01 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------------+--------------+------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For more information about the <code>DBA_OB_TENANTS</code>, <code>CDB_OB_TABLE_LOCATIONS</code>, and <code>CDB_OB_TABLET_REPLICAS</code> views, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104223" target="_blank" rel="noopener noreferrer">oceanbase.DBA_OB_TENANTS</a>, <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104230" target="_blank" rel="noopener noreferrer">oceanbase.CDB_OB_TABLE_LOCATIONS</a>, and <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104257" target="_blank" rel="noopener noreferrer">oceanbase.CDB_OB_TABLET_REPLICAS</a>.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sql-statements-related-to-table-partitions">SQL statements related to table partitions<a href="#sql-statements-related-to-table-partitions" class="hash-link" aria-label="Direct link to SQL statements related to table partitions" title="Direct link to SQL statements related to table partitions">​</a></h3>
<p>All SQL statements mentioned in this section query information from the <code>DBA_OB_TABLE_LOCATIONS</code> view. For more information about the <code>DBA_OB_TABLE_LOCATIONS</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104367" target="_blank" rel="noopener noreferrer">oceanbase.DBA_OB_TABLE_LOCATIONS</a>.</p>
<ul>
<li>
<p>Query the distribution of leaders of the <code>t1</code> table in the <code>test</code> database</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBA_OB_TABLE_LOCATIONS </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> DATABASE_NAME</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;test&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> TABLE_NAME</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;t1&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> ROLE</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;LEADER&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> TABLE_TYPE</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;USER TABLE&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+------------+----------+------------+----------------+-------------------+------------+---------------+-----------+-------+-------+---------------+----------+--------+--------------+-----------------+-----------+-----------------+---------------+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| DATABASE_NAME | TABLE_NAME | TABLE_ID | TABLE_TYPE | PARTITION_NAME | SUBPARTITION_NAME | INDEX_NAME | DATA_TABLE_ID | TABLET_ID | LS_ID | ZONE  | SVR_IP        | SVR_PORT | ROLE   | REPLICA_TYPE | DUPLICATE_SCOPE | OBJECT_ID | TABLEGROUP_NAME | TABLEGROUP_ID | SHARDING |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+------------+----------+------------+----------------+-------------------+------------+---------------+-----------+-------+-------+---------------+----------+--------+--------------+-----------------+-----------+-----------------+---------------+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| test          | t1         |   525671 | USER TABLE | NULL           | NULL              | NULL       |          NULL |    225152 |  1002 | zone1 | 10.10.10.1   |     2882 | LEADER | FULL         | NONE            |    525671 | NULL            |          NULL | NULL     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+------------+----------+------------+----------------+-------------------+------------+---------------+-----------+-------+-------+---------------+----------+--------+--------------+-----------------+-----------+-----------------+---------------+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query the number of partitions (including index partitions) in the <code>test</code> database</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBA_OB_TABLE_LOCATIONS </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> DATABASE_NAME</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;test&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> ROLE</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;LEADER&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| count(*) |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      242 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query the number of partitions of the <code>test</code> database on a specific OBServer node</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBA_OB_TABLE_LOCATIONS </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> SVR_IP</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;&lt;server_ip&gt;&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> database_name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;test&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> ROLE</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;LEADER&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You need to replace <code>&lt;server_ip&gt;</code> with the IP address of the target OBServer node. The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| count(*) |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      117 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sql-statements-related-to-table-distribution">SQL statements related to table distribution<a href="#sql-statements-related-to-table-distribution" class="hash-link" aria-label="Direct link to SQL statements related to table distribution" title="Direct link to SQL statements related to table distribution">​</a></h3>
<p>All SQL statements mentioned in this section query information from the <code>CDB_OB_TABLE_LOCATIONS</code> view. For more information about the <code>CDB_OB_TABLE_LOCATIONS</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104230" target="_blank" rel="noopener noreferrer">oceanbase.CDB_OB_TABLE_LOCATIONS</a>.</p>
<ul>
<li>
<p>Query the distribution of partitions</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> svr_ip</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CDB_OB_TABLE_LOCATIONS </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> tenant_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1002</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">group</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> svr_ip </span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> svr_ip</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| svr_ip         | count(1) |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 10.10.10.1     |      1156|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+----------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query the distribution of partition leaders</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> svr_ip</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CDB_OB_TABLE_LOCATIONS </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> tenant_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1002</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> role </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;leader&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">group</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> svr_ip </span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> svr_ip</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| svr_ip         | count(1) |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  10.10.10.1    |     1156 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+----------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query the distribution of leaders in all business databases</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> svr_ip</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CDB_OB_TABLE_LOCATIONS </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> tenant_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1002</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> role </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;LEADER&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> DATABASE_NAME </span><span class="token operator" style="color:#393A34">not</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;oceanbase&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;mysql&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">group</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> svr_ip </span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> svr_ip</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| svr_ip         | count(1) |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  10.10.10.1    |      566 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+----------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sql-statements-related-to-minor-and-major-compactions">SQL statements related to minor and major compactions<a href="#sql-statements-related-to-minor-and-major-compactions" class="hash-link" aria-label="Direct link to SQL statements related to minor and major compactions" title="Direct link to SQL statements related to minor and major compactions">​</a></h3>
<ul>
<li>
<p>Initiate a minor compaction for all tenants</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">ALTER</span><span class="token plain"> SYSTEM MINOR FREEZE tenant</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> all_user</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Initiate a minor compaction for a single tenant, such as <code>test</code></p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">ALTER</span><span class="token plain"> SYSTEM MINOR FREEZE tenant</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;test&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query the number of minor compactions and the memory threshold</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gv$ob_memstore</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows. For more information about the <code>GV$OB_MEMSTORE</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104468" target="_blank" rel="noopener noreferrer">GV$OB_MEMSTORE</a>.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+----------+-----------+-------------+----------------+------------+---------------+----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| SVR_IP         | SVR_PORT | TENANT_ID | ACTIVE_SPAN | FREEZE_TRIGGER | FREEZE_CNT | MEMSTORE_USED | MEMSTORE_LIMIT |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+----------+-----------+-------------+----------------+------------+---------------+----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 10.10.10.1     |     2882 |         1 |   138412032 |      290393948 |          0 |     138412032 |     1288490160 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 10.10.10.1     |     2882 |      1001 |    75497472 |       90013604 |         92 |      73400320 |      429496720 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 10.10.10.1     |     2882 |      1009 |    48234496 |       90642744 |         99 |      44040192 |      429496720 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 10.10.10.1     |     2882 |      1010 |    37748736 |      452510424 |          0 |      37748736 |     2147483640 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+----------+-----------+-------------+----------------+------------+---------------+----------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query the minor compaction configurations</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SHOW</span><span class="token plain"> PARAMETERS </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> name </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;memstore_limit_percentage&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;freeze_trigger_percentage&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;writing_throttling_trigger_percentage&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;memory_limit&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+----------------+----------+---------------------------------------+-----------+-------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+---------+-------------------+---------------+-----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone  | svr_type | svr_ip         | svr_port | name                                  | data_type | value | info                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | section  | scope   | source  | edit_level        | default_value | isdefault |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+----------------+----------+---------------------------------------+-----------+-------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+---------+-------------------+---------------+-----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | observer | 10.10.10.1     |     2882 | memstore_limit_percentage             | INT       | 0     | used in calculating the value of MEMSTORE_LIMIT parameter: memstore_limit_percentage = memstore_limit / memory_size, where MEMORY_SIZE is determined when the tenant is created. Range: [0, 100). 1. the system will use memstore_limit_percentage if only memstore_limit_percentage is set.2. the system will use _memstore_limit_percentage if both memstore_limit_percentage and _memstore_limit_percentage is set.3. the system will adjust automatically if both memstore_limit_percentage and _memstore_limit_percentage set to 0(by default). | TENANT   | CLUSTER | DEFAULT | DYNAMIC_EFFECTIVE | 0             |         1 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | observer | 10.10.10.1     |     2882 | memory_limit                          | CAPACITY  | 30G   | the size of the memory reserved for internal use(for testing purpose), 0 means follow memory_limit_percentage. Range: 0, [1G,).                                                                                                                                                                                                                                                                                                                                                                                                                      | OBSERVER | CLUSTER | DEFAULT | DYNAMIC_EFFECTIVE | 0M            |         0 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | observer | 10.10.10.1     |     2882 | writing_throttling_trigger_percentage | INT       | 60    | the threshold of the size of the mem store when writing_limit will be triggered. Rang: (0,100]. setting 100 means turn off writing limit                                                                                                                                                                                                                                                                                                                                                                                                              | TRANS    | TENANT  | DEFAULT | DYNAMIC_EFFECTIVE | 60            |         1 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | observer | 10.10.10.1     |     2882 | freeze_trigger_percentage             | INT       | 20    | the threshold of the size of the mem store when freeze will be triggered. Rang: (0,100)                                                                                                                                                                                                                                                                                                                                                                                                                                                               | TENANT   | TENANT  | DEFAULT | DYNAMIC_EFFECTIVE | 20            |         1 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+----------------+----------+---------------------------------------+-----------+-------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------+---------+---------+-------------------+---------------+-----------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query whether global major compaction is enabled</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SHOW</span><span class="token plain"> PARAMETERS </span><span class="token operator" style="color:#393A34">LIKE</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;enable_major_freeze&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+----------------+----------+---------------------+-----------+-------+--------------------------------------------------------------------------------------------------+--------------+---------+---------+-------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone  | svr_type | svr_ip         | svr_port | name                | data_type | value | info                                                                                             | section      | scope   | source  | edit_level        |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+----------------+----------+---------------------+-----------+-------+--------------------------------------------------------------------------------------------------+--------------+---------+---------+-------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | observer | 10.10.10.1     |     2882 | enable_major_freeze | BOOL      | True  | specifies whether major_freeze function is turned on. Value:  True:turned on;  False: turned off | ROOT_SERVICE | CLUSTER | DEFAULT | DYNAMIC_EFFECTIVE |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+----------------+----------+---------------------+-----------+-------+--------------------------------------------------------------------------------------------------+--------------+---------+---------+-------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Initiate a major compaction for all tenants</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">ALTER</span><span class="token plain"> SYSTEM MAJOR FREEZE TENANT</span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> all_user</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Initiate a major compaction for a single tenant, such as <code>test</code></p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">ALTER</span><span class="token plain"> SYSTEM MAJOR FREEZE TENANT</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;test&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query the major compaction process of each zone of tenants</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CDB_OB_ZONE_MAJOR_COMPACTION</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows. For more information about the <code>CDB_OB_ZONE_MAJOR_COMPACTION</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104320" target="_blank" rel="noopener noreferrer">oceanbase.CDB_OB_ZONE_MAJOR_COMPACTION</a>.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-----------+-------+---------------------+---------------------+----------------------------+----------------------------+--------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| TENANT_ID | ZONE  | BROADCAST_SCN       | LAST_SCN            | LAST_FINISH_TIME           | START_TIME                 | STATUS |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------+-------+---------------------+---------------------+----------------------------+----------------------------+--------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         1 | zone1 | 1721152800548834000 | 1721152800548834000 | 2024-07-17 02:02:45.384450 | 2024-07-17 02:00:00.592597 | IDLE   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      1001 | zone1 | 1721152803954045000 | 1721152803954045000 | 2024-07-17 02:04:38.201694 | 2024-07-17 02:00:04.011316 | IDLE   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      1009 | zone1 | 1721152804388328000 | 1721152804388328000 | 2024-07-17 02:05:28.617318 | 2024-07-17 02:00:04.438908 | IDLE   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      1010 | zone1 | 1721152800394534000 | 1721152800394534000 | 2024-07-17 02:02:33.460294 | 2024-07-17 02:00:00.448116 | IDLE   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------+-------+---------------------+---------------------+----------------------------+----------------------------+--------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query the major compaction information of all tenants</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CDB_OB_MAJOR_COMPACTION</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows. For more information about the <code>CDB_OB_MAJOR_COMPACTION</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104410" target="_blank" rel="noopener noreferrer">oceanbase.CDB_OB_MAJOR_COMPACTION</a>.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------+---------------------+----------------------------+----------------------+---------------------+----------------------------+----------------------------+--------+----------+--------------+------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| TENANT_ID | FROZEN_SCN          | FROZEN_TIME                | GLOBAL_BROADCAST_SCN | LAST_SCN            | LAST_FINISH_TIME           | START_TIME                 | STATUS | IS_ERROR | IS_SUSPENDED | INFO |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------+---------------------+----------------------------+----------------------+---------------------+----------------------------+----------------------------+--------+----------+--------------+------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         1 | 1721152800548834000 | 2024-07-17 02:00:00.548834 |  1721152800548834000 | 1721152800548834000 | 2024-07-17 02:02:45.381779 | 2024-07-17 02:00:00.575358 | IDLE   | NO       | NO           |      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      1001 | 1721152803954045000 | 2024-07-17 02:00:03.954045 |  1721152803954045000 | 1721152803954045000 | 2024-07-17 02:04:38.198968 | 2024-07-17 02:00:03.996545 | IDLE   | NO       | NO           |      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      1009 | 1721152804388328000 | 2024-07-17 02:00:04.388328 |  1721152804388328000 | 1721152804388328000 | 2024-07-17 02:05:28.614793 | 2024-07-17 02:00:04.423302 | IDLE   | NO       | NO           |      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      1010 | 1721152800394534000 | 2024-07-17 02:00:00.394534 |  1721152800394534000 | 1721152800394534000 | 2024-07-17 02:02:33.456848 | 2024-07-17 02:00:00.429451 | IDLE   | NO       | NO           |      |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------+---------------------+----------------------------+----------------------+---------------------+----------------------------+----------------------------+--------+----------+--------------+------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query the number of tables pending major compaction</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GV$OB_COMPACTION_PROGRESS </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> UNFINISHED_TABLET_COUNT </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For more information about the <code>GV$OB_COMPACTION_PROGRESS</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104421" target="_blank" rel="noopener noreferrer">GV$OB_COMPACTION_PROGRESS</a>.</p>
</li>
<li>
<p>Query the delay of a major compaction for a tenant</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> __all_rootservice_event_history </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> name1</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;tenant_id&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> value1</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;${tenant ID}&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> module </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;daily_merge&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> gmt_create </span><span class="token keyword" style="color:#00009f">desc</span><span class="token plain">  </span><span class="token keyword" style="color:#00009f">limit</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You need to replace <code>${tenant ID}</code> with the ID of the target tenant. You can execute the <code>select * from oceanbase.DBA_OB_TENANTS;</code> statement to query the tenant ID. For more information about the <code>DBA_OB_TENANTS</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104223" target="_blank" rel="noopener noreferrer">oceanbase.DBA_OB_TENANTS</a>. The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------------+-------------+---------------+-----------+--------+----------------------+---------------------+-------+--------+-------+--------+-------+--------+-------+--------+------------+----------------+-------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| gmt_create                 | module      | event         | name1     | value1 | name2                | value2              | name3 | value3 | name4 | value4 | name5 | value5 | name6 | value6 | extra_info | rs_svr_ip      | rs_svr_port |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------------+-------------+---------------+-----------+--------+----------------------+---------------------+-------+--------+-------+--------+-------+--------+-------+--------+------------+----------------+-------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 2024-07-18 02:04:45.332640 | daily_merge | global_merged | tenant_id | 1001   | global_broadcast_scn | 1721239201197860000 |       |        |       |        |       |        |       |        |            | 10.10.10.1     |        2882 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------------------+-------------+---------------+-----------+--------+----------------------+---------------------+-------+--------+-------+--------+-------+--------+-------+--------+------------+----------------+-------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query ongoing minor or major compaction tasks</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GV$OB_TABLET_COMPACTION_PROGRESS </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TYPE</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;MINI_MERGE&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can set <code>TYPE</code> to <code>MINI_MERGE</code> to view minor compaction tasks, and to <code>MAJOR_MERGE</code> to view major compaction tasks. A minor compaction converts the frozen MemTables into a mini SSTable. For more information about the <code>GV$OB_TABLET_COMPACTION_PROGRESS</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104527" target="_blank" rel="noopener noreferrer">GV$OB_TABLET_COMPACTION_PROGRESS</a>.</p>
</li>
<li>
<p>Query the minor or major compaction history</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GV$OB_TABLET_COMPACTION_HISTORY </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TYPE</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;MINI_MERGE&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> START_TIME </span><span class="token keyword" style="color:#00009f">desc</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">limit</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can set <code>TYPE</code> to <code>MINI_MERGE</code> to view the minor compaction history, and to <code>MAJOR_MERGE</code> to view the major compaction history. A minor compaction converts the frozen MemTables into a mini SSTable. The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+----------+-----------+-------+-----------+------------+---------------------+----------------------------+----------------------------+-----------------------------------+-------------+-------------------+-------------------------------+------------------------------+--------------------------------------+-----------------+-----------------------+-------------------+---------------------+------------------------------+----------------------------+-----------------+---------------+------------------------------------------------------------------------+---------------+--------------------------------------------------------------------+-------------+-----------+-----------------------------------------------------------------+-------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| SVR_IP        | SVR_PORT | TENANT_ID | LS_ID | TABLET_ID | TYPE       | COMPACTION_SCN      | START_TIME                 | FINISH_TIME                | TASK_ID                           | OCCUPY_SIZE | MACRO_BLOCK_COUNT | MULTIPLEXED_MACRO_BLOCK_COUNT | NEW_MICRO_COUNT_IN_NEW_MACRO | MULTIPLEXED_MICRO_COUNT_IN_NEW_MACRO | TOTAL_ROW_COUNT | INCREMENTAL_ROW_COUNT | COMPRESSION_RATIO | NEW_FLUSH_DATA_RATE | PROGRESSIVE_COMPACTION_ROUND | PROGRESSIVE_COMPACTION_NUM | PARALLEL_DEGREE | PARALLEL_INFO | PARTICIPANT_TABLE                                                      | MACRO_ID_LIST | COMMENTS                                                           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+----------+-----------+-------+-----------+------------+---------------------+----------------------------+----------------------------+-----------------------------------+-------------+-------------------+-------------------------------+------------------------------+--------------------------------------+-----------------+-----------------------+-------------------+---------------------+------------------------------+----------------------------+-----------------+---------------+------------------------------------------------------------------------+---------------+--------------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 10.10.10.1     |     2882 |      1002 |     1 |       373 | MINI_MERGE | 1721152976299008000 | 2024-07-17 02:03:08.509109 | 2024-07-17 02:03:08.524133 | YB420BA1CC62-00061A0898BDDE08-0-0 |       14045 |                 1 |                             0 |                            1 |                                    0 |             101 |                   101 |                 1 |                4896 |                            0 |                          0 |               1 | -             | table_cnt=1,start_scn=1721112282660948001,end_scn=1721152976299008000; | 18831         | comment=&quot;cost_mb=2;time=add_time:1721152988508926|total=15.02ms;&quot;; |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 10.10.10.1     |     2882 |      1002 |     1 |       121 | MINI_MERGE | 1721152980999256000 | 2024-07-17 02:03:03.506837 | 2024-07-17 02:03:03.576037 | YB420BA1CC62-00061A0898BDDC45-0-0 |           0 |                 0 |                             0 |                            0 |                                    0 |               0 |                     0 |                 1 |                   0 |                            0 |                          0 |               1 | -             | table_cnt=1,start_scn=1721152803751899001,end_scn=1721152980999256000; |               | comment=&quot;time=add_time:1721152983506636|total=69.20ms;&quot;;           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 10.10.10.1     |     2882 |      1002 |     1 |         1 | MINI_MERGE | 1721152973925564001 | 2024-07-17 02:02:58.504770 | 2024-07-17 02:02:58.569947 | YB420BA1CC62-00061A0898BDDA52-0-0 |        2204 |                 1 |                             0 |                            1 |                                    0 |              18 |                    18 |                 1 |                 818 |                            0 |                          0 |               1 | -             | table_cnt=1,start_scn=1721152803751899001,end_scn=1721152973925564001; | 18736         | comment=&quot;cost_mb=2;time=add_time:1721152978504549|total=65.18ms;&quot;; |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+----------+-----------+-------+-----------+------------+---------------------+----------------------------+----------------------------+-----------------------------------+-------------+-------------------+-------------------------------+------------------------------+--------------------------------------+-----------------+-----------------------+-------------------+---------------------+------------------------------+----------------------------+-----------------+---------------+------------------------------------------------------------------------+---------------+--------------------------------------------------------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For more information about the <code>GV$OB_TABLET_COMPACTION_HISTORY</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104513" target="_blank" rel="noopener noreferrer">GV$OB_TABLET_COMPACTION_HISTORY</a>.</p>
</li>
<li>
<p>Query the major compaction records of a table</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GV$OB_TABLET_COMPACTION_HISTORY </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> TABLET_ID </span><span class="token operator" style="color:#393A34">IN</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> TABLET_ID </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CDB_OB_TABLE_LOCATIONS </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> TABLE_NAME </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;${table_name}&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">ORDER</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> START_TIME </span><span class="token keyword" style="color:#00009f">DESC</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">limit</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You need to replace <code>${table_name}</code> with the name of the target table. For more information about the <code>GV$OB_TABLET_COMPACTION_HISTORY</code> and <code>CDB_OB_TABLE_LOCATIONS</code> views, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104513" target="_blank" rel="noopener noreferrer">GV$OB_TABLET_COMPACTION_HISTORY</a> and <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104230" target="_blank" rel="noopener noreferrer">oceanbase.CDB_OB_TABLE_LOCATIONS</a>. The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+----------+-----------+-------+-----------+----------------+---------------------+----------------------------+----------------------------+-----------------------------------+-------------+-------------------+-------------------------------+------------------------------+--------------------------------------+-----------------+-----------------------+-------------------+---------------------+------------------------------+----------------------------+-----------------+---------------+-------------------+---------------+---------------------------------------------------------+-------------+-----------+---------------+-------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| SVR_IP        | SVR_PORT | TENANT_ID | LS_ID | TABLET_ID | TYPE           | COMPACTION_SCN      | START_TIME                 | FINISH_TIME                | TASK_ID                           | OCCUPY_SIZE | MACRO_BLOCK_COUNT | MULTIPLEXED_MACRO_BLOCK_COUNT | NEW_MICRO_COUNT_IN_NEW_MACRO | MULTIPLEXED_MICRO_COUNT_IN_NEW_MACRO | TOTAL_ROW_COUNT | INCREMENTAL_ROW_COUNT | COMPRESSION_RATIO | NEW_FLUSH_DATA_RATE | PROGRESSIVE_COMPACTION_ROUND | PROGRESSIVE_COMPACTION_NUM | PARALLEL_DEGREE | PARALLEL_INFO | PARTICIPANT_TABLE | MACRO_ID_LIST | COMMENTS                                                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+----------+-----------+-------+-----------+----------------+---------------------+----------------------------+----------------------------+-----------------------------------+-------------+-------------------+-------------------------------+------------------------------+--------------------------------------+-----------------+-----------------------+-------------------+---------------------+------------------------------+----------------------------+-----------------+---------------+-------------------+---------------+---------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| 10.10.10.1     |     2882 |         1 |     1 |    200030 | MDS_MINI_MERGE | 1721273439647032000 | 2024-07-18 11:30:40.065549 | 2024-07-18 11:30:40.072639 | YB420BA1CC62-00061A08028BAA9E-0-0 |           0 |                 0 |                             0 |                            0 |                                    0 |               0 |                     0 |                 1 |                   0 |                            0 |                          0 |               0 | -             |                   |               | comment=&quot;time=add_time:1721273439825215|total=7.09ms;&quot;; |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+---------------+----------+-----------+-------+-----------+----------------+---------------------+----------------------------+----------------------------+-----------------------------------+-------------+-------------------+-------------------------------+------------------------------+--------------------------------------+-----------------+-----------------------+-------------------+---------------------+------------------------------+----------------------------+-----------------+---------------+-------------------+---------------+---------------------------------------------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sql-statements-related-to-execution-plans-and-plan-caches">SQL statements related to execution plans and plan caches<a href="#sql-statements-related-to-execution-plans-and-plan-caches" class="hash-link" aria-label="Direct link to SQL statements related to execution plans and plan caches" title="Direct link to SQL statements related to execution plans and plan caches">​</a></h3>
<ul>
<li>
<p>Query information about the execution plan of an SQL statement</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GV$OB_PLAN_CACHE_PLAN_stat </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> query_sql </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;%keyword%&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You need to replace <code>%keyword%</code> with a keyword in the SQL statement.</p>
</li>
<li>
<p>Clear all plan caches of a tenant</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">ALTER</span><span class="token plain"> SYSTEM FLUSH </span><span class="token keyword" style="color:#00009f">PLAN</span><span class="token plain"> CACHE TENANT </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;${tenant_name}&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">global</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You need to replace <code>${tenant_name}</code> with the name of the target tenant.</p>
</li>
<li>
<p>Clear all plan caches of a database in a tenant</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">ALTER</span><span class="token plain"> SYSTEM FLUSH </span><span class="token keyword" style="color:#00009f">PLAN</span><span class="token plain"> CACHE </span><span class="token keyword" style="color:#00009f">databases</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;${database}&#x27;</span><span class="token plain"> tenant</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;${tenant_name}&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">GLOBAL</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You need to replace <code>${database}</code> with the name of the target database, and <code>${tenant_name}</code> with the name of the tenant where <code>${database}</code> belongs.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sql-statements-related-to-statistics-collection">SQL statements related to statistics collection<a href="#sql-statements-related-to-statistics-collection" class="hash-link" aria-label="Direct link to SQL statements related to statistics collection" title="Direct link to SQL statements related to statistics collection">​</a></h3>
<ul>
<li>
<p>Manually collect statistics</p>
<ul>
<li>
<p>Collect statistics on the <code>test1</code> table in the <code>test</code> database by calling a procedure</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">call</span><span class="token plain"> dbms_stats</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gather_table_stats</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;test&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;test1&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Collect statistics on all tables in the <code>test</code> database by calling a procedure and set the degree of parallelism (DOP) to <code>128</code></p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">call</span><span class="token plain"> dbms_stats</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gather_schema_stats</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;test&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> degree</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">128</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Collect statistics on the <code>test1</code> table in the <code>test</code> database by executing the ANALYZE statement</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">ALTER</span><span class="token plain"> SYSTEM </span><span class="token keyword" style="color:#00009f">SET</span><span class="token plain"> enable_sql_extension </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">ANALYZE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">TABLE</span><span class="token plain"> test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">test1 </span><span class="token keyword" style="color:#00009f">COMPUTE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">STATISTICS</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
</li>
<li>
<p>Query the statistics collected on the <code>test1</code> table</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DBA_TAB_STATISTICS </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> TABLE_NAME</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;test1&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For more information about the <code>DBA_TAB_STATISTICS</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104296" target="_blank" rel="noopener noreferrer">oceanbase.DBA_TAB_STATISTICS</a>.</p>
</li>
<li>
<p>Query the sorted time consumption of tasks for collecting tenant table statistics</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> table_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">tenant_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">task_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">ret_code</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">start_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">end_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">TIMEDIFF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">end_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> start_time</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> times </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> __all_virtual_table_opt_stat_gather_history </span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> times </span><span class="token keyword" style="color:#00009f">desc</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">limit</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------+-----------+--------------------------------------+----------+----------------------------+----------------------------+-----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| table_id | tenant_id | task_id                              | ret_code | start_time                 | end_time                   | times           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+-----------+--------------------------------------+----------+----------------------------+----------------------------+-----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|   525657 |      1002 | 36507c6d-32fb-11ef-a31f-00163e048137 |        0 | 2024-06-25 22:00:00.173423 | 2024-06-25 22:01:51.433552 | 00:01:51.260129 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      458 |         1 | 5f2ad8bf-387b-11ef-8765-00163e035a65 |        0 | 2024-07-02 22:00:00.136656 | 2024-07-02 22:00:01.743898 | 00:00:01.607242 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      458 |         1 | 3646d5bc-32fb-11ef-a31f-00163e06beb9 |        0 | 2024-06-25 22:00:00.085670 | 2024-06-25 22:00:01.663990 | 00:00:01.578320 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      458 |      1001 | 60c1e763-33c4-11ef-a31f-00163e06beb9 |        0 | 2024-06-26 22:00:00.252122 | 2024-06-26 22:00:01.822895 | 00:00:01.570773 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|      458 |         1 | 3fddfbd3-4163-11ef-885e-00163e048137 |        0 | 2024-07-14 06:00:00.235859 | 2024-07-14 06:00:01.800427 | 00:00:01.564568 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+-----------+--------------------------------------+----------+----------------------------+----------------------------+-----------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="other-sql-statements">Other SQL statements<a href="#other-sql-statements" class="hash-link" aria-label="Direct link to Other SQL statements" title="Direct link to Other SQL statements">​</a></h3>
<ul>
<li>
<p>Query RootService switching information</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> __all_rootservice_event_history </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> module</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;root_service&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> event </span><span class="token operator" style="color:#393A34">in</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;start_rootservice&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;stop_rootservice&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> gmt_create </span><span class="token keyword" style="color:#00009f">desc</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query table information by table ID</p>
<p>A table ID uniquely identifies a table within a tenant. However, table IDs can be duplicate among tenants in a cluster. A table ID can also identify an index or a view. You can query the <code>CDB_OB_TABLE_LOCATIONS</code> view for information, such as the table name, database name, tenant name, leader, and table type, of a table object. Here is an example:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CDB_OB_TABLE_LOCATIONS </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> table_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500008</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows. For more information about the <code>CDB_OB_TABLE_LOCATIONS</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104230" target="_blank" rel="noopener noreferrer">oceanbase.CDB_OB_TABLE_LOCATIONS</a>.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------+---------------+------------------+----------+------------+----------------+-------------------+------------+---------------+-----------+-------+-------+----------------+----------+----------+--------------+-----------------+-----------+-----------------+---------------+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| TENANT_ID | DATABASE_NAME | TABLE_NAME       | TABLE_ID | TABLE_TYPE | PARTITION_NAME | SUBPARTITION_NAME | INDEX_NAME | DATA_TABLE_ID | TABLET_ID | LS_ID | ZONE  | SVR_IP         | SVR_PORT | ROLE     | REPLICA_TYPE | DUPLICATE_SCOPE | OBJECT_ID | TABLEGROUP_NAME | TABLEGROUP_ID | SHARDING |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------+---------------+------------------+----------+------------+----------------+-------------------+------------+---------------+-----------+-------+-------+----------------+----------+----------+--------------+-----------------+-----------+-----------------+---------------+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|         1 | test          | cluster_slowlogs |   500008 | USER TABLE | NULL           | NULL              | NULL       |          NULL |    200002 |     1 | zone1 | 10.10.10.1     |     2882 | FOLLOWER | FULL         | NONE            |    500008 | NULL            |          NULL | NULL     |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------+---------------+------------------+----------+------------+----------------+-------------------+------------+---------------+-----------+-------+-------+----------------+----------+----------+--------------+-----------------+-----------+-----------------+---------------+----------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Verify whether an index takes effect</p>
<ul>
<li>
<p>Verify whether an index takes effect (that is, has a status value of <code>VALID</code>) based on the index name in the sys tenant</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CDB_INDEXES </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">status</span><span class="token operator" style="color:#393A34">&lt;&gt;</span><span class="token string" style="color:#e3116c">&#x27;VALID&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> INDEX_NAME</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;%&lt;index name&gt;%&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You need to replace <code>&lt;index name&gt;</code> with the actual index name. If the output is empty, all indexes are normal. For more information about the <code>CDB_INDEXES</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104365" target="_blank" rel="noopener noreferrer">oceanbase.CDB_INDEXES</a>.</p>
</li>
<li>
<p>Verify whether an index takes effect based on the table ID</p>
<p>To query information such as the table ID by index name, you need to replace <code>&lt;index name&gt;</code> with the actual index name.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> table_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> table_name </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> __all_virtual_table_history </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> table_name </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;%&lt;index name&gt;%&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Query index creation failures by table ID. If the output is empty, all indexes are normal.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain">  oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> __all_virtual_ddl_error_message </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> object_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;${table_id}&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
</li>
<li>
<p>Query the slow transactions of a tenant</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">/*+READ_CONSISTENCY(weak),parallel(8),QUERY_TIMEOUT(180000000)*/</span><span class="token plain"> usec_to_time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request_time</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GV$OB_SQL_AUDIT </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> tenant_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ${tenant ID} </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> RET_CODE </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;-5066&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> QUERY_SQL </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;REPLACE%&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> usec_to_time</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">request_time</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">between</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;2024-05-01 15:25:00&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> ELAPSED_TIME </span><span class="token keyword" style="color:#00009f">desc</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You need to replace <code>${tenant ID}</code> with the ID of the target tenant. You can execute the <code>select * from oceanbase.DBA_OB_TENANTS;</code> statement to query the tenant ID. You need to replace <code>2024-05-01 15:25:00</code> in the example based on the actual situation. For more information about the <code>GV$OB_SQL_AUDIT</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001106687" target="_blank" rel="noopener noreferrer">GV$OB_SQL_AUDIT</a>.</p>
</li>
<li>
<p>Query long-running transactions and suspended transactions</p>
<p>The following examples query the transactions within the last 600s. You can replace <code>600</code> with a desired value based on the actual situation.</p>
<ul>
<li>
<p>Query long-running transactions</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> __all_virtual_trans_stat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> part_trans_action</span><span class="token operator" style="color:#393A34">&lt;=</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> ctx_create_time </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> date_sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SECOND</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> is_exiting </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query suspended transactions</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> __all_virtual_trans_stat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> part_trans_action </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> ctx_create_time </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> date_sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INTERVAL</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">600</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">SECOND</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> is_exiting </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
</li>
<li>
<p>Query the index creation progress</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SUBSTRING_INDEX</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SUBSTRING_INDEX</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">MESSAGE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ROW_INSERTED: &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> row_inserted</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SUBSTRING_INDEX</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SUBSTRING_INDEX</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">MESSAGE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ROW_SCANNED: &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> row_scanned</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SUBSTRING_INDEX</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SUBSTRING_INDEX</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">MESSAGE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ROW_INSERTED: &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">SUBSTRING_INDEX  </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SUBSTRING_INDEX</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">MESSAGE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ROW_SCANNED: &#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;,&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> ratio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">GV$SESSION_LONGOPS</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For more information about the <code>GV$SESSION_LONGOPS</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001104538" target="_blank" rel="noopener noreferrer">GV$SESSION_LONGOPS</a>.</p>
</li>
<li>
<p>Query the macroblock utilization of a tenant</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> loc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TENANT_ID</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DATABASE_NAME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TABLE_NAME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TABLE_ID</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">SUM</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rep</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DATA_SIZE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> DATA_SIZE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">SUM</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rep</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">REQUIRED_SIZE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> REQUIRED_SIZE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">SUM</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rep</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DATA_SIZE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">NULLIF</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">SUM</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rep</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">REQUIRED_SIZE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"> SIZE_RATIO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CDB_OB_TABLE_LOCATIONS loc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">JOIN</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CDB_OB_TABLET_REPLICAS rep</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> loc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TABLET_ID </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> rep</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TABLET_ID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> loc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TABLE_TYPE </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;USER TABLE&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> loc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TENANT_ID </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ${tenant ID}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">GROUP</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">BY</span><span class="token plain"> loc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DATABASE_NAME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TABLE_NAME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">loc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TABLE_ID</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You need to replace <code>${tenant ID}</code> with the ID of the target tenant. You can execute the <code>select * from oceanbase.DBA_OB_TENANTS;</code> statement to query the tenant ID.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="common-issues-and-troubleshooting">Common issues and troubleshooting<a href="#common-issues-and-troubleshooting" class="hash-link" aria-label="Direct link to Common issues and troubleshooting" title="Direct link to Common issues and troubleshooting">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="obtain-the-database-logs-of-an-sql-statement">Obtain the database logs of an SQL statement<a href="#obtain-the-database-logs-of-an-sql-statement" class="hash-link" aria-label="Direct link to Obtain the database logs of an SQL statement" title="Direct link to Obtain the database logs of an SQL statement">​</a></h3>
<p>This section describes how to quickly locate the logs of an abnormal SQL statement. For most issues related to SQL statements, you cannot identify the causes merely by querying related views and need to check the database system logs. However, OceanBase Database has a large amount of logs, and they are updated quickly. If you are unfamiliar with database operations, you may fail to find information about an abnormal SQL statement because its logs have been overwritten. This section focuses on adjusting system logs, printing trace IDs, and locating system logs.</p>
<p>Symptom: An SQL statement fails or an SQL task is not completed in the business system, and you cannot identify the cause based on views.</p>
<p>Two handling methods are available based on the scenarios. Select an appropriate method as needed.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="scenario-1-the-sql-statement-cannot-be-repeatedly-executed">Scenario 1: The SQL statement cannot be repeatedly executed<a href="#scenario-1-the-sql-statement-cannot-be-repeatedly-executed" class="hash-link" aria-label="Direct link to Scenario 1: The SQL statement cannot be repeatedly executed" title="Direct link to Scenario 1: The SQL statement cannot be repeatedly executed">​</a></h4>
<ol>
<li>
<p>Query the <code>GV$OB_SQL_AUDIT</code> view for <code>TRACE_ID</code> and <code>svr_ip</code> of the abnormal SQL statement.</p>
<blockquote>
<p><strong>Note</strong></p>
<p>The data recorded in this view will not be persisted locally. The data retention period depends on the tenant memory size and the <code>ob_sql_audit_percentage</code> system variable. If you fail to query information about the SQL statement, you can adjust the value of <code>ob_sql_audit_percentage</code>. For more information about the <code>ob_sql_audit_percentage</code> system variable, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001105342" target="_blank" rel="noopener noreferrer">ob_sql_audit_percentage</a>.</p>
</blockquote>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> query_sql</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">svr_ip</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">TRACE_ID</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">client_ip</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">TENANT_NAME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">user_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">DB_NAME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">ELAPSED_TIME</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">RET_CODE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">FROM_UNIXTIME</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">ROUND</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">REQUEST_TIME</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1000</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;%Y-%m-%d %H:%i:%S&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token identifier">GV$OB_SQL_AUDIT</span><span class="token identifier punctuation" style="color:#393A34">`</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> REQUEST_TIME</span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token string" style="color:#e3116c">&#x27;2024-04-05 14:34:00&#x27;</span><span class="token plain">  </span><span class="token keyword" style="color:#00009f">limit</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For more information about the <code>GV$OB_SQL_AUDIT</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001106687" target="_blank" rel="noopener noreferrer">GV$OB_SQL_AUDIT</a>.</p>
</li>
<li>
<p>On the server with the IP address specified by <code>svr_ip</code>, filter logs by <code>TRACE_ID</code>.</p>
<p>Not all exceptions are recorded in the <code>observer.log</code> file. For example, if a backup statement fails, you can find the cause in the <code>rootservice.log</code> file.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@test001 ~]$ grep &quot;YB420BA1CC68-000615A09D4CBDA0-0-0&quot; observer.log*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@test001 ~]$ grep &quot;YB420BA1CC68-000615A09D4CBDA0-0-0&quot; rootservice.log*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>If the information in the <code>GV$OB_SQL_AUDIT</code> view is evicted, the corresponding system logs are overwritten, or the system log level is too low, you can perform the following steps to adjust settings and repeat the preceding steps to obtain the logs when the SQL statement can be executed again to reproduce the issue.</p>
<ol>
<li>
<p>Query the system log level.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">show</span><span class="token plain"> parameters </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;syslog_level&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+----------------+----------+--------------+-----------+-------+------------------------------------------------------------------------------------------------------------------------------+----------+---------+---------+-------------------+---------------+-----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone  | svr_type | svr_ip         | svr_port | name         | data_type | value | info                                                                                                                         | section  | scope   | source  | edit_level        | default_value | isdefault |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+----------------+----------+--------------+-----------+-------+------------------------------------------------------------------------------------------------------------------------------+----------+---------+---------+-------------------+---------------+-----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| zone1 | observer | 10.10.10.1     |     2882 | syslog_level | STRING    | WDIAG | specifies the current level of logging. There are DEBUG, TRACE, WDIAG, EDIAG, INFO, WARN, ERROR, seven different log levels. | OBSERVER | CLUSTER | DEFAULT | DYNAMIC_EFFECTIVE | WDIAG         |         1 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-------+----------+----------------+----------+--------------+-----------+-------+------------------------------------------------------------------------------------------------------------------------------+----------+---------+---------+-------------------+---------------+-----------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>(Optional) Set the log level.</p>
<p>The default value of the <code>syslog_level</code> parameter is <code>WDIAG</code>. If the parameter value is <code>WDIAG</code> in the preceding output, skip this step.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">alter</span><span class="token plain"> system </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> syslog_level</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;WDIAG&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Set the number of system log files to retain based on the available disk space.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">alter</span><span class="token plain"> system </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> max_syslog_file_count</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;10&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="scenario-2-the-sql-statement-can-be-repeatedly-executed">Scenario 2: The SQL statement can be repeatedly executed<a href="#scenario-2-the-sql-statement-can-be-repeatedly-executed" class="hash-link" aria-label="Direct link to Scenario 2: The SQL statement can be repeatedly executed" title="Direct link to Scenario 2: The SQL statement can be repeatedly executed">​</a></h4>
<p>You can first follow the steps in Scenario 1 for troubleshooting, or repeatedly execute the SQL statement to reproduce the issue. If you cannot obtain the required information, perform the following steps to obtain the trace ID of the SQL statement and filter the logs by trace ID. You can query the trace ID both from the sys tenant and a user tenant. Select a tenant to query the trace ID based on the actual scenario.</p>
<ul>
<li>
<p>If an error is immediately returned after the SQL statement is executed, we recommend that you query the trace ID from the sys tenant.</p>
<ol>
<li>
<p>Log on to the sys tenant and set the <code>enable_rich_error_msg</code> parameter to <code>true</code>.</p>
<p>The <code>enable_rich_error_msg</code> parameter specifies whether to add debugging information, such as the server IP address, time, and trace ID, to client messages. For more information, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001105476" target="_blank" rel="noopener noreferrer">enable_rich_error_msg</a>.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">alter</span><span class="token plain"> system </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> enable_rich_error_msg</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Log on to a user tenant and execute the SQL statement. The IP address of the execution node and the trace ID are directly returned.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">obclient </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> t2</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ERROR 1146 (42S02): Table &#x27;test.t2&#x27; doesn&#x27;t exist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[10.10.10.1:2882] [2024-04-13 20:10:20.292087] [YB420BA1CC68-000615A0A8EA5E38-0-0]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Access the execution node, which is 10.10.10.1 in this example, to filter logs.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@test001 ~]$ grep &quot;YB420BA1CC68-000615A0A8EA5E38-0-0&quot;  rootservice.log*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@test001 ~]$ grep &quot;YB420BA1CC68-000615A0A8EA5E38-0-0&quot;  observer.log*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>After you obtain the required logs, set the <code>enable_rich_error_msg</code> parameter to <code>false</code>.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">alter</span><span class="token plain"> system </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> enable_rich_error_msg</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
</li>
<li>
<p>If the SQL statement is successfully executed but the SQL task remains uncompleted after a long period of time, we recommend that you query the trace ID from a user tenant. For example, if the archiving status does not change to <code>doing</code> after you enable archiving, you need to perform the following steps to query the trace ID:</p>
<ol>
<li>
<p>Log on to a user tenant and set the <code>ob_enable_show_trace</code> variable to <code>ON</code>.</p>
<p>The <code>ob_enable_show_trace</code> variable specifies whether to enable the show trace feature. For more information, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001105375" target="_blank" rel="noopener noreferrer">ob_enable_show_trace</a>.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SET</span><span class="token plain"> ob_enable_show_trace</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;ON&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the SQL statement and query its trace ID.</p>
<p>Only the trace ID is returned. Therefore, you need to query the <code>GV$OB_SQL_AUDIT</code> view for the node (<code>SVR_IP</code>) where logs are to be filtered.</p>
<blockquote>
<p><strong>Note</strong></p>
<p>You must execute the following statements in the same session.</p>
</blockquote>
<p>Execute the SQL statement, which is <code>select count(*) from test2;</code> in this example. The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| count(*) |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|        0 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Query the trace ID of the executed SQL statement.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">obclient [test]&gt; select last_trace_id();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| last_trace_id()                   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| YB420BA1CC68-000615A0A8EA6511-0-0 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+-----------------------------------+</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Query the <code>GV$OB_SQL_AUDIT</code> view for the node where the logs reside based on the trace ID displayed in the output.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">obclient [test]&gt; select * from oceanbase.gv$ob_sql_audit where  trace_id=&#x27;YB420BA1CC68-000615A0A8EA6511-0-0&#x27;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Filter logs by trace ID on the node with the IP address specified by <code>SVR_IP</code>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@test001 ~]$ grep &quot;YB420BA1CC68-000615A0A8EA6511-0-0&quot; rootservice.log*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[root@test001 ~]$ grep &quot;YB420BA1CC68-000615A0A8EA6511-0-0&quot; observer.log*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="collect-information-about-slow-sql-statements">Collect information about slow SQL statements<a href="#collect-information-about-slow-sql-statements" class="hash-link" aria-label="Direct link to Collect information about slow SQL statements" title="Direct link to Collect information about slow SQL statements">​</a></h3>
<p>When you use OceanBase Database, you may encounter the issue of slow SQL execution due to hardware bottlenecks or the need for SQL tuning. In such cases, you first need to find the cause of the issue. The tuning methods are not described here but in Chapter 7. This section describes how to collect information about slow SQL statements for self-service troubleshooting or for reference when you seek help in the Q&amp;A section of the OceanBase community.</p>
<p>Select an appropriate solution based on the scenario.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-execution-of-an-sql-statement-times-out-or-takes-a-long-time">The execution of an SQL statement times out or takes a long time<a href="#the-execution-of-an-sql-statement-times-out-or-takes-a-long-time" class="hash-link" aria-label="Direct link to The execution of an SQL statement times out or takes a long time" title="Direct link to The execution of an SQL statement times out or takes a long time">​</a></h4>
<p>We recommend that you use OceanBase Diagnostic Tool (obdiag) to diagnose and analyze the system logs of the current cluster to assist with troubleshooting. For more information about the procedure, see <a href="https://en.oceanbase.com/docs/common-obdiag-en-10000000001574809" target="_blank" rel="noopener noreferrer">Use obdiag for Diagnostic Analysis</a>.</p>
<p>The show trace feature in end-to-end diagnostics can also detect performance bottlenecks and perform further analysis and tuning. For more information about the feature, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001103878" target="_blank" rel="noopener noreferrer">End-to-end tracing</a>.</p>
<p>If the issue cannot be resolved by using the two methods, you can troubleshoot in the following ways:</p>
<ul>
<li>
<p>Query the <code>GV$OB_SQL_AUDIT</code> view for the wait events that affect the execution time.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gv$ob_sql_audit </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> query_sql </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;%&lt;SQL keyword&gt;%&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You need to replace <code>&lt;SQL keyword&gt;</code> with the keyword in the SQL statement whose execution times out or takes a long time. For more information about the <code>GV$OB_SQL_AUDIT</code> view, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001106687" target="_blank" rel="noopener noreferrer">GV$OB_SQL_AUDIT</a>.</p>
</li>
<li>
<p>Run the <code>EXPLAIN EXTENDED</code> command to obtain the execution plan and analyze the plan. For the procedure, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001107586" target="_blank" rel="noopener noreferrer">View and analyze the shape of an execution plan</a>.</p>
</li>
<li>
<p>Perform the following steps to obtain the SQL plan monitoring information for troubleshooting:</p>
<ol>
<li>
<p>Log on to the sys tenant and query the <code>enable_sql_audit</code> parameter.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">show</span><span class="token plain"> parameters </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;enable_sql_audit&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For more information about the <code>enable_sql_audit</code> parameter, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001105603" target="_blank" rel="noopener noreferrer">enable_sql_audit</a>.</p>
</li>
<li>
<p>(Optional) Set the <code>enable_sql_audit</code> parameter.</p>
<p>If the value of the <code>enable_sql_audit</code> parameter is <code>false</code>, execute the following statement to change the value to <code>true</code>:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">alter</span><span class="token plain"> system enable_sql_audit </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Log on to a user tenant and query the execution plan of the SQL statement.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">EXPLAIN</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">EXTENDED</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">SQL</span><span class="token plain"> statement</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Enable the show trace feature.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SET</span><span class="token plain"> ob_enable_show_trace</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">‘</span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain">’</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the SQL statement whose execution times out or takes a long time again.</p>
</li>
<li>
<p>Execute the following SQL statement to query the trace ID of the SQL statement executed in the previous step:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> last_trace_id</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the following statement in the sys tenant to temporarily disable the SQL audit feature to prevent the information from being overwritten:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">alter</span><span class="token plain"> system enable_sql_audit </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Query the SQL plan monitoring information.</p>
<p>Replace <code>&lt;trace_id&gt;</code> in the following statement with the trace ID returned in Step 6 to query the output of each operator.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> plan_line_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> plan_operation</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">output_rows</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">STARTS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> rescan</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">min</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">first_refresh_time</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> open_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">last_refresh_time</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> close_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">min</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">first_change_time</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> first_row_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">max</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">last_change_time</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> last_row_eof_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> oceanbase</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gv$sql_plan_monitor </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> trace_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&lt;trace_id&gt;&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">group</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> plan_line_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> plan_operation </span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> plan_line_id</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Execute the following statement in the sys tenant to restore the value of the <code>enable_sql_audit</code> parameter:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">alter</span><span class="token plain"> system enable_sql_audit </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
</li>
</ul>
<p>If the issue persists, you can submit a question in the <a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer">Q&amp;A</a> section on the official website and provide the preceding information and the observer.log file corresponding to the trace ID for assistance.</p>
<p>The preceding methods apply to SELECT statements. If the execution of a DDL statement is stuck, self-service troubleshooting is unsuitable. You can submit a question in the <a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer">Q&amp;A</a> section of the official website for assistance.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-execution-of-a-ddl-statement-is-stuck">The execution of a DDL statement is stuck<a href="#the-execution-of-a-ddl-statement-is-stuck" class="hash-link" aria-label="Direct link to The execution of a DDL statement is stuck" title="Direct link to The execution of a DDL statement is stuck">​</a></h4>
<ol>
<li>
<p>Execute the following statement to query the information about the DDL statement being executed:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> tenant_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> gmt_create</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ddl_type</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">status</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> task_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> parent_task_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> object_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> target_object_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> execution_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> trace_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> unhex</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ddl_stmt_str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> __all_virtual_ddl_task_status</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Take the following actions based on the returned result:</p>
<ul>
<li>
<p>If the information about the DDL statement being executed can be obtained, go to Step 2.</p>
</li>
<li>
<p>If the information about the DDL statement being executed cannot be obtained, go to Step 3.</p>
</li>
</ul>
</li>
<li>
<p>Query the status switching history of the DDL task based on information such as the tenant ID and task ID returned in the output.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Replace &lt;tenant_id&gt; and &lt;task_id&gt; with the `tenant_id` and `task_id` values returned in Step 1.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@ddl_tenant_id</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">tenant_id</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@ddl_task_id</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">task_id</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> __all_rootservice_event_history </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> module </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ddl_scheduler&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> event </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;switch_state&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> value1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@ddl_tenant_id</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> value2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@ddl_task_id</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If the task ID of an index creation task is unknown, you can query the required information based on OBJECT_ID (ID of the primary table) and TARGET_OBJECT_ID (ID of the index table) instead.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> __all_rootservice_event_history </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> module </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ddl_scheduler&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> event </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;switch_state&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> value1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">@ddl_tenant_id</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> value3 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;$OBJECT_ID&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> value4 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;$TARGET_OBJECT_ID&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If the value of <code>new_state</code> in the output is <code>2</code> (<code>WAIT_TRANS_END</code>), the system is probably waiting for the active transaction to end. The mappings between DDL execution phases and output values are as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">PREPARE = 0,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LOCK_TABLE = 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WAIT_TRANS_END = 2,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REDEFINITION = 3,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VALIDATE_CHECKSUM = 4,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY_TABLE_DEPENDENT_OBJECTS = 5,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TAKE_EFFECT = 6,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WRITE_BARRIER_LOG = 7,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CHECK_CONSTRAINT_VALID = 8,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SET_CONSTRAINT_VALIDATE = 9,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MODIFY_AUTOINC = 10,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SET_WRITE_ONLY = 11,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WAIT_TRANS_END_FOR_WRITE_ONLY = 12,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SET_UNUSABLE = 13,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WAIT_TRANS_END_FOR_UNUSABLE = 14,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DROP_SCHEMA = 15,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FAIL = 99,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SUCCESS = 100</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>If you cannot query the information about the DDL statement from the <code>__all_virtual_ddl_task_status</code> table, the RootService thread for scheduling the DDL task is probably stuck.</p>
<p>Execute the following statement to query the trace ID:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> gv$ob_sql_audit </span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"> query_sql </span><span class="token operator" style="color:#393A34">like</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;%keyword in the DDL statement%&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Filter the logs on the RootService leader based on the trace ID.</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">grep $trace_id rootservice</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> grep </span><span class="token string" style="color:#e3116c">&quot;DDLQueueTh&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> grep </span><span class="token string" style="color:#e3116c">&quot;\[DDL]&quot;</span><span class="token plain"> </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If the <code>6005</code> or <code>4023</code> error code related to table locks is returned in the log, confirm whether the issue is caused by lock contention of the <code>DROP</code> or <code>TRUNCATE</code> operation, or submit a question in the <a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer">Q&amp;A</a> section of the official website for assistance.</p>
<p>If the <code>4012</code> or <code>4121</code> error code related to RPC is returned in the log, query information as follows:</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Query RootService DDL requests that consume more than 100 ms</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grep </span><span class="token string" style="color:#e3116c">&quot;DDLQueueTh&quot;</span><span class="token plain"> rootservice</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> grep </span><span class="token string" style="color:#e3116c">&quot;\[DDL]&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> grep </span><span class="token string" style="color:#e3116c">&quot;cost=[0-9]\{6\}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Query RootService DDL requests that consume more than 1s</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grep </span><span class="token string" style="color:#e3116c">&quot;DDLQueueTh&quot;</span><span class="token plain"> rootservice</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> grep </span><span class="token string" style="color:#e3116c">&quot;\[DDL]&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> grep </span><span class="token string" style="color:#e3116c">&quot;cost=[0-9]\{7\}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Query RootService DDL requests that consume more than 10s</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grep </span><span class="token string" style="color:#e3116c">&quot;DDLQueueTh&quot;</span><span class="token plain"> rootservice</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> grep </span><span class="token string" style="color:#e3116c">&quot;\[DDL]&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> grep </span><span class="token string" style="color:#e3116c">&quot;cost=[0-9]\{8\}&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If the DDL statement takes a long time to execute and you cannot query it from the <code>__all_virtual_ddl_task_status</code> table based on the trace ID, it is probably that the business load is heavy. You can try to reduce the load to resolve the issue. If the DDL statement takes a short time to execute and the execution time is stable, we recommend that you submit a question in the <a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer">Q&amp;A</a> section of the official website and provide the information collected for assistance.</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshoot-database-initialization-failures">Troubleshoot database initialization failures<a href="#troubleshoot-database-initialization-failures" class="hash-link" aria-label="Direct link to Troubleshoot database initialization failures" title="Direct link to Troubleshoot database initialization failures">​</a></h3>
<p>When you start OceanBase Database for the first time after deployment, a bootstrap is performed to initialize the database. This action is performed only once. If the bootstrap times out due to improper resource parameter settings or poor server performance, the initialization will fail. In this case, you must reinstall OceanBase Database. If you are not sure about the initialization failure cause, reinstallation cannot resolve the issue but will affect user experience. This section describes how to troubleshoot a database initialization failure.</p>
<p><strong>Symptom</strong>: The bootstrap fails.</p>
<p><strong>Troubleshooting</strong>:</p>
<p>When the bootstrap fails, you only need to check the earliest observer.log file, regardless of the tool that you use to deploy OceanBase Database. During initialization, the observer process does not exit and will print a large amount of process logs. As a result, earlier logs will be overwritten, thereby distracting the troubleshooting. Therefore, you need to use the keywords related to database startup to locate the required logs.</p>
<ol>
<li>
<p>Check logs at the <code>ERROR</code> level. When initialization fails, <code>ERROR</code> logs are recorded. If a large number of <code>ERROR</code> logs exist, you can search for the keyword <code>Unexpected internal error happen</code>. However, this keyword cannot directly show the cause of the initialization failure. You still need to check related <code>WARN</code> and <code>WDIAG</code> logs. Here is an example:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Unexpected internal error happen, please checkout the internal errcode</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>If the system logs generated during initialization are overwritten and you cannot identify the cause based on logs generated later, you need to reinstall the database, use the keyword <code>begin server limit report</code> to locate the startup log, and check the <code>WARN</code>, <code>WDIAG</code>, and <code>ERROR</code> logs that follow this log. Here is an example:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2024-04-11 21:32:57.748844] INFO  print_all_limits (main.cpp:368) [43378][observer][T0][Y0-0000000000000000-0-0] [lt=6] ============= *begin server limit report * =============</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>For example, if you set <code>memory_limit</code> to <code>30G</code> and <code>system_memory</code> to <code>30G</code> when you deploy OceanBase Database by using OceanBase Deployer (OBD), the deployment will surely fail. Since OBD performs a precheck on parameters, you can find a <code>WARN</code> log followed by an <code>ERROR</code> log indicating a startup failure.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">obd cluster start lzq1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Get local repositories ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Search plugins ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load cluster param plugin ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Open ssh connection ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Check before start observer ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[WARN] obd-2010: (10.10.10.1): system_memory too large. system_memory should be less than 0.75 * memory_limit/memory_limit_percentage.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Start observer ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">observer program health check x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[WARN] obd-2002: Failed to start 10.10.10.1 observer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ERROR] oceanbase-ce start failed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">See https://www.oceanbase.com/product/ob-deployer/error-codes .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Trace ID: 12b798b0-fa48-11ee-8a58-00163e046d79</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If you want to view detailed obd logs, please run: obd display-trace 12b798b0-fa48-11ee-8a58-00163e046d79</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>At this time, the observer process is absent. The logs are as follows:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># The earliest `ERROR` log in the observer.log file reports the error message &quot;update observer memory config failed&quot;, indicating that the memory configuration is abnormal.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2024-04-14 18:16:37.849976] ERROR issue_dba_error (ob_log.cpp:1868) [76016][observer][T0][Y0-0000000000000000-0-0] [lt=18][errcode=-4388] Unexpected internal error happen, please checkout the internal errcode(errcode=-4147, file=&quot;ob_server_config.cpp&quot;, line_no=365, info=&quot;update observer memory config failed&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2024-04-14 18:16:37.849983] EDIAG [SHARE.CONFIG] reload_config (ob_server_config.cpp:365) [76016][observer][T0][Y0-0000000000000000-0-0] [lt=7][errcode=-4147] update observer memory config failed(memory_limit=32212254720, system_memory=32212254720, hidden_sys_memory=12079595520, min_server_avail_memory=2147483648) BACKTRACE:0x113b8115 0x6ad98b0 0x6ad9471 0x6ad90ec 0x6ad8ee5 0xf2e7697 0xf2e70c8 0x9cd0a93 0x9cc6c55 0x6ab20e4 0x7ff08e478445 0x4e56560</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2024-04-14 18:16:37.850043] WDIAG [SHARE.CONFIG] reload_config (ob_server_config.cpp:377) [76016][observer][T0][Y0-0000000000000000-0-0] [lt=57][errcode=-4147] the hold memory of tenant_500 is over the reserved memory(tenant_500_hold=6291456, tenant_500_reserved=0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2024-04-14 18:16:37.850052] ERROR issue_dba_error (ob_log.cpp:1868) [76016][observer][T0][Y0-0000000000000000-0-0] [lt=5][errcode=-4388] Unexpected internal error happen, please checkout the internal errcode(errcode=-4147, file=&quot;ob_server.cpp&quot;, line_no=1886, info=&quot;reload memory config failed&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># According to the following logs, the sys tenant created adaptively can apply for 2 GB to 12 GB of memory. After 32 GB of system memory is applied for, the remaining memory space is insufficient to support a 2 GB memory application of the sys tenant, which causes the initialization failure.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">memory_limit=32212254720, system_memory=32212254720, hidden_sys_memory=12079595520, min_server_avail_memory=2147483648)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshoot-database-initialization-failures-1">Troubleshoot database initialization failures<a href="#troubleshoot-database-initialization-failures-1" class="hash-link" aria-label="Direct link to Troubleshoot database initialization failures" title="Direct link to Troubleshoot database initialization failures">​</a></h3>
<p>When you start OceanBase Database for the first time after deployment, a bootstrap is performed to initialize the database. This action is performed only once. If the bootstrap times out due to improper resource parameter settings or poor server performance, the initialization will fail. In this case, you must reinstall OceanBase Database. If you are not sure about the initialization failure cause, reinstallation cannot resolve the issue but will affect user experience. This section describes how to troubleshoot a database initialization failure.</p>
<p><strong>Symptom</strong>: The bootstrap fails.</p>
<p><strong>Troubleshooting</strong>:</p>
<p>When the bootstrap fails, you only need to check the earliest observer.log file, regardless of the tool that you use to deploy OceanBase Database. During initialization, the observer process does not exit and will print a large amount of process logs. As a result, earlier logs will be overwritten, thereby distracting the troubleshooting. Therefore, you need to use the keywords related to database startup to locate the required logs.</p>
<ol>
<li>
<p>Check logs at the <code>ERROR</code> level. When initialization fails, <code>ERROR</code> logs are recorded. If a large number of <code>ERROR</code> logs exist, you can search for the keyword <code>Unexpected internal error happen</code>. However, this keyword cannot directly show the cause of the initialization failure. You still need to check related <code>WARN</code> and <code>WDIAG</code> logs. Here is an example:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Unexpected internal error happen, please checkout the internal errcode</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>If the system logs generated during initialization are overwritten and you cannot identify the cause based on logs generated later, you need to reinstall the database, use the keyword <code>begin server limit report</code> to locate the startup log, and check the <code>WARN</code>, <code>WDIAG</code>, and <code>ERROR</code> logs that follow this log. Here is an example:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2024-04-11 21:32:57.748844] INFO  print_all_limits (main.cpp:368) [43378][observer][T0][Y0-0000000000000000-0-0] [lt=6] ============= *begin server limit report * =============</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<p>For example, if you set <code>memory_limit</code> to <code>30G</code> and <code>system_memory</code> to <code>30G</code> when you deploy OceanBase Database by using OceanBase Deployer (OBD), the deployment will surely fail. Since OBD performs a precheck on parameters, you can find a <code>WARN</code> log followed by an <code>ERROR</code> log indicating a startup failure.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">obd cluster start lzq1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Get local repositories ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Search plugins ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Load cluster param plugin ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Open ssh connection ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Check before start observer ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[WARN] obd-2010: (10.10.10.1): system_memory too large. system_memory should be less than 0.75 * memory_limit/memory_limit_percentage.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Start observer ok</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">observer program health check x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[WARN] obd-2002: Failed to start 10.10.10.1 observer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ERROR] oceanbase-ce start failed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">See https://www.oceanbase.com/product/ob-deployer/error-codes .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Trace ID: 12b798b0-fa48-11ee-8a58-00163e046d79</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">If you want to view detailed obd logs, please run: obd display-trace 12b798b0-fa48-11ee-8a58-00163e046d79</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>At this time, the observer process is absent. The logs are as follows:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># The earliest `ERROR` log in the observer.log file reports the error message &quot;update observer memory config failed&quot;, indicating that the memory configuration is abnormal.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2024-04-14 18:16:37.849976] ERROR issue_dba_error (ob_log.cpp:1868) [76016][observer][T0][Y0-0000000000000000-0-0] [lt=18][errcode=-4388] Unexpected internal error happen, please checkout the internal errcode(errcode=-4147, file=&quot;ob_server_config.cpp&quot;, line_no=365, info=&quot;update observer memory config failed&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2024-04-14 18:16:37.849983] EDIAG [SHARE.CONFIG] reload_config (ob_server_config.cpp:365) [76016][observer][T0][Y0-0000000000000000-0-0] [lt=7][errcode=-4147] update observer memory config failed(memory_limit=32212254720, system_memory=32212254720, hidden_sys_memory=12079595520, min_server_avail_memory=2147483648) BACKTRACE:0x113b8115 0x6ad98b0 0x6ad9471 0x6ad90ec 0x6ad8ee5 0xf2e7697 0xf2e70c8 0x9cd0a93 0x9cc6c55 0x6ab20e4 0x7ff08e478445 0x4e56560</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2024-04-14 18:16:37.850043] WDIAG [SHARE.CONFIG] reload_config (ob_server_config.cpp:377) [76016][observer][T0][Y0-0000000000000000-0-0] [lt=57][errcode=-4147] the hold memory of tenant_500 is over the reserved memory(tenant_500_hold=6291456, tenant_500_reserved=0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2024-04-14 18:16:37.850052] ERROR issue_dba_error (ob_log.cpp:1868) [76016][observer][T0][Y0-0000000000000000-0-0] [lt=5][errcode=-4388] Unexpected internal error happen, please checkout the internal errcode(errcode=-4147, file=&quot;ob_server.cpp&quot;, line_no=1886, info=&quot;reload memory config failed&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># According to the following logs, the sys tenant created adaptively can apply for 2 GB to 12 GB of memory. After 32 GB of system memory is applied for, the remaining memory space is insufficient to support a 2 GB memory application of the sys tenant, which causes the initialization failure.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">memory_limit=32212254720, system_memory=32212254720, hidden_sys_memory=12079595520, min_server_avail_memory=2147483648)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshoot-database-upgrade-failures-based-on-logs">Troubleshoot database upgrade failures based on logs<a href="#troubleshoot-database-upgrade-failures-based-on-logs" class="hash-link" aria-label="Direct link to Troubleshoot database upgrade failures based on logs" title="Direct link to Troubleshoot database upgrade failures based on logs">​</a></h3>
<p>In essence, OceanBase Database is upgraded by using an OceanBase Database upgrade script, regardless of the tool that you use for the upgrade. Generally, OceanBase Database is upgraded by using OBD or OCP. When an upgrade fails, it is difficult to confirm the failure cause by checking the ODP or OCP logs. You need to check the logic based on the script. Actually, dedicated logs are generated for an upgrade script.</p>
<blockquote>
<p><strong>Note</strong></p>
<p>For more information about the upgrade script, see <strong>Step 1</strong> in <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001106726" target="_blank" rel="noopener noreferrer">Upgrade an OceanBase cluster</a>.</p>
</blockquote>
<p><strong>Symptom</strong>: The upgrade of OceanBase Database by using OBD or OCP fails.</p>
<p><strong>Troubleshooting</strong>:</p>
<ul>
<li>
<p>The upgrade of OceanBase Database by using OBD may fail in different phases. Logs are generated in the current directory where the OBD upgrade command is executed.</p>
<ul>
<li>
<p>Failure in the <code>Exec upgrade_checker.py x</code> phase: You can run the <code>obd display-trace</code> command and identify the cause based on the output. If you cannot identify the cause based on the output, you can check the script log file <code>upgrade_checker.log</code>.</p>
</li>
<li>
<p>Failure in the <code>Exec upgrade_pre.py x</code> phase: An upgrade usually fails in this phase. Generally, after you run the <code>obd display-trace</code> command, the failure cause provided in the output is not clear. Therefore, you need to check the script log file <code>upgrade_pre.log</code> to analyze the cause based on the actual situation.</p>
</li>
<li>
<p>Failure in the <code>Exec upgrade_health_checker.py x</code> phase: An upgrade hardly fails in this phase. You can check the log file <code>upgrade_cluster_health_checker.log</code> to analyze the failure cause.</p>
</li>
<li>
<p>Failure in the <code>Exec upgrade_post.py x</code> phase: An upgrade usually fails in this phase. You need to check the script log file <code>upgrade_post.log</code> to analyze the cause based on the actual situation.</p>
</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>Note</strong></p>
<ul>
<li>
<p>If a timeout occurs during the upgrade of OceanBase Database by using OBD, you can run the OBD upgrade command again. At present, OBD allows you to upgrade the database again regardless of the phase in which the timeout occurs.</p>
</li>
<li>
<p>If you cannot confirm the failure cause through self-service troubleshooting, we recommend that you collect related logs and submit a question in the <a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer">Q&amp;A</a> section of the official website for assistance.</p>
</li>
</ul>
</blockquote>
<ul>
<li>The logic for upgrading OceanBase Database by using OCP is similar to that for upgrading OceanBase Database by using OBD. When you perform an upgrade with OCP, upgrade logs are generated and displayed on the GUI in real time. However, when the upgrade script fails, you also need to check the upgrade logs, which are stored in a different path with a different file name from those used for upgrading with OBD.<!-- -->
<ul>
<li>Log storage path: <code>/tmp/{version}/upgrade_*_{time}.log, such as /tmp/4.2.1.2-102000042023120514_upgrade_post_20240411101214.log</code>.</li>
<li>When an upgrade step fails, it is prohibited to skip the step or set the status of the step to successful. Some upgrade steps will modify related system parameters. If you skip a failed upgrade step, the cluster may become unavailable. We recommend that you collect related logs and submit a question in the <a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer">Q&amp;A</a> section of the official website for assistance.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="collect-stack-information-when-an-observer-node-crashes">Collect stack information when an OBServer node crashes<a href="#collect-stack-information-when-an-observer-node-crashes" class="hash-link" aria-label="Direct link to Collect stack information when an OBServer node crashes" title="Direct link to Collect stack information when an OBServer node crashes">​</a></h3>
<p><strong>Symptom</strong>: A properly running OBServer node exits accidentally, and a core dump file is generated on the node.</p>
<p><strong>Troubleshooting</strong>:</p>
<ol>
<li>
<p>Run the following command to check whether the <code>CRASH ERROR</code> keyword is included in the logs generated by the OBServer node.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@test001 ~]$ grep &quot;CRASH ERROR&quot; observer.log</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CRASH ERROR!!! sig=6, sig_code=-6, sig_addr=3eb00000dbb, timestamp=1712828099270879, tid=4466, tname=ReplayEngine12, trace_id=0-0, extra_info=((null)),    lbt=0x9af40d8 0x9ae4978 0x7f74fdbdd62f 0x7f74fd42a377 0x7f74fd42ba67 0x9a28638 0x873cffa 0x8dd491f 0x8dd309b 0x8e6f22e 0x8b4e29c 0x8b4ac4b 0x8b48b04    0x9a69028 0x3426f0e 0x2cc7671 0x985e884 0x985d271 0x9859d2e</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Check whether a core dump file is generated in the location specified by <code>kernel.core_pattern</code>, which is a parameter in the <code>sysctl.conf</code> file under the <code>/etc/</code> directory on the OBServer node.</p>
<p>Query the location specified by <code>kernel.core_pattern</code>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@test001 ~]$ grep &quot;kernel.core_pattern&quot; /etc/sysctl.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows:</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kernel.core_pattern = /obdata/data/core-%e-%p-%t</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p><strong>Note</strong></p>
<p>If <code>kernel.core_pattern</code> is not specified, by default, a <code>core.${ob_pid}</code> file is generated in the home directory (<code>home_path</code>) of OceanBase Database.</p>
</blockquote>
<p>Check the core dump file.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@test001 ~]$ ls -l /obdata/data/core*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output is as follows. If the core dump file is not generated, you can run the <code>ulimit -a</code> or <code>ulimit -c</code> command to view the current resource limits. If the value is <code>0</code> or small, no core dump file can be generated when the node crashes.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-rw------- 1 admin admin 8723914752 April   8 19:04 /obdata/data/core-observer-27670-1712574296</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Run the <code>addr2line</code> command to collect stack information.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">addr2line -pCfe ./bin/observer 0x9af40d8 0x9ae4978 0x7f74fdbdd62f 0x7f74fd42a377 0x7f74fd42ba67 0x9a28638 0x873cffa 0x8dd491f 0x8dd309b 0x8e6f22e 0x8b4e29c 0x8b4ac4b 0x8b48b04 0x9a69028 0x3426f0e 0x2cc7671 0x985e884 0x985d271</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Submit a question in the <a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer">Q&amp;A</a> section of the official website and provide the core dump file, stack information, and logs recorded near the failure time in the observer.log file for assistance.</p>
</li>
</ol>
<p>You can also take the following emergency measures:</p>
<p>Generally, a core dump file is generated when the database system crashes due to an exception. After you collect or back up the information required for troubleshooting, you can try to manually restart the observer process to resolve the issue. When crashes frequently occur and the issue cannot be resolved through a restart, if the cluster is available, you can replace the faulty node or increase the time to wait before putting the node permanently offline. If the cluster is unavailable, you can restore data from backup files or switch to the physical standby database to resume business.</p>
<p>For more information about how to replace an OBServer node, see <a href="https://en.oceanbase.com/docs/common-ocp-10000000001483764" target="_blank" rel="noopener noreferrer">Replace an OBServer node</a>.</p>
<p>For more information about how to increase the time to wait before putting a node permanently offline, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001103895" target="_blank" rel="noopener noreferrer">Failures of a minority of nodes</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/oceanbase/oceanbase.github.io/tree/main/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_05_operation_and_maintenance/04_o_m_by_sql.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_05_operation_and_maintenance/o_m_by_ob-operator"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Perform O&amp;M by using ob-operator</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/user_manual/quick_starts_and_hands_on_practices_in_english/chapter_06_using_ob_for_business_development/introduction"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Introduction</div></a></nav><div>Loading...</div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#common-sql-statements" class="table-of-contents__link toc-highlight">Common SQL statements</a><ul><li><a href="#sql-statements-for-basic-cluster-management" class="table-of-contents__link toc-highlight">SQL statements for basic cluster management</a></li><li><a href="#sql-statements-for-querying-cluster-resources" class="table-of-contents__link toc-highlight">SQL statements for querying cluster resources</a></li><li><a href="#sql-statements-related-to-table-partitions" class="table-of-contents__link toc-highlight">SQL statements related to table partitions</a></li><li><a href="#sql-statements-related-to-table-distribution" class="table-of-contents__link toc-highlight">SQL statements related to table distribution</a></li><li><a href="#sql-statements-related-to-minor-and-major-compactions" class="table-of-contents__link toc-highlight">SQL statements related to minor and major compactions</a></li><li><a href="#sql-statements-related-to-execution-plans-and-plan-caches" class="table-of-contents__link toc-highlight">SQL statements related to execution plans and plan caches</a></li><li><a href="#sql-statements-related-to-statistics-collection" class="table-of-contents__link toc-highlight">SQL statements related to statistics collection</a></li><li><a href="#other-sql-statements" class="table-of-contents__link toc-highlight">Other SQL statements</a></li></ul></li><li><a href="#common-issues-and-troubleshooting" class="table-of-contents__link toc-highlight">Common issues and troubleshooting</a><ul><li><a href="#obtain-the-database-logs-of-an-sql-statement" class="table-of-contents__link toc-highlight">Obtain the database logs of an SQL statement</a></li><li><a href="#collect-information-about-slow-sql-statements" class="table-of-contents__link toc-highlight">Collect information about slow SQL statements</a></li><li><a href="#troubleshoot-database-initialization-failures" class="table-of-contents__link toc-highlight">Troubleshoot database initialization failures</a></li><li><a href="#troubleshoot-database-initialization-failures-1" class="table-of-contents__link toc-highlight">Troubleshoot database initialization failures</a></li><li><a href="#troubleshoot-database-upgrade-failures-based-on-logs" class="table-of-contents__link toc-highlight">Troubleshoot database upgrade failures based on logs</a></li><li><a href="#collect-stack-information-when-an-observer-node-crashes" class="table-of-contents__link toc-highlight">Collect stack information when an OBServer node crashes</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="http://github.com/oceanbase/oceanbase/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussion<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://join.slack.com/t/oceanbase/shared_invite/zt-1e25oz3ol-lJ6YNqPHaKwY_mhhioyEuw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/oceanbase" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum (in Chinese)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">SIG</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/sig/AI/sig_intro">AI</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/cloud-native/sig_intro">cloud-native</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/compilation/sig_intro">compilation</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/develop-tools/sig_intro">develop-tools</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/miniob/sig_intro">MiniOB</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/obdiag/sig_intro">obdiag</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/operation/sig_intro">operation</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://en.oceanbase.com/about" target="_blank" rel="noopener noreferrer" class="footer__link-item">About OceanBase<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/blogs/arch/all-in-one">Blogs</a></li><li class="footer__item"><a href="https://github.com/oceanbase/oceanbase" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 OceanBase, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>