<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-user_manual/operation_and_maintenance/en-US/tool_emergency_handbook/odp_troubleshooting_guide/connection_diagnosis" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Troubleshoot ODP Connection Issues | OceanBase</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://oceanbase.github.io/docs/user_manual/operation_and_maintenance/en-US/tool_emergency_handbook/odp_troubleshooting_guide/connection_diagnosis"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Troubleshoot ODP Connection Issues | OceanBase"><meta data-rh="true" name="description" content="When OceanBase Database Proxy (ODP) is used, the execution link of a request is as follows: a client sends a request to ODP, ODP routes the request to the corresponding OBServer node, the OBServer node processes the request and returns a response to ODP, and ODP forwards the response to the client."><meta data-rh="true" property="og:description" content="When OceanBase Database Proxy (ODP) is used, the execution link of a request is as follows: a client sends a request to ODP, ODP routes the request to the corresponding OBServer node, the OBServer node processes the request and returns a response to ODP, and ODP forwards the response to the client."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://oceanbase.github.io/docs/user_manual/operation_and_maintenance/en-US/tool_emergency_handbook/odp_troubleshooting_guide/connection_diagnosis"><link data-rh="true" rel="alternate" href="https://oceanbase.github.io/docs/user_manual/operation_and_maintenance/en-US/tool_emergency_handbook/odp_troubleshooting_guide/connection_diagnosis" hreflang="en"><link data-rh="true" rel="alternate" href="https://oceanbase.github.io/docs/user_manual/operation_and_maintenance/en-US/tool_emergency_handbook/odp_troubleshooting_guide/connection_diagnosis" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6JQM9QDU5V-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H4XM2M50RX"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-H4XM2M50RX",{})</script><link rel="stylesheet" href="/assets/css/styles.7e3a93fe.css">
<script src="/assets/js/runtime~main.39090e61.js" defer="defer"></script>
<script src="/assets/js/main.8ec6e36a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="OceanBase Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="OceanBase Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">OceanBase</b></a><a class="navbar__item navbar__link" href="/docs/blogs/arch/all-in-one">Blogs</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Docs</a><ul class="dropdown__menu"><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">Product Docs</a><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">User Manual</a><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">Developer Manual</a></ul><ul class="dropdown__menu" style="left:160px;display:none"></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><span><li><a class="dropdown__link" href="/docs/sig/overview/list">Special Interest Group(SIG)</a></li></span><span><li><a class="dropdown__link" href="/docs/honor/overview">Community Honors</a></li></span><span><li><a href="http://github.com/oceanbase/oceanbase/discussions" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub Discussion<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://discord.gg/74cF8vbNEs" target="_blank" rel="noopener noreferrer" class="dropdown__link">Discord<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Forum (in Chinese)<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://stackoverflow.com/questions/tagged/oceanbase" target="_blank" rel="noopener noreferrer" class="dropdown__link">Stack Overflow<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span></ul><ul class="dropdown__menu" style="left:160px;display:none"></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Data + AI</a><ul class="dropdown__menu"><span><li><a href="https://oceanbase-devhub.github.io" target="_blank" rel="noopener noreferrer" class="dropdown__link">AI Workshops<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://oceanbase-devhub.github.io/ai-workshop-2024" target="_blank" rel="noopener noreferrer" class="dropdown__link">RAG Bot<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://oceanbase-devhub.github.io/dify/dify@oceanbase-workshop" target="_blank" rel="noopener noreferrer" class="dropdown__link">Dify (MySQL Compatible)<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://oceanbase-devhub.github.io/DB-GPT/docker/compose_examples/ob_dbgpt_tutorial" target="_blank" rel="noopener noreferrer" class="dropdown__link">DB-GPT<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span></ul><ul class="dropdown__menu" style="left:160px;display:none"></ul></div><a href="https://en.oceanbase.com/softwarecenter" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Downloads<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/oceanbase" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/operation_and_maintenance/en-US/about_this_manual/overview">About &quot;DBA Advanced Tutorial&quot;</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/operation_and_maintenance/en-US/disaster_recovery_architecture_design/high_availability_architecture_overview">Disaster Recovery Architecture Design</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/operation_and_maintenance/en-US/operations_and_maintenance/version_upgrade_path">Operation and Maintenance Management</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/operation_and_maintenance/en-US/scenario_best_practices/parameter_templates">Best Practice Scenarios</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/operation_and_maintenance/en-US/development_specification/object_specification">Development Specification</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/emergency_overview">OBServer Emergency Handbook</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/user_manual/operation_and_maintenance/en-US/tool_emergency_handbook/oms_troubleshooting_guide">Community Tools Troubleshooting Guide</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/operation_and_maintenance/en-US/tool_emergency_handbook/oms_troubleshooting_guide">OMS Community Edition Troubleshooting Guide</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/user_manual/operation_and_maintenance/en-US/tool_emergency_handbook/odp_troubleshooting_guide/introduction">ODP Community Edition Troubleshooting Manual</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/operation_and_maintenance/en-US/tool_emergency_handbook/odp_troubleshooting_guide/introduction">Background Knowledge of ODP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/operation_and_maintenance/en-US/tool_emergency_handbook/odp_troubleshooting_guide/show_trace">Check Whether ODP Causes a Performance Bottleneck</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/user_manual/operation_and_maintenance/en-US/tool_emergency_handbook/odp_troubleshooting_guide/connection_diagnosis">Troubleshoot ODP Connection Issues</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/operation_and_maintenance/en-US/tool_emergency_handbook/odp_troubleshooting_guide/routing_diagnosis">Troubleshoot ODP Routing Issues</a></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Community Tools Troubleshooting Guide</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">ODP Community Edition Troubleshooting Manual</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Troubleshoot ODP Connection Issues</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Troubleshoot ODP Connection Issues</h1></header><blockquote>
<p>When OceanBase Database Proxy (ODP) is used, the execution link of a request is as follows: a client sends a request to ODP, ODP routes the request to the corresponding OBServer node, the OBServer node processes the request and returns a response to ODP, and ODP forwards the response to the client.</p>
<p>A disconnection may occur on the link in the following cases: the client does not receive a response from ODP due to a long request processing time, login fails due to incorrect cluster or tenant information, or an internal error occurs in ODP or OceanBase Database.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-procedure">Troubleshooting Procedure<a href="#troubleshooting-procedure" class="hash-link" aria-label="Direct link to Troubleshooting Procedure" title="Direct link to Troubleshooting Procedure">​</a></h2>
<blockquote>
<p><strong><font color="red">We recommend that you carefully read this section. You can handle most exceptions according to logs retrieved based on trace IDs. </font></strong></p>
</blockquote>
<p>The troubleshooting procedure for ODP is similar to that for OBServer nodes.</p>
<p>For example, if a connection error occurs, check the error log.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[xiaofeng.lby@sqaobnoxdn011161204091.sa128 /home/xiaofeng.lby]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$obclient -h 127.0.0.1 -P2883 -uroot@sys#xiaofeng_91_435 -Dtest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ERROR 4669 (HY000): cluster not exist</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>This is not a very good example though. When the first error &quot;cluster not exist&quot; is returned, you already know what the problem is.</p>
</blockquote>
<p>If you are not sure whether the problem is caused by ODP, you can run the <code>grep &quot;ret=-4669&quot; *</code> command in the <code>/oceanbase/log</code> directory. If the log directory contains many log files, replace the asterisk (*) behind <code>grep</code> with a specific log file name like <code>observer.log.202412171219*</code> based on the actual situation.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[xiaofeng.lby@sqaobnoxdn011161204091.sa128 /home/xiaofeng.lby/oceanbase/log]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$sudo grep &quot;ret=-4669&quot; *</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If the <code>grep</code> command does not find any error information in the <code>observer</code> directory, the problem is probably caused by ODP. In this case, you can run the <code>grep</code> command in the <code>/obproxy/log</code> directory.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[xiaofeng.lby@sqaobnoxdn011161204091.sa128 /home/xiaofeng.lby/obproxy/log]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$grep &quot;ret=-4669&quot; *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># The output here is originally one line, and is manually split into multiple lines for display on the web page.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">obproxy.log:[2024-12-17 14:34:14.024891]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WDIAG [PROXY.SM] setup_get_cluster_resource (ob_mysql_sm.cpp:1625) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[125907][Y0-00007F630AAA2A70] [lt=0] [dc=0] </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cluster does not exist, this connection will disconnect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(sm_id=26403246, is_clustername_from_default=false, cluster_name=xiaofeng_91_435, ret=-4669)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can see in the log that the cluster named <code>xiaofeng_91_435</code> does not exist. Therefore, the disconnection occurs.</p>
<p>You can also obtain the trace ID <code>[Y0-00007F630AAA2A70]</code> from the preceding log. You can run the <code>grep</code> command based on this trace ID to obtain all logs related to this operation.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[xiaofeng.lby@sqaobnoxdn011161204091.sa128 /home/xiaofeng.lby/obproxy/log]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$grep Y0-00007F630AAA2A70 *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">obproxy_diagnosis.log:[2024-12-17 14:34:14.024938] [125907][Y0-00007F630AAA2A70] [LOGIN](trace_type=&quot;LOGIN_TRACE&quot;, connection_diagnosis={cs_id:278640, ss_id:0, proxy_session_id:0, server_session_id:0, client_addr:&quot;127.0.0.1:9988&quot;, server_addr:&quot;*Not IP address [0]*:0&quot;, cluster_name:&quot;xiaofeng_91_435&quot;, tenant_name:&quot;sys&quot;, user_name:&quot;root&quot;, error_code:-4669, error_msg:&quot;cluster does not exist&quot;, request_cmd:&quot;OB_MYSQL_COM_LOGIN&quot;, sql_cmd:&quot;OB_MYSQL_COM_LOGIN&quot;, req_total_time(us):196}{internal_sql:&quot;&quot;, login_result:&quot;failed&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">obproxy_error.log:2024-12-17 14:34:14.024960,xiaofeng_cluster_430_proxy,,,,xiaofeng_91_435:sys:,OB_MYSQL,,,OB_MYSQL_COM_LOGIN,,failed,-4669,,194us,0us,0us,0us,Y0-00007F630AAA2A70,,127.0.0.1:9988,,0,,cluster not exist,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">obproxy.log:[2024-12-17 14:34:13.584801] INFO  [PROXY.NET] accept (ob_mysql_session_accept.cpp:36) [125907][Y0-00007F630AAA2A70] [lt=0] [dc=0] [ObMysqlSessionAccept:main_event] accepted connection(netvc=0x7f630aa7d2e0, client_ip={127.0.0.1:9980})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After a disconnection occurs, ODP generates a disconnection log in the <code>obproxy_diagnosis.log</code> file to record detailed information about the disconnection. The following is a disconnection log that records a login failure due to an incorrect tenant name.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># The output here is originally one line, and is manually split into multiple lines for display on the web page.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[2023-08-23 20:11:08.567425]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[109316][Y0-00007F285BADB4E0] [CONNECTION]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(trace_type=&quot;LOGIN_TRACE&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">connection_diagnosis={</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cs_id:1031798792, ss_id:0, proxy_session_id:0, server_session_id:0, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    client_addr:&quot;10.10.10.1:58218&quot;, server_addr:&quot;*Not IP address [0]*:0&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cluster_name:&quot;undefined&quot;, tenant_name:&quot;test&quot;, user_name:&quot;root&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    error_code:-4043,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    error_msg:&quot;dummy entry is empty, please check if the tenant exists&quot;, request_cmd:&quot;COM_SLEEP&quot;, sql_cmd:&quot;COM_LOGIN&quot;}{internal_sql:&quot;&quot;})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can guess the reason for the disconnection based on the <code>please check if the tenant exists</code> information in the error message.</p>
<blockquote>
<p><strong><font color="red">The latter part of this topic is all &quot;dictionary&quot; content that you can consult when necessary. You only need to browse through the content to get a general idea. </font></strong></p>
<p><strong><font color="red">We recommend that you add this topic to your favorites first. If an error occurs, pull the error log and search for the corresponding solution based on the key information provided in the log. </font></strong></p>
</blockquote>
<p>The general fields in an obproxy_diagnosis log are described as follows:</p>
<ul>
<li>
<p><code>LOG_TIME</code>: the time when the log was recorded, which is <code>2023-08-23 20:11:08.567425</code> in this example.</p>
</li>
<li>
<p><code>TID</code>: the ID of the thread, which is <code>109316</code> in this example.</p>
</li>
<li>
<p><code>TRACE_ID</code>: the trace ID, which is <code>Y0-00007F285BADB4E0</code> in this example. You can associate the log with other logs based on the trace ID.</p>
</li>
<li>
<p><code>CONNECTION</code>: indicates that this log is related to connection diagnostics.</p>
</li>
<li>
<p><code>trace_type</code>: the diagnostic type, which varies based on the cause of disconnection. Valid values:</p>
<ul>
<li>
<p><code>LOGIN_TRACE</code>: indicates that the disconnection is caused by a login failure.</p>
</li>
<li>
<p><code>SERVER_INTERNAL_TRACE</code>: indicates that the disconnection is caused by an internal error in OceanBase Database.</p>
</li>
<li>
<p><code>PROXY_INTERNAL_TRACE</code>: indicates that the disconnection is caused by an internal error in ODP.</p>
</li>
<li>
<p><code>CLIENT_VC_TRACE</code>: indicates that the disconnection is actively initiated by the client.</p>
</li>
<li>
<p><code>SERVER_VC_TRACE</code>: indicates that the disconnection is actively initiated by OceanBase Database.</p>
</li>
<li>
<p><code>TIMEOUT_TRACE</code>: indicates that the disconnection is caused by an execution timeout of the ODP process.</p>
</li>
</ul>
</li>
<li>
<p><code>CS_ID</code>: the internal ID used by ODP to identify the client connection.</p>
</li>
<li>
<p><code>SS_ID</code>: the internal ID used by ODP to identify the connection between ODP and OceanBase Database.</p>
</li>
<li>
<p><code>PROXY_SS_ID</code>: the ID generated by ODP to identify the client connection. This ID is passed to OceanBase Database and can be used to filter OceanBase Database logs or the sql_audit table.</p>
</li>
<li>
<p><code>SERVER_SS_ID</code>: the ID generated by OceanBase Database to identify the connection between ODP and OceanBase Database.</p>
</li>
<li>
<p><code>CLIENT_ADDR</code>: the IP address of the client.</p>
</li>
<li>
<p><code>SERVER_ADDR</code>: the IP address of the OBServer node where an error or disconnection occurs.</p>
</li>
<li>
<p><code>CLUSTER_NAME</code>: the name of the cluster.</p>
</li>
<li>
<p><code>TENANT_NAME</code>: the name of the tenant.</p>
</li>
<li>
<p><code>USER_NAME</code>: the username.</p>
</li>
<li>
<p><code>ERROR_CODE</code>: the error code.</p>
</li>
<li>
<p><code>ERROR_MSG</code>: the error message, which is the key information for diagnosing disconnections.</p>
</li>
<li>
<p><code>REQUEST_CMD</code>: the type of the statement being processed by ODP, which can be an internal request.</p>
</li>
<li>
<p><code>SQL_CMD</code>: the type of the user statement.</p>
</li>
</ul>
<p>Besides the preceding general information, a diagnostic log can contain additional diagnostic information, which is subject to the diagnostic type.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="general-disconnection-scenarios">General Disconnection Scenarios<a href="#general-disconnection-scenarios" class="hash-link" aria-label="Direct link to General Disconnection Scenarios" title="Direct link to General Disconnection Scenarios">​</a></h2>
<p>This section describes several common disconnection scenarios and how to locate and resolve these disconnections.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="disconnection-upon-a-login-failure">Disconnection upon a login failure<a href="#disconnection-upon-a-login-failure" class="hash-link" aria-label="Direct link to Disconnection upon a login failure" title="Direct link to Disconnection upon a login failure">​</a></h3>
<p>The diagnostic type is <code>LOGIN_TRACE</code>. Here is a sample diagnostic log that records a disconnection caused by an incorrect tenant name during login.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[2023-09-08 10:37:21.028960] [90663][Y0-00007F8EB76544E0] [CONNECTION](trace_type=&quot;LOGIN_TRACE&quot;, connection_diagnosis={cs_id:1031798785, ss_id:0, proxy_session_id:0, server_session_id:0, client_addr:&quot;10.10.10.1:44018&quot;, server_addr:&quot;*Not IP address [0]*:0&quot;, cluster_name:&quot;undefined&quot;, tenant_name:&quot;sys&quot;, user_name:&quot;root&quot;, error_code:-10018, error_msg:&quot;fail to check observer version, empty result&quot;, request_cmd:&quot;COM_SLEEP&quot;, sql_cmd:&quot;COM_LOGIN&quot;}{internal_sql:&quot;SELECT ob_version() AS cluster_version&quot;})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The additional diagnostic information is <code>internal_sql</code>, which indicates that an internal request is being processed by ODP.</p>
<p>The causes of a disconnection upon a login failure are complex. This section describes the causes and solutions from the perspectives of user operations and OceanBase Database.</p>
<p>The following table describes the disconnection scenarios of user operations and the corresponding solutions.</p>
<table><thead><tr><th>Scenario</th><th>Error code</th><th>Error message</th><th>Solution</th></tr></thead><tbody><tr><td>The cluster name is incorrect.</td><td>4669</td><td>cluster xxx does not exist</td><td>Make sure that the corresponding cluster exists and the cluster name is correct. You can directly connect to the OBServer node and run the <code>show parameters like &#x27;cluster&#x27;;</code> command for verification. The <code>value</code> value in the output is the name of the cluster to connect to.</td></tr><tr><td>The tenant name is incorrect.</td><td>4043</td><td>dummy entry is empty, please check if the tenant exists</td><td>Make sure that the corresponding tenant exists. You can directly connect to the OBServer node as the <code>root@sys</code> user and execute the <code>SELECT * FROM DBA_OB_TENANTS;</code> statement to view all tenants in the cluster.</td></tr><tr><td>ODP allowlist verification fails.</td><td>8205</td><td>user xxx@xxx can not pass white list</td><td>Check whether ODP allowlists are correctly configured in the console. For more information, see &quot;Allowlists&quot; in <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001715111" target="_blank" rel="noopener noreferrer">OceanBase Cloud documentation</a>.</td></tr><tr><td>OceanBase Database allowlist verification fails.</td><td>1227</td><td>Access denied</td><td>View the <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001105243" target="_blank" rel="noopener noreferrer">ob_tcp_invited_nodes</a> variable to check whether OceanBase Database allowlists are correctly configured.</td></tr><tr><td>The number of client connections reaches the upper limit.</td><td>5059</td><td>too many sessions</td><td>Execute the <code>ALTER proxyconfig SET &lt;var_name&gt; = &lt;var_value&gt;;</code> statement to modify the ODP parameter <code>client_max_connections</code> to work around this issue.</td></tr><tr><td>ODP is configured to use the SSL protocol but a user request is initiated by using a non-SSL protocol.</td><td>8004</td><td>obproxy is configured to use ssl connection</td><td>Change the value of the <code>enable_client_ssl</code> parameter to <code>false</code>, which specifies not to use SSL for connections, or initiate an SSL access request.</td></tr><tr><td>The proxyro@sys user is used to directly access OceanBase Database.</td><td>10021</td><td>user proxyro is rejected while proxyro_check on</td><td>You cannot directly access OceanBase Database as the <code>proxyro@sys</code> user.</td></tr><tr><td>A cloud user uses a username in the three-segment format for access when <code>enable_cloud_full_user_name</code> is disabled.</td><td>10021</td><td>connection with cluster name and tenant name is rejected while cloud_full_user_name_check off</td><td>A cloud user cannot use a username in the three-segment format for access when <code>enable_cloud_full_user_name</code> is disabled You can enable the <code>enable_cloud_full_user_name</code> parameter or access by using a regular username not in the three-segment format.</td></tr><tr><td>The password of the proxyro user is incorrect.</td><td>10018</td><td>fail to check observer version, proxyro@sys access denied, error resp <code>{ code:1045, msg:Access denied for user xxx }</code></td><td>If the default password for the <code>proxyro</code> user is retained, this error will not occur. If you manually change the password of the <code>proxyro@sys</code> user in OceanBase Database, make sure that the value of the ODP parameter <code>observer_sys_password</code> is the same as the new password of the <code>proxyro@sys</code> user.</td></tr><tr><td>The configured RootService list is unavailable when ODP is started.</td><td>10018</td><td>fail to check observer version, empty result</td><td>Directly connect to the OBServer node and execute the <code>SHOW PARAMETERS LIKE &#x27;rootservice_list&#x27;;</code> statement to view RootService of OceanBase Database to check whether the configured server IP addresses are available when ODP is started.</td></tr></tbody></table>
<p>The following table describes the disconnection scenarios of OceanBase Database and the corresponding solutions.</p>
<table><thead><tr><th>Scenario</th><th>Error code</th><th>Error message</th><th>Solution</th></tr></thead><tbody><tr><td>The return result of a cluster information query is empty.</td><td>4669</td><td>cluster info is empty</td><td>Directly connect to OceanBase Database and execute an SQL statement. Then, view the <code>internal_sql</code> column in the output to check whether the cluster information returned from OceanBase Database is empty.</td></tr><tr><td>Cluster information query fails.</td><td>10018</td><td>fail to check observer version<br>fail to check cluster info<br>fail to init server state</td><td>Directly connect to OceanBase Database and execute an SQL statement. Then, view the <code>internal_sql</code> column in the output to check whether the cluster information returned from OceanBase Database is empty.</td></tr><tr><td>Information query on the config server fails.</td><td>10301</td><td>fail to fetch root server list from config server<br>fail to fetch root server list from local</td><td>Manually pull the config server URL specified by the <code>obproxy_config_server_url</code> parameter at startup to check whether the information returned by the config server is normal.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="disconnection-upon-timeout">Disconnection upon timeout<a href="#disconnection-upon-timeout" class="hash-link" aria-label="Direct link to Disconnection upon timeout" title="Direct link to Disconnection upon timeout">​</a></h3>
<p>The diagnostic type is <code>TIMEOUT_TRACE</code>. Here is a sample diagnostic log that records a disconnection caused by the timeout of cluster information.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[2023-08-17 17:10:46.834897] [119826][Y0-00007FBF120324E0] [CONNECTION](trace_type=&quot;TIMEOUT_TRACE&quot;, connection_diagnosis={cs_id:1031798785, ss_id:7, proxy_session_id:7230691830869983235, server_session_id:3221504994, client_addr:&quot;10.10.10.1:42468&quot;, server_addr:&quot;10.10.10.1:21100&quot;, cluster_name:&quot;undefined&quot;, tenant_name:&quot;sys&quot;, user_name:&quot;root&quot;, error_code:-10022, error_msg:&quot;OBProxy inactivity timeout&quot;, request_cmd:&quot;COM_SLEEP&quot;, sql_cmd:&quot;COM_END&quot;}{timeout:1, timeout_event:&quot;CLIENT_DELETE_CLUSTER_RESOURCE&quot;, total_time(us):21736})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The additional fields are described as follows:</p>
<ul>
<li>
<p><code>timeout_event</code>: indicates the timeout event.</p>
</li>
<li>
<p><code>total_time</code>: indicates the request execution time.</p>
</li>
</ul>
<p>The following table describes how to resolve disconnections caused by different timeout events.</p>
<table><thead><tr><th>Timeout event</th><th>Scenario</th><th>Error code</th><th>Related parameter</th><th>Solution</th></tr></thead><tbody><tr><td>CLIENT_DELETE_CLUSTER_RESOURCE</td><td>The cluster information is changed.</td><td>10022</td><td>ODP parameter <a href="https://en.oceanbase.com/docs/common-odp-doc-en-10000000001736050" target="_blank" rel="noopener noreferrer">cluster_expire_time</a></td><td>Execute the <code>ALTER proxyconfig SET &lt;var_name&gt; = &lt;var_value&gt;;</code> statement to modify the ODP parameter <code>cluster_expire_time</code> to work around this issue. The default value of <code>cluster_expire_time</code> is 1 day. The modification takes effect for new requests.</td></tr><tr><td>CLIENT_INTERNAL_CMD_TIMEOUT</td><td>The execution of an internal request times out.</td><td>10022</td><td>Fixed value of 30s</td><td>This timeout event is abnormal. We recommend that you contact OceanBase Technical Support for help.</td></tr><tr><td>CLIENT_CONNECT_TIMEOUT</td><td>The connection establishment between the client and ODP times out.</td><td>10022</td><td>Fixed value of 10s</td><td>This timeout event is abnormal. We recommend that you contact OceanBase Technical Support for help.</td></tr><tr><td>CLIENT_NET_READ_TIMEOUT</td><td>A timeout event occurs when ODP waits for requested data.</td><td>10022</td><td>System variable <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001105252" target="_blank" rel="noopener noreferrer">net_read_timeout</a> of OceanBase Database</td><td>Modify the system variable <code>net_read_timeout</code>. Note that the modification of a global system variable does not take effect for existing connections.</td></tr><tr><td>CLIENT_NET_WRITE_TIMEOUT</td><td>A timeout event occurs when ODP waits for a response packet.</td><td>10022</td><td>System variable <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001105358" target="_blank" rel="noopener noreferrer">net_write_timeout</a> of OceanBase Database</td><td>Modify the system variable <code>net_write_timeout</code>. Note that the modification of a global system variable does not take effect for existing connections.</td></tr><tr><td>CLIENT_WAIT_TIMEOUT</td><td>The client connection times out after being left idle for a long period during a user request.</td><td>10022</td><td>System variable <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001105353" target="_blank" rel="noopener noreferrer">wait_timeout</a> of OceanBase Database</td><td>Modify the system variable <code>wait_timeout</code> to work around this issue.</td></tr><tr><td>SERVER_QUERY_TIMEOUT</td><td>A user query request times out.</td><td>10022</td><td>System variable <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001105285" target="_blank" rel="noopener noreferrer">ob_query_timeout</a> of OceanBase Database and <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001108045" target="_blank" rel="noopener noreferrer">query_timeout</a> specified in a hint</td><td>Modify the <code>ob_query_timeout</code> system variable to work around this issue.</td></tr><tr><td>SERVER_TRX_TIMEOUT</td><td>The transaction execution times out.</td><td>10022</td><td>System variable <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001105262" target="_blank" rel="noopener noreferrer">ob_trx_timeout</a> of OceanBase Database</td><td>Modify the <code>ob_trx_timeout</code> system variable to work around this issue.</td></tr><tr><td>SERVER_WAIT_TIMEOUT</td><td>The connection to OceanBase Database times out after being left idle for a long period during a user request.</td><td>10022</td><td>System variable <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001105353" target="_blank" rel="noopener noreferrer">wait_timeout</a> of OceanBase Database</td><td>Modify the <code>wait_timeout</code> system variable to work around this issue.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="disconnection-initiated-by-oceanbase-database">Disconnection initiated by OceanBase Database<a href="#disconnection-initiated-by-oceanbase-database" class="hash-link" aria-label="Direct link to Disconnection initiated by OceanBase Database" title="Direct link to Disconnection initiated by OceanBase Database">​</a></h3>
<p>The diagnostic type is <code>SERVER_VC_TRACE</code>. Here is a sample diagnostic log that records a disconnection when ODP fails to establish a connection with OceanBase Database.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[2023-08-10 23:35:00.132805] [32339][Y0-00007F74C9A244E0] [CONNECTION](trace_type=&quot;SERVER_VC_TRACE&quot;, connection_diagnosis={cs_id:838860809, ss_id:0, proxy_session_id:7230691830869983240, server_session_id:0, client_addr:&quot;10.10.10.1:45765&quot;, server_addr:&quot;&quot;, cluster_name:&quot;undefined&quot;, tenant_name:&quot;sys&quot;, user_name:&quot;root&quot;, error_code:-10013, error_msg:&quot;Fail to build connection to observer&quot;, request_cmd:&quot;COM_QUERY&quot;, sql_cmd:&quot;COM_HANDSHAKE&quot;}{vc_event:&quot;unknown event&quot;, total_time(us):2952626, user_sql:&quot;select 1 from dual&quot;})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The additional fields are described as follows:</p>
<ul>
<li>
<p><code>vc_event</code>: indicates the disconnection event. You do not need to be concerned about this field.</p>
</li>
<li>
<p><code>total_time</code>: indicates the request execution time.</p>
</li>
<li>
<p><code>user_sql</code>: indicates a user request.</p>
</li>
</ul>
<p>The following table describes the scenarios of disconnection actively initiated by OceanBase Database and the corresponding solutions.</p>
<table><thead><tr><th>Scenario</th><th>Error code</th><th>Error message</th><th>Solution</th></tr></thead><tbody><tr><td>ODP fails to establish a connection with OceanBase Database.</td><td>10013</td><td>Fail to build connection to observer</td><td>Perform diagnostics based on relevant logs of OceanBase Database.</td></tr><tr><td>The connection is disconnected when ODP transmits a request to OceanBase Database.</td><td>10016</td><td>An EOS event received while proxy transferring request</td><td>Perform diagnostics based on relevant logs of OceanBase Database.</td></tr><tr><td>The connection is disconnected when ODP transmits the packet returned from OceanBase Database.</td><td>10014</td><td>An EOS event received while proxy reading response</td><td>Perform diagnostics based on relevant logs of OceanBase Database.</td></tr></tbody></table>
<main id="notice" type="explain"><h4>Note</h4><p>When OceanBase Database actively disconnects from ODP, ODP cannot collect detailed information. If the status of the OBServer node configured in ODP is normal, you need to perform diagnostics based on the relevant logs of OceanBase Database. </p></main>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="disconnection-initiated-by-the-client">Disconnection initiated by the client<a href="#disconnection-initiated-by-the-client" class="hash-link" aria-label="Direct link to Disconnection initiated by the client" title="Direct link to Disconnection initiated by the client">​</a></h3>
<p>The diagnostic type is <code>CLIENT_VC_TRACE</code>. Here is a sample diagnostic log that records a disconnection initiated by the client when ODP reads the request.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[2023-08-10 23:28:24.699168] [32339][Y0-00007F74C9A244E0] [CONNECTION](trace_type=&quot;CLIENT_VC_TRACE&quot;, connection_diagnosis={cs_id:838860807, ss_id:26, proxy_session_id:7230691830869983239, server_session_id:3221698209, client_addr:&quot;10.10.10.1:44701&quot;, server_addr:&quot;10.10.10.1:21100&quot;, cluster_name:&quot;undefined&quot;, tenant_name:&quot;sys&quot;, user_name:&quot;root&quot;, error_code:-10010, error_msg:&quot;An EOS event received from client while obproxy reading request&quot;, request_cmd:&quot;COM_SLEEP&quot;, sql_cmd:&quot;COM_END&quot;}{vc_event:&quot;VC_EVENT_EOS&quot;, total_time(us):57637, user_sql:&quot;&quot;})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The additional fields are described as follows:</p>
<ul>
<li>
<p><code>vc_event</code>: indicates the disconnection event. You do not need to concern about this field.</p>
</li>
<li>
<p><code>total_time</code>: indicates the request execution time.</p>
</li>
<li>
<p><code>user_sql</code>: indicates a user request.</p>
</li>
</ul>
<p>The following table describes the scenarios of disconnection actively initiated by the client.</p>
<table><thead><tr><th>Scenario</th><th>Error code</th><th>Error message</th><th>Solution</th></tr></thead><tbody><tr><td>The client actively disconnects from ODP when ODP receives or sends a request.</td><td>10010</td><td>An EOS event received from client while obproxy reading request</td><td>Perform diagnostics based on relevant logs of the client.</td></tr><tr><td>The client actively disconnects from ODP when ODP processes a request.</td><td>10011</td><td>An EOS event received from client while obproxy handling response</td><td>Perform diagnostics based on relevant logs of the client.</td></tr><tr><td>The client actively disconnects from ODP when ODP returns a packet.</td><td>10012</td><td>An EOS event received from client while obproxy transferring response</td><td>Perform diagnostics based on relevant logs of the client.</td></tr></tbody></table>
<main id="notice" type="explain"><h4>Note</h4><p>When the client is disconnected from ODP, ODP cannot collect detailed information and records only the action of the client to actively disconnect from ODP. Active disconnections can be triggered by driver timeout, initiated by middleware such as Druid, HikariCP, and Nginx, or caused by network jitters. You can perform diagnostics based on relevant logs of the client. </p></main>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="disconnection-upon-internal-errors-of-odp-or-oceanbase-database">Disconnection upon internal errors of ODP or OceanBase Database<a href="#disconnection-upon-internal-errors-of-odp-or-oceanbase-database" class="hash-link" aria-label="Direct link to Disconnection upon internal errors of ODP or OceanBase Database" title="Direct link to Disconnection upon internal errors of ODP or OceanBase Database">​</a></h3>
<p>The diagnostic type is <code>PROXY_INTERNAL_TRACE</code> for disconnections caused by internal errors of ODP, and is <code>SERVER_INTERNAL_TRACE</code> for disconnections caused by internal errors of OceanBase Database. Here is a sample diagnostic log that records a disconnection caused by an internal error of ODP.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[2023-08-10 23:26:12.558201] [32339][Y0-00007F74C9A244E0] [CONNECTION](trace_type=&quot;PROXY_INTERNAL_TRACE&quot;, connection_diagnosis={cs_id:838860805, ss_id:0, proxy_session_id:7230691830869983237, server_session_id:0, client_addr:&quot;10.10.10.1:44379&quot;, server_addr:&quot;&quot;, cluster_name:&quot;undefined&quot;, tenant_name:&quot;sys&quot;, user_name:&quot;root&quot;, error_code:-10019, error_msg:&quot;OBProxy reached the maximum number of retrying request&quot;, request_cmd:&quot;COM_QUERY&quot;, sql_cmd:&quot;COM_QUERY&quot;}{user_sql:&quot;USE `ý&lt;8f&gt;ý&lt;91&gt;ý&lt;92&gt;`&quot;})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>user_sql</code> is an additional field that indicates the user request SQL.</p>
<p>The following table describes the scenarios of disconnections caused by internal errors of ODP or OceanBase Database and the corresponding solutions.</p>
<table><thead><tr><th>Diagnostic type</th><th>Scenario</th><th>Error code</th><th>Error message</th><th>Solution</th></tr></thead><tbody><tr><td>PROXY_INTERNAL_TRACE</td><td>The query for tenant partition information fails.</td><td>4664</td><td>dummy entry is empty, disconnect</td><td>This is an unexpected error scenario. You can contact OceanBase Technical Support for help or submit your question in the <a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer">Q&amp;A</a> forum of the OceanBase community.</td></tr><tr><td>PROXY_INTERNAL_TRACE</td><td>The execution of some internal requests of ODP fails.</td><td>10018</td><td>proxy execute internal request failed, received error resp, error_type: xxx</td><td>This is an unexpected error scenario. You can contact OceanBase Technical Support for help or submit your question in the <a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer">Q&amp;A</a> forum of the OceanBase community.</td></tr><tr><td>PROXY_INTERNAL_TRACE</td><td>The number of retries in ODP reaches the upper limit.</td><td>10019</td><td>OBProxy reached the maximum number of retrying request</td><td>This is an unexpected error scenario. You can contact OceanBase Technical Support for help or submit your question in the <a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer">Q&amp;A</a> forum of the OceanBase community.</td></tr><tr><td>PROXY_INTERNAL_TRACE</td><td>The target session is closed in ODP.</td><td>10001</td><td>target session is closed, disconnect</td><td>This is an unexpected error scenario. You can contact OceanBase Technical Support for help or submit your question in the <a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer">Q&amp;A</a> section forum of the OceanBase community.</td></tr><tr><td>PROXY_INTERNAL_TRACE</td><td>Other unexpected error scenarios</td><td>10001</td><td>The diagnostic information is empty.</td><td>This is an unexpected error scenario. You can contact OceanBase Technical Support for help or submit your question in the <a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer">Q&amp;A</a> forum of the OceanBase community.</td></tr><tr><td>SERVER_INTERNAL_TRACE</td><td>A checksum verification error occurs.</td><td>10001</td><td>ora fatal error</td><td>This is an unexpected error scenario. You can contact OceanBase Technical Support for help or submit your question in the <a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer">Q&amp;A</a> forum of the OceanBase community.</td></tr><tr><td>SERVER_INTERNAL_TRACE</td><td>A primary/standby switchover is performed.</td><td>10001</td><td>primary cluster switchover to standby, disconnect</td><td>During a primary/standby switchover, a disconnection is expected.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="other-scenarios">Other scenarios<a href="#other-scenarios" class="hash-link" aria-label="Direct link to Other scenarios" title="Direct link to Other scenarios">​</a></h3>
<p>Besides the preceding scenarios, the following disconnection scenarios are expected and recorded in diagnostic logs. The diagnostic type is <code>PROXY_INTERNAL_TRACE</code>.</p>
<table><thead><tr><th>Scenario</th><th>Error code</th><th>Error message</th><th>Remarks</th></tr></thead><tbody><tr><td>The current session is killed.</td><td>5065</td><td>connection was killed by user self, cs_id: xxx</td><td>This is an expected scenario and is recorded in diagnostic logs.</td></tr><tr><td>Other sessions are killed.</td><td>5065</td><td>connection was killed by user session xxx</td><td>This is an expected scenario and is recorded in diagnostic logs.</td></tr></tbody></table>
<p>Here is a sample diagnostic log. <code>user_sql</code> is an additional field that indicates the user request SQL.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[2023-08-10 23:27:15.107427] [32339][Y0-00007F74CAAE84E0] [CONNECTION](trace_type=&quot;PROXY_INTERNAL_TRACE&quot;, connection_diagnosis={cs_id:838860806, ss_id:21, proxy_session_id:7230691830869983238, server_session_id:3221695443, client_addr:&quot;10.10.10.1:44536&quot;, server_addr:&quot;10.10.10.1:21100&quot;, cluster_name:&quot;undefined&quot;, tenant_name:&quot;sys&quot;, user_name:&quot;&quot;, error_code:-5065, error_msg:&quot;connection was killed by user self, cs_id: 838860806&quot;, request_cmd:&quot;COM_QUERY&quot;, sql_cmd:&quot;COM_QUERY&quot;}{user_sql:&quot;kill 838860806&quot;})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a href="#examples" class="hash-link" aria-label="Direct link to Examples" title="Direct link to Examples">​</a></h2>
<p>The following figure shows the general links of requests initiated by a client to OceanBase Database.</p>
<p><img decoding="async" loading="lazy" alt="Link diagram" src="/assets/images/001-574cceaef5c6bd28fe1730383e8afe5e.png" width="1195" height="260" class="img_ev3q"></p>
<p>A request initiated by a client to OceanBase Database needs to pass multiple nodes. The client connection can be disconnected when an error occurs on any node. Therefore, when a connection is disconnected but the client does not receive any explicit error packet to indicate the cause of the disconnection, identify the node where the disconnection occurs and then find the cause based on the relevant logs on this node. Specifically, perform the following operations:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-identify-the-node-where-the-disconnection-occurs">Step 1: Identify the node where the disconnection occurs<a href="#step-1-identify-the-node-where-the-disconnection-occurs" class="hash-link" aria-label="Direct link to Step 1: Identify the node where the disconnection occurs" title="Direct link to Step 1: Identify the node where the disconnection occurs">​</a></h3>
<p>If the current ODP is capable of connection diagnostics, you can quickly identify the node where the disconnection occurs based on the <code>obproxy_diagnosis.log</code> file. You can quickly find the disconnection log based on information such as the username, tenant name, cluster name, thread ID (corresponding to <code>cs_id</code> in the log file) obtained from the driver, and the time when the disconnection occurred. Then, determine the node where the disconnection occurs based on the <code>trace_type</code> field. Valid values of <code>trace_type</code> are as follows:</p>
<ul>
<li>
<p><code>CLIENT_VC_TRACE</code>: indicates that the disconnection is initiated by the client.</p>
</li>
<li>
<p><code>SERVER_VC_TRACE</code>: indicates that the disconnection is initiated by OceanBase Database.</p>
</li>
<li>
<p><code>SERVER_INTERNAL_TRACE</code>: indicates that the disconnection is caused by an internal error in OceanBase Database.</p>
</li>
<li>
<p><code>PROXY_INTERNAL_TRACE</code>: indicates that the disconnection is caused by an internal error in ODP.</p>
</li>
<li>
<p><code>LOGIN_TRACE</code>: indicates that the disconnection is caused by a login failure.</p>
</li>
<li>
<p><code>TIMEOUT_TRACE</code>: indicates that the disconnection is caused by a timeout.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-identify-the-cause-of-disconnection">Step 2: Identify the cause of disconnection<a href="#step-2-identify-the-cause-of-disconnection" class="hash-link" aria-label="Direct link to Step 2: Identify the cause of disconnection" title="Direct link to Step 2: Identify the cause of disconnection">​</a></h3>
<p>You can identify the cause of the disconnection based on the node where the disconnection occurs.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="disconnection-initiated-by-the-client-1">Disconnection initiated by the client<a href="#disconnection-initiated-by-the-client-1" class="hash-link" aria-label="Direct link to Disconnection initiated by the client" title="Direct link to Disconnection initiated by the client">​</a></h4>
<p>The default value of <code>socketTimeout</code> is <code>0</code> for Java Database Connectivity (JDBC), which indicates that socket timeouts will not occur. However, some clients such as Druid and MyBatis have a socket timeout control parameter. If a disconnection occurs due to a long request execution time, you can first check the value of the socket timeout control parameter. For more information, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001106115" target="_blank" rel="noopener noreferrer">Database connection pool configuration</a> in OceanBase Database documentation.</p>
<ol>
<li>
<p>View basic information about the disconnection in the connection diagnostic logs of ODP.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[2023-09-07 15:59:52.308553] [122701][Y0-00007F7071D194E0] [CONNECTION](trace_type=&quot;CLIENT_VC_TRACE&quot;, connection_diagnosis={cs_id:524328, ss_id:0, proxy_session_id:7230691833961840700, server_session_id:0, client_addr:&quot;10.10.10.1:38877&quot;, server_addr:&quot;10.10.10.2:50110&quot;, cluster_name:&quot;ob1.changluo.cc.10.10.10.2&quot;, tenant_name:&quot;mysql&quot;, user_name:&quot;root&quot;, error_code:-10011, error_msg:&quot;An unexpected connection event received from client while obproxy handling request&quot;, request_cmd:&quot;COM_QUERY&quot;, sql_cmd:&quot;COM_QUERY&quot;}{vc_event:&quot;VC_EVENT_EOS&quot;, total_time(us):5016353, user_sql:&quot;select sleep(20) from dual&quot;})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The fields in the diagnostic information are described as follows:</p>
<ul>
<li>
<p><code>trace_type</code>: the diagnostic type, which is <code>CLIENT_VC_TRACE</code> in this example, indicating that the disconnection is initiated by the client.</p>
</li>
<li>
<p><code>error_msg</code>: the error message, which is <code>An unexpected connection event received from client while obproxy handling request</code> in this example, indicating that the client initiates a disconnection when ODP processes a request.</p>
</li>
<li>
<p><code>total_time</code>: the request execution time, which is <code>5016353</code> in this example, indicating that the total request execution time is about 5s. You can check the timeout value on the client.</p>
</li>
</ul>
</li>
<li>
<p>View the JDBC stack of the client.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">The last packet successfully received from the server was 5,016 milliseconds ago.  The last packet sent successfully to the server was 5,011 milliseconds ago.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.lang.reflect.Constructor.newInstance(Constructor.java:423)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1129)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3720)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3609)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:4160)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2617)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2778)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2819)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2768)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.mysql.jdbc.StatementImpl.execute(StatementImpl.java:949)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.mysql.jdbc.StatementImpl.execute(StatementImpl.java:795)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at odp.Main.main(Main.java:12)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Caused by: java.net.SocketTimeoutException: Read timed out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.net.SocketInputStream.socketRead0(Native Method)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.net.SocketInputStream.read(SocketInputStream.java:170)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at java.net.SocketInputStream.read(SocketInputStream.java:141)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.mysql.jdbc.util.ReadAheadInputStream.fill(ReadAheadInputStream.java:114)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.mysql.jdbc.util.ReadAheadInputStream.readFromUnderlyingStreamIfNecessary(ReadAheadInputStream.java:161)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.mysql.jdbc.util.ReadAheadInputStream.read(ReadAheadInputStream.java:189)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:3163)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3620)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     9 more</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The stack and packet sending and receiving time indicate that the client initiates a disconnection due to socket timeout.</p>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="disconnection-initiated-by-odp">Disconnection initiated by ODP<a href="#disconnection-initiated-by-odp" class="hash-link" aria-label="Direct link to Disconnection initiated by ODP" title="Direct link to Disconnection initiated by ODP">​</a></h4>
<p>ODP reads the <code>net_write_timeout</code> value from OceanBase Database to control the timeout value for packet transmission. The default value is 60s. In the case of extreme network environment conditions or if OceanBase Database does not return a packet after a long period of time, ODP may be disconnected due to a timeout. Here takes the scenario where a timeout occurs when ODP waits for a response packet from OceanBase Database as an example.</p>
<p>Determine the node where the disconnection occurs based on the diagnostic logs of ODP.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[2023-09-08 01:22:17.229436] [81506][Y0-00007F455197E4E0] [CONNECTION](trace_type=&quot;TIMEOUT_TRACE&quot;, connection_diagnosis={cs_id:1031798827, ss_id:342, proxy_session_id:7230691830869983244, server_session_id:3221753829, client_addr:&quot;10.10.10.1:34901&quot;, server_addr:&quot;10.10.10.1:21102&quot;, cluster_name:&quot;undefined&quot;, tenant_name:&quot;mysql&quot;, user_name:&quot;root&quot;, error_code:-10022, error_msg:&quot;OBProxy inactivity timeout&quot;, request_cmd:&quot;COM_QUERY&quot;, sql_cmd:&quot;COM_QUERY&quot;}{timeout(us):6000000, timeout_event:&quot;CLIENT_NET_WRITE_TIMEOUT&quot;, total_time(us):31165295})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The fields in the diagnostic information are described as follows:</p>
<ul>
<li>
<p><code>trace_type</code>: the diagnostic type, which is <code>TIMEOUT_TRACE</code> in this example, indicating that the disconnection occurs due to an execution timeout of ODP.</p>
</li>
<li>
<p><code>timeout_event</code>: the timeout event, which is <code>CLIENT_NET_WRITE_TIMEOUT</code> in this example, indicating that a timeout occurs when ODP waits for a response packet from OceanBase Database.</p>
</li>
</ul>
<p>The diagnostic information indicates that net_write_timeout is triggered. The client connection is disconnected after being left idle for more than 6s (which is not the default value). In this case, you can change the timeout period to a larger value to work around this issue.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="login-failure">Login failure<a href="#login-failure" class="hash-link" aria-label="Direct link to Login failure" title="Direct link to Login failure">​</a></h4>
<p>This section provides two scenarios.</p>
<ul>
<li>
<p>Scenario 1: The OBServer node specified in the RootService list is unavailable. Here is a sample diagnostic log.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[2023-09-08 10:37:21.028960] [90663][Y0-00007F8EB76544E0] [CONNECTION](trace_type=&quot;LOGIN_TRACE&quot;, connection_diagnosis={cs_id:1031798785, ss_id:0, proxy_session_id:0, server_session_id:0, client_addr:&quot;10.10.10.1:44018&quot;, server_addr:&quot;*Not IP address [0]*:0&quot;, cluster_name:&quot;undefined&quot;, tenant_name:&quot;sys&quot;, user_name:&quot;root&quot;, error_code:-10018, error_msg:&quot;fail to check observer version, empty result&quot;, request_cmd:&quot;COM_SLEEP&quot;, sql_cmd:&quot;COM_LOGIN&quot;}{internal_sql:&quot;SELECT ob_version() AS cluster_version&quot;})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The fields in the diagnostic information are described as follows:</p>
<ul>
<li>
<p><code>trace_type</code>: the diagnostic type, which is <code>LOGIN_TRACE</code> in this example, indicating that the disconnection is caused by a login failure.</p>
</li>
<li>
<p><code>internal_sql</code>: the internal request being processed by ODP, which is <code>SELECT ob_version() AS cluster_version</code> in this example, indicating that ODP fails to execute this internal request during login.</p>
</li>
<li>
<p><code>error_msg</code>: the error message, which is <code>fail to check observer version, empty result</code> in this example, indicating that the request execution failure is caused by an empty result set.</p>
</li>
</ul>
<p>To sum up, ODP fails to execute the internal request <code>SELECT ob_version() AS cluster_version</code> because the result set is empty. The SQL statement <code>SELECT ob_version() AS cluster_version</code> is a request for ODP to query the cluster version. ODP executes this request to verify the cluster information when you log in for the first time. If the RootService list configured when ODP is started is incorrect or if the OBServer node breaks down, the query will fail, thereby causing a login failure.</p>
</li>
<li>
<p>Scenario 2: The number of client connections reaches the upper limit of ODP.</p>
<p>You can troubleshoot the issue by using the following methods:</p>
<ul>
<li>
<p>Method 1: Check the connection diagnostic logs.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[2023-09-08 11:19:26.617385] [110562][Y0-00007FE1F06AC4E0] [CONNECTION](trace_type=&quot;LOGIN_TRACE&quot;, connection_diagnosis={cs_id:1031798805, ss_id:0, proxy_session_id:0, server_session_id:0, client_addr:&quot;127.0.0.1:40004&quot;, server_addr:&quot;*Not IP address [0]*:0&quot;, cluster_name:&quot;undefined&quot;, tenant_name:&quot;sys&quot;, user_name:&quot;root&quot;, error_code:-5059, error_msg:&quot;Too many sessions&quot;, request_cmd:&quot;COM_SLEEP&quot;, sql_cmd:&quot;COM_LOGIN&quot;}{internal_sql:&quot;&quot;})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The fields in the diagnostic information are described as follows:</p>
<ul>
<li>
<p><code>trace_type</code>: the diagnostic type, which is <code>LOGIN_TRACE</code> in this example, indicating that the disconnection is caused by a login failure.</p>
</li>
<li>
<p><code>error_msg</code>: the error message, which is <code>Too many session</code> in this example, indicating that the login fails because the number of connections reaches the upper limit.</p>
</li>
</ul>
</li>
<li>
<p>Method 2: Check the error message. The error message <code>Too many sessions</code> is returned when you run a connection command.</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ obclient -h127.0.0.1 -P2899 -uroot@sys -Dtest -A -c </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ERROR 1203 (42000): Too many sessions</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/oceanbase/oceanbase.github.io/tree/main/docs/user_manual/operation_and_maintenance/en-US/tool_emergency_handbook/odp_troubleshooting_guide/03_connection_diagnosis.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/user_manual/operation_and_maintenance/en-US/tool_emergency_handbook/odp_troubleshooting_guide/show_trace"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Check Whether ODP Causes a Performance Bottleneck</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/user_manual/operation_and_maintenance/en-US/tool_emergency_handbook/odp_troubleshooting_guide/routing_diagnosis"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Troubleshoot ODP Routing Issues</div></a></nav><div>Loading...</div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#troubleshooting-procedure" class="table-of-contents__link toc-highlight">Troubleshooting Procedure</a></li><li><a href="#general-disconnection-scenarios" class="table-of-contents__link toc-highlight">General Disconnection Scenarios</a><ul><li><a href="#disconnection-upon-a-login-failure" class="table-of-contents__link toc-highlight">Disconnection upon a login failure</a></li><li><a href="#disconnection-upon-timeout" class="table-of-contents__link toc-highlight">Disconnection upon timeout</a></li><li><a href="#disconnection-initiated-by-oceanbase-database" class="table-of-contents__link toc-highlight">Disconnection initiated by OceanBase Database</a></li><li><a href="#disconnection-initiated-by-the-client" class="table-of-contents__link toc-highlight">Disconnection initiated by the client</a></li><li><a href="#disconnection-upon-internal-errors-of-odp-or-oceanbase-database" class="table-of-contents__link toc-highlight">Disconnection upon internal errors of ODP or OceanBase Database</a></li><li><a href="#other-scenarios" class="table-of-contents__link toc-highlight">Other scenarios</a></li></ul></li><li><a href="#examples" class="table-of-contents__link toc-highlight">Examples</a><ul><li><a href="#step-1-identify-the-node-where-the-disconnection-occurs" class="table-of-contents__link toc-highlight">Step 1: Identify the node where the disconnection occurs</a></li><li><a href="#step-2-identify-the-cause-of-disconnection" class="table-of-contents__link toc-highlight">Step 2: Identify the cause of disconnection</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="http://github.com/oceanbase/oceanbase/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussion<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://join.slack.com/t/oceanbase/shared_invite/zt-1e25oz3ol-lJ6YNqPHaKwY_mhhioyEuw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/oceanbase" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum (in Chinese)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">SIG</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/sig/AI/sig_intro">AI</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/cloud-native/sig_intro">cloud-native</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/compilation/sig_intro">compilation</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/develop-tools/sig_intro">develop-tools</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/miniob/sig_intro">MiniOB</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/obdiag/sig_intro">obdiag</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/operation/sig_intro">operation</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://en.oceanbase.com/about" target="_blank" rel="noopener noreferrer" class="footer__link-item">About OceanBase<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/blogs/arch/all-in-one">Blogs</a></li><li class="footer__item"><a href="https://github.com/oceanbase/oceanbase" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 OceanBase, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>