<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-user_manual/operation_and_maintenance/en-US/emergency_handbook/disk_capacity_problem" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">Full Log/Data Disk | OceanBase</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://oceanbase.github.io/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/disk_capacity_problem"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Full Log/Data Disk | OceanBase"><meta data-rh="true" name="description" content="Business and Database Symptoms"><meta data-rh="true" property="og:description" content="Business and Database Symptoms"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://oceanbase.github.io/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/disk_capacity_problem"><link data-rh="true" rel="alternate" href="https://oceanbase.github.io/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/disk_capacity_problem" hreflang="en"><link data-rh="true" rel="alternate" href="https://oceanbase.github.io/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/disk_capacity_problem" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://6JQM9QDU5V-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-H4XM2M50RX"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-H4XM2M50RX",{})</script><link rel="stylesheet" href="/assets/css/styles.7e3a93fe.css">
<script src="/assets/js/runtime~main.a50e5b58.js" defer="defer"></script>
<script src="/assets/js/main.589ef4b9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="OceanBase Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="OceanBase Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">OceanBase</b></a><a class="navbar__item navbar__link" href="/docs/blogs/arch/all-in-one">Blogs</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Docs</a><ul class="dropdown__menu"><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">Product Docs</a><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">User Manual</a><a class="sub-dropdown dropdown__link dropdown--hoverable" style="cursor:pointer">Developer Manual</a></ul><ul class="dropdown__menu" style="left:160px;display:none"></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><span><li><a class="dropdown__link" href="/docs/sig/overview/list">Special Interest Group(SIG)</a></li></span><span><li><a class="dropdown__link" href="/docs/honor/overview">Community Honors</a></li></span><span><li><a href="http://github.com/oceanbase/oceanbase/discussions" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub Discussion<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://discord.gg/74cF8vbNEs" target="_blank" rel="noopener noreferrer" class="dropdown__link">Discord<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Forum (in Chinese)<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://stackoverflow.com/questions/tagged/oceanbase" target="_blank" rel="noopener noreferrer" class="dropdown__link">Stack Overflow<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span></ul><ul class="dropdown__menu" style="left:160px;display:none"></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Data + AI</a><ul class="dropdown__menu"><span><li><a href="https://oceanbase-devhub.github.io" target="_blank" rel="noopener noreferrer" class="dropdown__link">AI Workshops<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://oceanbase-devhub.github.io/ai-workshop-2024" target="_blank" rel="noopener noreferrer" class="dropdown__link">RAG Bot<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://oceanbase-devhub.github.io/dify/dify@oceanbase-workshop" target="_blank" rel="noopener noreferrer" class="dropdown__link">Dify (MySQL Compatible)<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span><span><li><a href="https://oceanbase-devhub.github.io/DB-GPT/docker/compose_examples/ob_dbgpt_tutorial" target="_blank" rel="noopener noreferrer" class="dropdown__link">DB-GPT<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></span></ul><ul class="dropdown__menu" style="left:160px;display:none"></ul></div><a href="https://en.oceanbase.com/softwarecenter" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Downloads<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/oceanbase" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/operation_and_maintenance/en-US/about_this_manual/overview">About &quot;DBA Advanced Tutorial&quot;</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/operation_and_maintenance/en-US/disaster_recovery_architecture_design/high_availability_architecture_overview">Disaster Recovery Architecture Design</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/operation_and_maintenance/en-US/operations_and_maintenance/version_upgrade_path">Operation and Maintenance Management</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/operation_and_maintenance/en-US/scenario_best_practices/parameter_templates">Best Practice Scenarios</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/operation_and_maintenance/en-US/development_specification/object_specification">Development Specification</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/emergency_overview">OBServer Emergency Handbook</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/emergency_overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/slow_response">Slow Response</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/cpu_high">High CPU Load</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/node_breakdown">Node Failures</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/network_problem">Network Jitter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/disk_problem">Disk Issues</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/disk_capacity_problem">Full Log/Data Disk</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/how_to_ask">Unexpected Errors</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/user_manual/operation_and_maintenance/en-US/tool_emergency_handbook/oms_troubleshooting_guide">Community Tools Troubleshooting Guide</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">OBServer Emergency Handbook</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Full Log/Data Disk</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Full Log/Data Disk</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="business-and-database-symptoms">Business and Database Symptoms<a href="#business-and-database-symptoms" class="hash-link" aria-label="Direct link to Business and Database Symptoms" title="Direct link to Business and Database Symptoms">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="full-data-disk">Full data disk<a href="#full-data-disk" class="hash-link" aria-label="Direct link to Full data disk" title="Direct link to Full data disk">​</a></h3>
<p>OceanBase Cloud Platform (OCP) reports a data disk alert, such as the alert for <a href="https://en.oceanbase.com/docs/common-ocp-10000000001899685" target="_blank" rel="noopener noreferrer">ob_host_data_path_disk_percent</a>.</p>
<p>The business application reports an error. OBServer nodes may fail to perform minor compactions, major compactions, or memory release, resulting in a failure to write data to the cluster.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="full-log-disk">Full log disk<a href="#full-log-disk" class="hash-link" aria-label="Direct link to Full log disk" title="Direct link to Full log disk">​</a></h3>
<p>OCP reports a log disk alert, such as <a href="https://en.oceanbase.com/docs/common-ocp-10000000001899703" target="_blank" rel="noopener noreferrer">ob_host_log_disk_percent_over_threshold</a>.</p>
<p>The business application reports an error. OBServer nodes may not function properly, affecting the election process.</p>
<blockquote>
<p>The methods described in the preceding topics are applicable when other programs generate a large amount of data in the log disk or data disk of an OBServer node. Do not manually delete log files or data files on OBServer nodes. Otherwise, the system may fail to be restored.</p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-approach">Troubleshooting Approach<a href="#troubleshooting-approach" class="hash-link" aria-label="Direct link to Troubleshooting Approach" title="Direct link to Troubleshooting Approach">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="full-data-disk-1">Full data disk<a href="#full-data-disk-1" class="hash-link" aria-label="Direct link to Full data disk" title="Direct link to Full data disk">​</a></h3>
<p>Connect to the <code>oceanbase</code> database through the sys tenant and query information about the data disk usage of each node in the cluster, including the total allocated size, occupied size, and remaining size.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">SELECT b.zone, a.svr_ip, a.svr_port,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ROUND(a.total_size/1024/1024/1024,3) total_size_GB,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ROUND((a.total_size-a.free_size)/1024/1024/1024,3) used_size_GB,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ROUND(a.free_size/1024/1024/1024,3) free_size_GB,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ROUND((a.total_size-a.free_size)/total_size,2)*100 disk_used_percentage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM oceanbase.__all_virtual_disk_stat a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INNER JOIN oceanbase.__all_server b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ON a.svr_ip=b.svr_ip AND a.svr_port=b.svr_port</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ORDER BY zone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*************************** 1. row ***************************</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                zone: zone1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              svr_ip: 1.2.3.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            svr_port: 22602</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       total_size_GB: 8.000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        used_size_GB: 0.307</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        free_size_GB: 7.693</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">disk_used_percentage: 4.00</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If the <code>disk_used_percentage</code> value exceeds the default alert threshold, which is 97%, the alert reported by OCP is valid.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="full-log-disk-1">Full log disk<a href="#full-log-disk-1" class="hash-link" aria-label="Direct link to Full log disk" title="Direct link to Full log disk">​</a></h3>
<blockquote>
<p>The issue of a full log disk rarely occurs because expired logs are recycled.</p>
</blockquote>
<p>Check whether the alert reported by OCP is valid on the affected node. The cluster and host information for the node can be found in the alert.</p>
<p>Log in to the sys tenant and connect to the <code>oceanbase</code> database. Run the following command to check whether the log disk usage in a tenant exceeds the threshold.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select a.svr_ip,a.svr_port,a.tenant_id,b.tenant_name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CAST(a.data_disk_in_use/1024/1024/1024 as DECIMAL(15,2)) data_disk_use_G, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CAST(a.log_disk_size/1024/1024/1024 as DECIMAL(15,2)) log_disk_size, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CAST(a.log_disk_in_use/1024/1024/1024 as DECIMAL(15,2)) log_disk_use_G,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log_disk_in_use/log_disk_size &#x27;usage%&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from oceanbase.__all_virtual_unit a,dba_ob_tenants b </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">where a.tenant_id=b.tenant_id\G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*************************** 1. row ***************************</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         svr_ip: 1.2.3.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       svr_port: 22602</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      tenant_id: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tenant_name: sys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_disk_use_G: 0.10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  log_disk_size: 2.00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> log_disk_use_G: 1.54</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         usage%: 0.7693</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*************************** 2. row ***************************</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         svr_ip: 1.2.3.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       svr_port: 22602</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      tenant_id: 1001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tenant_name: META$1002</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_disk_use_G: 0.07</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  log_disk_size: 0.60</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> log_disk_use_G: 0.43</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         usage%: 0.7174</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*************************** 3. row ***************************</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         svr_ip: 1.2.3.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       svr_port: 22602</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      tenant_id: 1002</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tenant_name: mysql</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_disk_use_G: 0.05</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  log_disk_size: 5.40</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> log_disk_use_G: 3.13</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         usage%: 0.5789</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting-procedure">Troubleshooting Procedure<a href="#troubleshooting-procedure" class="hash-link" aria-label="Direct link to Troubleshooting Procedure" title="Direct link to Troubleshooting Procedure">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="full-data-disk-2">Full data disk<a href="#full-data-disk-2" class="hash-link" aria-label="Direct link to Full data disk" title="Direct link to Full data disk">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="check-whether-the-operating-system-disk-that-stores-data-files-has-enough-remaining-capacity-for-allocation">Check whether the operating system disk that stores data files has enough remaining capacity for allocation.<a href="#check-whether-the-operating-system-disk-that-stores-data-files-has-enough-remaining-capacity-for-allocation" class="hash-link" aria-label="Direct link to Check whether the operating system disk that stores data files has enough remaining capacity for allocation." title="Direct link to Check whether the operating system disk that stores data files has enough remaining capacity for allocation.">​</a></h4>
<p>If so, modify the cluster-level parameter <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001715485" target="_blank" rel="noopener noreferrer">datafile_size</a> or <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001715434" target="_blank" rel="noopener noreferrer">datafile_disk_percentage</a> to increase the available capacity of the data disk for the database.</p>
<p>Run the following commands to check the values of the <code>datafile_size</code> and <code>datafile_disk_percentage</code> parameters:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">show parameters like &#x27;datafile_size&#x27;\G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*************************** 1. row ***************************</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         zone: zone1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     svr_type: observer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       svr_ip: 1.2.3.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     svr_port: 22602</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         name: datafile_size</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data_type: CAPACITY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        value: 2G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         info: size of the data file. Range: [0, +∞)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      section: SSTABLE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        scope: CLUSTER</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       source: DEFAULT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   edit_level: DYNAMIC_EFFECTIVE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_value: 0M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    isdefault: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 row in set (0.006 sec)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The default value of the <code>datafile_size</code> parameter is <code>0M</code>. If the default value is used, the available capacity of the data disk is controlled by the <code>datafile_disk_percentage</code> parameter.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">show parameters like &#x27;datafile_disk_percentage&#x27;\G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*************************** 1. row ***************************</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         zone: zone1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     svr_type: observer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       svr_ip: 11.158.31.20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     svr_port: 22602</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         name: datafile_disk_percentage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data_type: INT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        value: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         info: the percentage of disk space used by the data files. Range: [0,99] in integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      section: SSTABLE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        scope: CLUSTER</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       source: DEFAULT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   edit_level: DYNAMIC_EFFECTIVE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_value: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    isdefault: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 row in set (0.006 sec)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The default value of the <code>datafile_disk_percentage</code> parameter is <code>0</code>. If the default value is used, the system automatically calculates the percentage of the total disk space occupied by the data file in Shared-Nothing (SN) mode or local cache in Shared-Storage (SS) mode based on whether the logs and data share the same disk.</p>
<ul>
<li>If the same disk is shared, the percentage of the total disk space occupied by data files or local cache is 60%.</li>
<li>If the disk is not shared, the percentage of the total disk space occupied by data files or local cache is 90%.
If this parameter and the <code>datafile_size</code> parameter are both specified, the value of the <code>datafile_size</code> parameter prevails.</li>
</ul>
<p>Run the following commands to set the parameters to greater values:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-- Set the size of the data file to 80 GB.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">obclient&gt; ALTER SYSTEM SET datafile_size = &#x27;80G&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-- Alternatively, set the percentage of the total disk space occupied by the data file to 95%.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">obclient&gt; ALTER SYSTEM SET datafile_disk_percentage = 90;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong><font color="red">OceanBase Database supports auto scale-out of disk space available for data files based on the actual situation. We recommend that you set the <code>datafile_next</code> and <code>datafile_maxsize</code> parameters for auto scale-out when you deploy a cluster. For more information, see <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001714935" target="_blank" rel="noopener noreferrer">Configure automatic scale-out of disk space for data files</a>. </font></strong></p>
<p><strong><font color="red">In a production environment, we recommend that the size of the log disk be at least three times the memory size of the host. To avoid I/O performance issues, we recommend that you mount the data directory and the log directory to different disks. </font></strong></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="if-the-system-disk-has-no-remaining-capacity-for-allocation-add-nodes-to-the-zone-and-migrate-resource-units-to-evenly-distribute-data-across-nodes">If the system disk has no remaining capacity for allocation, add nodes to the zone and migrate resource units to evenly distribute data across nodes.<a href="#if-the-system-disk-has-no-remaining-capacity-for-allocation-add-nodes-to-the-zone-and-migrate-resource-units-to-evenly-distribute-data-across-nodes" class="hash-link" aria-label="Direct link to If the system disk has no remaining capacity for allocation, add nodes to the zone and migrate resource units to evenly distribute data across nodes." title="Direct link to If the system disk has no remaining capacity for allocation, add nodes to the zone and migrate resource units to evenly distribute data across nodes.">​</a></h4>
<p>You can perform GUI-based operations in OCP to add nodes to the zone and migrate resource units. For more information, see <a href="https://en.oceanbase.com/docs/common-ocp-10000000001899145" target="_blank" rel="noopener noreferrer">Migrate a resource unit from an OceanBase Database tenant</a>.</p>
<p>If an OBServer node hosts resource units of multiple tenants, migrate the resource units to evenly distribute data across nodes.</p>
<p>If an OBServer node hosts only one user tenant, purge the recycle bin to delete redundant data.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="full-log-disk-2">Full log disk<a href="#full-log-disk-2" class="hash-link" aria-label="Direct link to Full log disk" title="Direct link to Full log disk">​</a></h3>
<p>Check whether the log disk of the cluster has remaining capacity for allocation. If the value of the <code>log_disk_free</code> parameter is 0, the log disk has no remaining capacity for allocation.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select zone,concat(SVR_IP,&#x27;:&#x27;,SVR_PORT) observer,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cpu_capacity_max cpu_total,cpu_assigned_max cpu_assigned,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cpu_capacity-cpu_assigned_max as cpu_free,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    round(memory_limit/1024/1024/1024,2) as memory_total,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    round((memory_limit-mem_capacity)/1024/1024/1024,2) as system_memory,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    round(mem_assigned/1024/1024/1024,2) as mem_assigned,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    round((mem_capacity-mem_assigned)/1024/1024/1024,2) as memory_free,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    round(log_disk_capacity/1024/1024/1024,2) as log_disk_capacity,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    round(log_disk_assigned/1024/1024/1024,2) as log_disk_assigned,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    round((log_disk_capacity-log_disk_assigned)/1024/1024/1024,2) as log_disk_free,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    round((data_disk_capacity/1024/1024/1024),2) as data_disk,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    round((data_disk_in_use/1024/1024/1024),2) as data_disk_used,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    round((data_disk_capacity-data_disk_in_use)/1024/1024/1024,2) as data_disk_free</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from gv$ob_servers\G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*************************** 1. row ***************************</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             zone: zone1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         observer: 11.158.31.20:22602</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cpu_total: 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     cpu_assigned: 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         cpu_free: 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     memory_total: 8.00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    system_memory: 1.00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     mem_assigned: 3.00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      memory_free: 4.00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log_disk_capacity: 21.00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log_disk_assigned: 8.00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log_disk_free: 13.00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        data_disk: 8.00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   data_disk_used: 0.27</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   data_disk_free: 7.73</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1 row in set (0.006 sec)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If the value of the <code>log_disk_free</code> parameter is not 0, the log disk has remaining capacity for allocation. In this case, you can set the log disk size to a greater value for the resource unit of the tenant.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ALTER RESOURCE UNIT unit_name LOG_DISK_SIZE = &#x27;10G&#x27;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If the value of the <code>log_disk_free</code> parameter is 0, the log disk space allocated to the cluster is used up. You can run the <code>df -h</code> command to check whether all the capacity of the disk to which the log directory of the node is mounted is allocated to the log directory.</p>
<p>If the disk has remaining capacity for allocation, you can modify the cluster-level parameter <a href="log_disk_https://en.oceanbase.com/docs/common-oceanbase-database-10000000001715277" target="_blank" rel="noopener noreferrer">log_disk_size</a> or <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001715452" target="_blank" rel="noopener noreferrer">log_disk_percentage</a> to increase the log disk size available for the cluster. Then, run the <code>ALTER RESOURCE UNIT</code> command to increase the log disk size available for the tenant.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ALTER system SET log_disk_size = &#x27;40G&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ALTER system SET log_disk_percentage = 90;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If the operating system disk has no remaining capacity for allocation, stop the write operations to the abnormal tenant. Otherwise, the space temporarily released from the clog disk can be quickly used up again. At the same time, modify the <a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001715555" target="_blank" rel="noopener noreferrer">log_disk_utilization_limit_threshold</a> parameter to increase the threshold of the clog disk usage from 95% to 98%.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ALTER system SET log_disk_utilization_limit_threshold = 98;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Wait a period of time until clogs have been synchronized. The capacity is then automatically recycled by the database system and the cluster can be automatically restored.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="references">References<a href="#references" class="hash-link" aria-label="Direct link to References" title="Direct link to References">​</a></h2>
<ul>
<li>
<p><a href="https://open.oceanbase.com/blog/13250502949" target="_blank" rel="noopener noreferrer">Quick Fixes for OceanBase Issues</a></p>
</li>
<li>
<p><a href="https://en.oceanbase.com/docs/common-oceanbase-database-10000000001714619" target="_blank" rel="noopener noreferrer">Emergency response</a></p>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/oceanbase/oceanbase.github.io/tree/main/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/07_disk_capacity_problem.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/disk_problem"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Disk Issues</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/how_to_ask"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Unexpected Errors</div></a></nav><div>Loading...</div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#business-and-database-symptoms" class="table-of-contents__link toc-highlight">Business and Database Symptoms</a><ul><li><a href="#full-data-disk" class="table-of-contents__link toc-highlight">Full data disk</a></li><li><a href="#full-log-disk" class="table-of-contents__link toc-highlight">Full log disk</a></li></ul></li><li><a href="#troubleshooting-approach" class="table-of-contents__link toc-highlight">Troubleshooting Approach</a><ul><li><a href="#full-data-disk-1" class="table-of-contents__link toc-highlight">Full data disk</a></li><li><a href="#full-log-disk-1" class="table-of-contents__link toc-highlight">Full log disk</a></li></ul></li><li><a href="#troubleshooting-procedure" class="table-of-contents__link toc-highlight">Troubleshooting Procedure</a><ul><li><a href="#full-data-disk-2" class="table-of-contents__link toc-highlight">Full data disk</a></li><li><a href="#full-log-disk-2" class="table-of-contents__link toc-highlight">Full log disk</a></li></ul></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="http://github.com/oceanbase/oceanbase/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussion<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://join.slack.com/t/oceanbase/shared_invite/zt-1e25oz3ol-lJ6YNqPHaKwY_mhhioyEuw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/oceanbase" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ask.oceanbase.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum (in Chinese)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">SIG</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/sig/AI/sig_intro">AI</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/cloud-native/sig_intro">cloud-native</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/compilation/sig_intro">compilation</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/develop-tools/sig_intro">develop-tools</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/miniob/sig_intro">MiniOB</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/obdiag/sig_intro">obdiag</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/sig/operation/sig_intro">operation</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://en.oceanbase.com/about" target="_blank" rel="noopener noreferrer" class="footer__link-item">About OceanBase<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/blogs/arch/all-in-one">Blogs</a></li><li class="footer__item"><a href="https://github.com/oceanbase/oceanbase" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 OceanBase, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>