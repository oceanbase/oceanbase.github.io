"use strict";(self.webpackChunkmy_docs_website=self.webpackChunkmy_docs_website||[]).push([[6275],{81294:(e,s,r)=>{r.r(s),r.d(s,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>d});var n=r(74848),i=r(28453);const a={slug:"Hybrid-Storage-Deploy",title:"Breaking Resource Limits: OceanBase Database Hybrid Storage Deployment and Real-world Applications",tags:["User Case"]},t="Breaking Resource Limits: OceanBase Database Hybrid Storage Deployment and Real-world Applications",o={id:"blogs/users/Hybrid-Storage-Deploy",title:"Breaking Resource Limits: OceanBase Database Hybrid Storage Deployment and Real-world Applications",description:"In most production environments, OceanBase clusters are typically deployed on SSD storage. The high compression ratio of OceanBase Database significantly reduces disk storage requirements. However, in scenarios involving massive historical archives, companies still face challenges such as insufficient storage and waste of computing resources. This article explores the feasibility of a hybrid storage configuration, where transaction logs (or clogs) are stored on SSDs and business data is stored on HDDs. Through an exhaustive verification process, we evaluate the performance degradation and stability of the hybrid configuration compared to an all-flash configuration across different specifications and scenarios. By incorporating real-world use cases in production environments, this article serves as a reference for deploying OceanBase Database in scenarios involving massive data. While ensuring business stability and performance, the hybrid configuration can significantly reduce hardware resource usage, address shortages in flash resources, and make better use of existing resources.",source:"@site/docs/blogs/users/Hybrid-Storage-Deploy.md",sourceDirName:"blogs/users",slug:"/blogs/users/Hybrid-Storage-Deploy",permalink:"/docs/blogs/users/Hybrid-Storage-Deploy",draft:!1,unlisted:!1,editUrl:"https://github.com/oceanbase/oceanbase.github.io/tree/main/docs/blogs/users/Hybrid-Storage-Deploy.md",tags:[{inline:!0,label:"User Case",permalink:"/docs/tags/user-case"}],version:"current",frontMatter:{slug:"Hybrid-Storage-Deploy",title:"Breaking Resource Limits: OceanBase Database Hybrid Storage Deployment and Real-world Applications",tags:["User Case"]},sidebar:"blogsSidebar",previous:{title:'OceanBase Is Named an "Honorable Mention" Again in the Report *Magic Quadrant\u2122 for Cloud Database Management Systems* Released by Gartner',permalink:"/docs/blogs/users/Gartner"},next:{title:"Handling over 10 million daily API calls with an ultra-low query latency: A real-time analytical solution of KYE based on Flink and OceanBase",permalink:"/docs/blogs/users/KYE"}},c={},d=[{value:"<strong>Background</strong>",id:"background",level:2},{value:"<strong>Scenario 1: batch writes</strong>",id:"scenario-1-batch-writes",level:3},{value:"<strong>Scenario 2: regular writes</strong>",id:"scenario-2-regular-writes",level:3},{value:"<strong>Scenario 3: regular read-only</strong>",id:"scenario-3-regular-read-only",level:3},{value:"<strong>Scenario 4: regular reads/writes</strong>",id:"scenario-4-regular-readswrites",level:3},{value:"<strong>Scenario 5: TPC-C benchmark on TP performance</strong>",id:"scenario-5-tpc-c-benchmark-on-tp-performance",level:3},{value:"<strong>Scenario 6: stability testing</strong>",id:"scenario-6-stability-testing",level:3},{value:"<strong>Summary</strong>",id:"summary",level:2}];function l(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.header,{children:(0,n.jsx)(s.h1,{id:"breaking-resource-limits-oceanbase-database-hybrid-storage-deployment-and-real-world-applications",children:"Breaking Resource Limits: OceanBase Database Hybrid Storage Deployment and Real-world Applications"})}),"\n",(0,n.jsx)(s.p,{children:"In most production environments, OceanBase clusters are typically deployed on SSD storage. The high compression ratio of OceanBase Database significantly reduces disk storage requirements. However, in scenarios involving massive historical archives, companies still face challenges such as insufficient storage and waste of computing resources. This article explores the feasibility of a hybrid storage configuration, where transaction logs (or clogs) are stored on SSDs and business data is stored on HDDs. Through an exhaustive verification process, we evaluate the performance degradation and stability of the hybrid configuration compared to an all-flash configuration across different specifications and scenarios. By incorporating real-world use cases in production environments, this article serves as a reference for deploying OceanBase Database in scenarios involving massive data. While ensuring business stability and performance, the hybrid configuration can significantly reduce hardware resource usage, address shortages in flash resources, and make better use of existing resources."}),"\n",(0,n.jsx)(s.h2,{id:"background",children:(0,n.jsx)(s.strong,{children:"Background"})}),"\n",(0,n.jsx)(s.p,{children:'The storage engine of OceanBase Database, built on the log-structured merge-tree (LSM-tree) structure, stores static baseline data on disks and dynamic incremental data in memory. When the incremental data in memory reaches the specified threshold, it is flushed to disks (a process called "minor compaction"). During off-peak hours at night, the system automatically merges incremental baseline data with existing baseline data (a process called "major compaction"). Handling incremental data in this quasi-memory approach greatly enhances the performance of INSERT, UPDATE, and DELETE operations. In addition, OceanBase Database applies aggressive compression algorithms on the baseline data, which is read-only. This ensures a high compression ratio without affecting the query performance. To ensure data persistence, redo logs are written to disks and synchronized to follower replicas while incremental data is written to memory. A transaction is considered successful only when the majority of replicas have successfully persisted the redo logs. Both minor and major compactions involve intensive disk I/O operations. To maintain high database performance, OceanBase officially recommends deploying clusters on SSD storage.'}),"\n",(0,n.jsxs)(s.p,{children:["From our perspective, SSDs are primarily used to boost performance. However, since some applications have lower performance requirements, we also deployed some clusters on HDDs. Over time, we encountered issues such as clog desynchronization, cluster instability, and even cluster failures. As a result, we promptly replaced these HDDs with SSDs. Nevertheless, we continued exploring the feasibility of deploying OceanBase clusters on HDDs. After reading the article ",(0,n.jsx)(s.a,{href:"https://open.oceanbase.com/blog/12198675456",children:"Can We Have Both Cost-effectiveness and Performance for History Databases?"})," posted by the OceanBase official team, we learned that deploying OceanBase clusters on HDDs is indeed feasible. We reached out to the author for specific use cases and deployment methods. We learned that using SSDs for transaction logs (which require high real-time performance) and HDDs for business data is a viable approach. As a result, we proceeded to verify the hybrid storage configuration. Here are the details."]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Note"})}),"\n",(0,n.jsx)(s.p,{children:"In this verification, the performance of all-flash and hybrid configurations is compared."}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{children:"All-flash configuration: All disks are SSDs.\n\nHybrid configuration: Transaction logs are stored on NVMe SSDs, while business data on HDDs.\n\nDatabase version: OceanBase Database V4.2.1.1\n\nResources:\n\nAll-flash configuration:\n\nKirin ARM servers \xd7 3, each equipped with ARM-based Kirin CPUs (32 cores \xd7 2), 512 GB memory, and 960 GB SATA SSD \xd7 12\n\nHybrid configuration:\n\nKirin ARM servers \xd7 3, each equipped with ARM-based Kirin CPUs (32 cores \xd7 2), 512 GB memory, 1.8 TB NVMe SSD \xd7 2, and 8 TB SATA HDD \xd7 12\n"})}),"\n",(0,n.jsx)(s.h3,{id:"scenario-1-batch-writes",children:(0,n.jsx)(s.strong,{children:"Scenario 1: batch writes"})}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{}),(0,n.jsx)(s.th,{children:"All-flash"}),(0,n.jsx)(s.th,{children:"Hybrid"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"8C16GB"}),(0,n.jsx)(s.td,{children:"54903"}),(0,n.jsx)(s.td,{children:"38622"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"16C32GB"}),(0,n.jsx)(s.td,{children:"85870"}),(0,n.jsx)(s.td,{children:"61772"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"32C64GB"}),(0,n.jsx)(s.td,{children:"178158"}),(0,n.jsx)(s.td,{children:"121918"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"64C128GB"}),(0,n.jsx)(s.td,{children:"221443"}),(0,n.jsx)(s.td,{children:"164340"})]})]})]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"1732082836",src:r(96258).A+"",width:"602",height:"333"})}),"\n",(0,n.jsx)(s.p,{children:"Conclusion: In the batch write scenario, performance increases linearly with specifications. However, after reaching the specification of 32 CPU cores and 64 GB of memory (32C64GB), performance improvement slows. The hybrid configuration shows a 29% performance drop compared to the all-flash configuration."}),"\n",(0,n.jsx)(s.h3,{id:"scenario-2-regular-writes",children:(0,n.jsx)(s.strong,{children:"Scenario 2: regular writes"})}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{}),(0,n.jsx)(s.th,{children:"All-flash"}),(0,n.jsx)(s.th,{children:"Hybrid"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"8C16GB"}),(0,n.jsx)(s.td,{children:"24490"}),(0,n.jsx)(s.td,{children:"20513"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"16C32GB"}),(0,n.jsx)(s.td,{children:"48079"}),(0,n.jsx)(s.td,{children:"40768"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"32C64GB"}),(0,n.jsx)(s.td,{children:"87440"}),(0,n.jsx)(s.td,{children:"56511"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"64C128GB"}),(0,n.jsx)(s.td,{children:"91702"}),(0,n.jsx)(s.td,{children:"56352"})]})]})]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"1732082862",src:r(68884).A+"",width:"602",height:"333"})}),"\n",(0,n.jsx)(s.p,{children:"Conclusion: In the regular write scenario, performance increases linearly with specifications. However, after reaching the 32C64GB specification, performance improvement slows. The hybrid configuration shows a 26% performance drop compared to the all-flash configuration."}),"\n",(0,n.jsx)(s.h3,{id:"scenario-3-regular-read-only",children:(0,n.jsx)(s.strong,{children:"Scenario 3: regular read-only"})}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{}),(0,n.jsx)(s.th,{children:"All-flash"}),(0,n.jsx)(s.th,{children:"Hybrid"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"8C16GB"}),(0,n.jsx)(s.td,{children:"57283"}),(0,n.jsx)(s.td,{children:"53010"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"16C32GB"}),(0,n.jsx)(s.td,{children:"106498"}),(0,n.jsx)(s.td,{children:"96702"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"32C64GB"}),(0,n.jsx)(s.td,{children:"173308"}),(0,n.jsx)(s.td,{children:"166397"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"64C128GB"}),(0,n.jsx)(s.td,{children:"198595"}),(0,n.jsx)(s.td,{children:"188010"})]})]})]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"1732082878",src:r(75683).A+"",width:"602",height:"363"})}),"\n",(0,n.jsx)(s.p,{children:"Conclusion: In the regular read-only scenario, performance increases linearly with specifications. However, after reaching the 32C64GB specification, performance improvement slows. The hybrid configuration shows a 6% performance drop compared to the all-flash configuration."}),"\n",(0,n.jsx)(s.h3,{id:"scenario-4-regular-readswrites",children:(0,n.jsx)(s.strong,{children:"Scenario 4: regular reads/writes"})}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{}),(0,n.jsx)(s.th,{children:"All-flash (reads)"}),(0,n.jsx)(s.th,{children:"All-flash (writes)"}),(0,n.jsx)(s.th,{children:"Hybrid (reads)"}),(0,n.jsx)(s.th,{children:"Hybrid (writes)"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"8C16GB"}),(0,n.jsx)(s.td,{children:"36029"}),(0,n.jsx)(s.td,{children:"1801"}),(0,n.jsx)(s.td,{children:"34102"}),(0,n.jsx)(s.td,{children:"1705"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"16C32GB"}),(0,n.jsx)(s.td,{children:"69911"}),(0,n.jsx)(s.td,{children:"3495"}),(0,n.jsx)(s.td,{children:"61301"}),(0,n.jsx)(s.td,{children:"3065"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"32C64GB"}),(0,n.jsx)(s.td,{children:"131861"}),(0,n.jsx)(s.td,{children:"6593"}),(0,n.jsx)(s.td,{children:"111449"}),(0,n.jsx)(s.td,{children:"5572"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"64C128GB"}),(0,n.jsx)(s.td,{children:"148802"}),(0,n.jsx)(s.td,{children:"7440"}),(0,n.jsx)(s.td,{children:"125255"}),(0,n.jsx)(s.td,{children:"6262"})]})]})]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"1732082891",src:r(45757).A+"",width:"602",height:"363"})}),"\n",(0,n.jsx)(s.p,{children:"Conclusion: In the regular read/write scenario, performance increases linearly with specifications. However, after reaching the 32C64GB specification, performance improvement slows. The hybrid configuration shows a 12% performance drop compared to the all-flash configuration."}),"\n",(0,n.jsx)(s.h3,{id:"scenario-5-tpc-c-benchmark-on-tp-performance",children:(0,n.jsx)(s.strong,{children:"Scenario 5: TPC-C benchmark on TP performance"})}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{}),(0,n.jsx)(s.th,{children:"All-flash"}),(0,n.jsx)(s.th,{children:"Hybrid"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"8C16GB"}),(0,n.jsx)(s.td,{children:"35127"}),(0,n.jsx)(s.td,{children:"28042"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"16C32GB"}),(0,n.jsx)(s.td,{children:"82656"}),(0,n.jsx)(s.td,{children:"67327"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"32C64GB"}),(0,n.jsx)(s.td,{children:"137854"}),(0,n.jsx)(s.td,{children:"118766"})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:"64C128GB"}),(0,n.jsx)(s.td,{children:"158995"}),(0,n.jsx)(s.td,{children:"157774"})]})]})]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"1732082904",src:r(4455).A+"",width:"602",height:"363"})}),"\n",(0,n.jsx)(s.p,{children:"Conclusion: In the scenario of running the TPC-C benchmark on transaction processing (TP) performance, the hybrid configuration shows a 14% performance drop compared to the all-flash configuration."}),"\n",(0,n.jsx)(s.h3,{id:"scenario-6-stability-testing",children:(0,n.jsx)(s.strong,{children:"Scenario 6: stability testing"})}),"\n",(0,n.jsx)(s.p,{children:"We used sysbench to perform stress testing with a concurrency level of 300. The database ran stably for 72 hours in a regular read/write scenario."}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.strong,{children:"Conclusions"})}),"\n",(0,n.jsx)(s.p,{children:"The test results indicate that the hybrid configuration shows a 28% performance drop in the data write scenario, a 6% drop in the data read scenario, and an overall 13% drop in the read/write scenario compared to the all-flash configuration."}),"\n",(0,n.jsx)(s.p,{children:"In terms of stability, the database of either configuration ran stably for 72 hours under the high-concurrency read/write stress of the sysbench test. However, we could not fully simulate the complex real-world production environments in the tests. In such environments, exceptions are more likely to occur during the minor or major compaction process, thus affecting cluster stability."}),"\n",(0,n.jsx)(s.p,{children:"In the hybrid configuration, high-performance NVMe SSDs or regular SSDs are used to store transaction logs (which require real-time dump), and HDDs are used to store large amounts of business data. This type of configuration is suitable for scenarios with low performance requirements, relatively simple business logic, and massive data, such as history databases, log databases, and backup databases."}),"\n",(0,n.jsx)(s.p,{children:"The test results greatly encouraged us, as we have many history and log databases with massive data volumes. In addition, our online business workload is relatively low, and thus we have moderate requirements for data write performance and computing resources. For example, in one log database scenario, the daily log volume reaches nearly 2 billion records, with incremental data totaling around 4 TB (considering multiple replicas). Storing one month of data would require 30 all-flash servers. However, by switching to the hybrid configuration, we need only 3 servers to do the job, saving 27 servers, which translates to nearly CNY 3 million in hardware costs. Additionally, this solution allows us to utilize existing HDD-based servers, preventing significant resource waste."}),"\n",(0,n.jsx)(s.h2,{id:"summary",children:(0,n.jsx)(s.strong,{children:"Summary"})}),"\n",(0,n.jsx)(s.p,{children:"The results of our rigorous testing and verification indicate that, compared to the all-flash configuration, the hybrid configuration experiences a performance drop of around 20% but maintains stable and continuous operation on OceanBase Database V4.x. Hybrid configurations are particularly suitable for scenarios with moderate performance requirements, simple business logic, and large data volumes, such as history databases, log databases, and backup databases. Real-world use cases in production environments have verified their feasibility."}),"\n",(0,n.jsx)(s.p,{children:"Given that HDDs typically offer an order of magnitude more storage capacity than SSDs, hybrid configurations can reduce hardware costs by approximately 90% in these specific scenarios. This not only slashes the hardware budget but also improves resource utilization. In a telecom operator\u2019s log database, for example, telecom services involve a large and diverse user base. In addition to its core business operation support system (BOSS), the operator also manages mobile and online service platforms, subsystems, and agents. Log analysis provides valuable decision-making support for business operations. Hybrid configurations reduce hardware costs while allowing longer data retention periods, offering more accurate data for decision-making."}),"\n",(0,n.jsx)(s.p,{children:"Moreover, the feasibility of hybrid configurations proves that all-flash configurations are not the only option for OceanBase Database deployment. In the current era of rapid IT innovation and accelerated domestic technology adoption, IT device refresh cycles have shortened significantly. Many decommissioned devices, despite being replaced, are far from reaching their 6- to 8-year lifespan and still have functional high-capacity HDDs. Deploying OceanBase Database with hybrid configurations will substantially sustain the value of these legacy devices. For large companies with diverse hardware inventories, hybrid configurations expand the applicability of OceanBase Database and provide flexible, cost-effective, and efficient solutions for various business needs."})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},75683:(e,s,r)=>{r.d(s,{A:()=>n});const n=r.p+"assets/images/0f461c7e-0c8a-46d1-82f6-e82d31df8aa6-7bc889ad8727942e931e46508a137c14.png"},45757:(e,s,r)=>{r.d(s,{A:()=>n});const n=r.p+"assets/images/156ae12a-7fd7-4439-bde1-c7520bdbe92a-ae327c27c7f36d9f4ca9037bec1b4f8f.png"},4455:(e,s,r)=>{r.d(s,{A:()=>n});const n=r.p+"assets/images/298265e0-0b5f-4bbe-9741-3cf39bc8129c-be53f1e041fce3e8894bbef46c858663.png"},68884:(e,s,r)=>{r.d(s,{A:()=>n});const n=r.p+"assets/images/3692d7da-604c-4961-9a6d-4b1f80798e7a-eea3fd4f6d34e7d46b0e411285a7dfd2.png"},96258:(e,s,r)=>{r.d(s,{A:()=>n});const n=r.p+"assets/images/7c6096f8-9432-4cbe-9882-9abd79648977-905820c8ac4bf1a9f7621285357a76df.png"},28453:(e,s,r)=>{r.d(s,{R:()=>t,x:()=>o});var n=r(96540);const i={},a=n.createContext(i);function t(e){const s=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),n.createElement(a.Provider,{value:s},e.children)}}}]);