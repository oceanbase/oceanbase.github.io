"use strict";(self.webpackChunkmy_docs_website=self.webpackChunkmy_docs_website||[]).push([[1318],{91642:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>_,default:()=>m,frontMatter:()=>o,metadata:()=>s,toc:()=>r});var a=t(74848),i=t(28453);const o={title:"\u5907\u4efd\u6062\u590d",weight:5},_=void 0,s={id:"user_manual/operation_and_maintenance/operations_and_maintenance/commonly_used_sql/backup_and_restore",title:"\u5907\u4efd\u6062\u590d",description:"\u65e5\u5fd7\u5907\u4efd\u72b6\u6001\u67e5\u8be2",source:"@site/docs/user_manual/operation_and_maintenance/operations_and_maintenance/commonly_used_sql/05_backup_and_restore.md",sourceDirName:"user_manual/operation_and_maintenance/operations_and_maintenance/commonly_used_sql",slug:"/user_manual/operation_and_maintenance/operations_and_maintenance/commonly_used_sql/backup_and_restore",permalink:"/docs/user_manual/operation_and_maintenance/operations_and_maintenance/commonly_used_sql/backup_and_restore",draft:!1,unlisted:!1,editUrl:"https://github.com/oceanbase/oceanbase.github.io/tree/main/docs/user_manual/operation_and_maintenance/operations_and_maintenance/commonly_used_sql/05_backup_and_restore.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{title:"\u5907\u4efd\u6062\u590d",weight:5},sidebar:"operation_and_maintenanceSidebar",previous:{title:"\u7528\u6237\u53ca\u6743\u9650\u7ba1\u7406",permalink:"/docs/user_manual/operation_and_maintenance/operations_and_maintenance/commonly_used_sql/user_and_privilege_management"},next:{title:"\u5408\u5e76\u7ba1\u7406",permalink:"/docs/user_manual/operation_and_maintenance/operations_and_maintenance/commonly_used_sql/merge_management"}},c={},r=[{value:"\u65e5\u5fd7\u5907\u4efd\u72b6\u6001\u67e5\u8be2",id:"\u65e5\u5fd7\u5907\u4efd\u72b6\u6001\u67e5\u8be2",level:2},{value:"\u5168\u91cf\u5907\u4efd\u72b6\u6001\u67e5\u8be2",id:"\u5168\u91cf\u5907\u4efd\u72b6\u6001\u67e5\u8be2",level:2}];function d(n){const e={code:"code",h2:"h2",p:"p",pre:"pre",...(0,i.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.h2,{id:"\u65e5\u5fd7\u5907\u4efd\u72b6\u6001\u67e5\u8be2",children:"\u65e5\u5fd7\u5907\u4efd\u72b6\u6001\u67e5\u8be2"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.code,{children:"root@sys"})," \u767b\u9646\u67e5\u8be2\uff0c"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"SELECT\n  *\nFROM\n  (\n    SELECT\n      incarnation,\n      round_id AS log_archive_round,\n      tenant_id,\n      path AS backup_dest,\n      if(start_scn_display != '', start_scn_display, NULL) AS min_first_time,\n      if(\n        checkpoint_scn_display != '',\n        checkpoint_scn_display,\n        NULL\n      ) AS max_next_time,\n      status,\n      if(\n        checkpoint_scn != '',\n        truncate(\n          (time_to_usec(now()) - checkpoint_scn / 1000) / 1000000,\n          4\n        ),\n        NULL\n      ) AS delay,\n      now(6) AS check_time\n    FROM\n      cdb_ob_archivelog_summary\n      right JOIN (\n        SELECT\n          tenant_id AS _tenant_id,\n          MAX(round_id) AS _round_id\n        FROM\n          cdb_ob_archivelog_summary\n        GROUP BY\n          _tenant_id\n      ) AS t ON tenant_id = t._tenant_id\n      AND round_id = t._round_id\n  )\nlimit\n  0, 100;\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u5168\u91cf\u5907\u4efd\u72b6\u6001\u67e5\u8be2",children:"\u5168\u91cf\u5907\u4efd\u72b6\u6001\u67e5\u8be2"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.code,{children:"root@sys"})," \u767b\u9646\u67e5\u8be2\uff0c"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"SELECT\n  *\nFROM\n  (\n    SELECT\n      job_id,\n      incarnation,\n      tenant_id,\n      backup_set_id,\n      backup_type,\n      path AS backup_dest,\n      start_timestamp AS start_time,\n      end_timestamp AS end_time,\n      now(6) AS check_time,\n      status,\n      comment,\n      description,\n      'TENANT' AS backup_level\n    FROM\n      (\n        SELECT\n          job_id,\n          incarnation,\n          tenant_id,\n          backup_set_id,\n          backup_type,\n          path,\n          start_timestamp,\n          NULL AS end_timestamp,\n          status,\n          comment,\n          description\n        FROM\n          cdb_ob_backup_jobs\n        UNION\n        SELECT\n          job_id,\n          incarnation,\n          tenant_id,\n          backup_set_id,\n          backup_type,\n          path,\n          start_timestamp,\n          end_timestamp,\n          status,\n          comment,\n          description\n        FROM\n          cdb_ob_backup_job_history\n      )\n    WHERE\n      tenant_id != 1\n    ORDER BY\n      start_time DESC\n  );\n"})})]})}function m(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(d,{...n})}):d(n)}},28453:(n,e,t)=>{t.d(e,{R:()=>_,x:()=>s});var a=t(96540);const i={},o=a.createContext(i);function _(n){const e=a.useContext(o);return a.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:_(n.components),a.createElement(o.Provider,{value:e},n.children)}}}]);