"use strict";(self.webpackChunkmy_docs_website=self.webpackChunkmy_docs_website||[]).push([[8779],{81102:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>s,metadata:()=>i,toc:()=>d});var a=t(74848),r=t(28453);const s={title:"Cluster O&M",weight:2},o=void 0,i={id:"user_manual/operation_and_maintenance/en-US/operations_and_maintenance/commonly_used_sql/cluster_operations",title:"Cluster O&M",description:"Query the Version of OceanBase Database",source:"@site/docs/user_manual/operation_and_maintenance/en-US/operations_and_maintenance/commonly_used_sql/02_cluster_operations.md",sourceDirName:"user_manual/operation_and_maintenance/en-US/operations_and_maintenance/commonly_used_sql",slug:"/user_manual/operation_and_maintenance/en-US/operations_and_maintenance/commonly_used_sql/cluster_operations",permalink:"/docs/user_manual/operation_and_maintenance/en-US/operations_and_maintenance/commonly_used_sql/cluster_operations",draft:!1,unlisted:!1,editUrl:"https://github.com/oceanbase/oceanbase.github.io/tree/main/docs/user_manual/operation_and_maintenance/en-US/operations_and_maintenance/commonly_used_sql/02_cluster_operations.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Cluster O&M",weight:2},sidebar:"operation_and_maintenanceEnglishSidebar",previous:{title:"Introduction",permalink:"/docs/user_manual/operation_and_maintenance/en-US/operations_and_maintenance/commonly_used_sql/introduction"},next:{title:"Tenant Management",permalink:"/docs/user_manual/operation_and_maintenance/en-US/operations_and_maintenance/commonly_used_sql/tenant_management"}},c={},d=[{value:"Query the Version of OceanBase Database",id:"query-the-version-of-oceanbase-database",level:2},{value:"Query the Name and ID of a Cluster",id:"query-the-name-and-id-of-a-cluster",level:2},{value:"Query the Character Sets Supported by a Cluster",id:"query-the-character-sets-supported-by-a-cluster",level:2},{value:"Query Information about All Zones",id:"query-information-about-all-zones",level:2},{value:"Query the Server Status",id:"query-the-server-status",level:2},{value:"Query the Resource Configurations of Servers",id:"query-the-resource-configurations-of-servers",level:2},{value:"Query Degraded Log Streams of Tenants",id:"query-degraded-log-streams-of-tenants",level:2},{value:"Query the Arbitration Service Information of a Cluster",id:"query-the-arbitration-service-information-of-a-cluster",level:2},{value:"Query the Major Compaction Progress of Tenants",id:"query-the-major-compaction-progress-of-tenants",level:2}];function _(e){const n={code:"code",h2:"h2",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"query-the-version-of-oceanbase-database",children:"Query the Version of OceanBase Database"}),"\n",(0,a.jsx)(n.p,{children:"Execute the following SQL statement to query the version of the OceanBase Database installation package as any user, whether in MySQL or Oracle mode:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"SHOW VARIABLES LIKE '%version_comment%';\n"})}),"\n",(0,a.jsx)(n.h2,{id:"query-the-name-and-id-of-a-cluster",children:"Query the Name and ID of a Cluster"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"SELECT\n  *\nFROM\n  gv$ob_parameters\nWHERE\n  name IN ('cluster', 'cluster_id');\n"})}),"\n",(0,a.jsx)(n.h2,{id:"query-the-character-sets-supported-by-a-cluster",children:"Query the Character Sets Supported by a Cluster"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"SELECT\n  `collation_name` AS collation,\n  `character_set_name` AS charset,\n  `id`,\n  `is_default`\nFROM\n  information_schema.collations;\n"})}),"\n",(0,a.jsx)(n.h2,{id:"query-information-about-all-zones",children:"Query Information about All Zones"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"SELECT\n  *\nFROM\n  dba_ob_zones;\n"})}),"\n",(0,a.jsx)(n.h2,{id:"query-the-server-status",children:"Query the Server Status"}),"\n",(0,a.jsxs)(n.p,{children:["Execute the following SQL statement to query the information as the ",(0,a.jsx)(n.code,{children:"root@sys"})," user:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"SELECT\n  /*+READ_CONSISTENCY(WEAK), QUERY_TIMEOUT(100000000)*/\n  zone,\n  svr_ip,\n  with_rootserver,\n  start_service_time,\n  stop_time,\n  status,\n  substr(\n    build_version,\n    1,\n    instr(build_version, '-') - 1\n  ) build_version\nFROM\n  dba_ob_servers\nORDER BY\n  zone,\n  svr_ip;\n"})}),"\n",(0,a.jsx)(n.h2,{id:"query-the-resource-configurations-of-servers",children:"Query the Resource Configurations of Servers"}),"\n",(0,a.jsxs)(n.p,{children:["Execute the following SQL statement to query the information as the ",(0,a.jsx)(n.code,{children:"root@sys"})," user:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"SELECT\n  /* MONITOR_AGENT */\n  svr_ip,\n  svr_port,\n  cpu_capacity_max AS cpu_total,\n  cpu_assigned_max AS cpu_assigned,\n  round(mem_capacity / 1024 / 1024 / 1024) mem_total_gb,\n  round(mem_assigned / 1024 / 1024 / 1024) mem_assigned_gb,\n  round((cpu_assigned_max / cpu_capacity_max), 2) AS cpu_assigned_percent,\n  round((mem_assigned / mem_capacity), 2) AS mem_assigned_percent,\n  round(data_disk_capacity / 1024 / 1024 / 1024) data_disk_capacity_gb,\n  round(data_disk_in_use / 1024 / 1024 / 1024) data_disk_in_use_gb,\n  round(\n    (data_disk_capacity - data_disk_in_use) / 1024 / 1024 / 1024\n  ) data_disk_free_gb,\n  round(log_disk_capacity / 1024 / 1024 / 1024) log_disk_capacity_gb,\n  round(log_disk_assigned / 1024 / 1024 / 1024) log_disk_assigned_gb,\n  round(log_disk_in_use / 1024 / 1024 / 1024) log_disk_in_use_gb\nFROM\n  gv$ob_servers\nORDER BY\n  svr_ip,\n  svr_port;\n"})}),"\n",(0,a.jsx)(n.h2,{id:"query-degraded-log-streams-of-tenants",children:"Query Degraded Log Streams of Tenants"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"SELECT\n  a.tenant_id,\n  ls_id,\n  svr_ip,\n  svr_port,\n  role,\n  arbitration_member,\n  degraded_list\nFROM\n  gv$ob_log_stat a,\n  dba_ob_tenants b\nWHERE\n  degraded_list <> ''\n  AND a.tenant_id = b.tenant_id\n  AND tenant_type != 'META'\nORDER BY\n  a.tenant_id,\n  svr_ip,\n  svr_port;\n"})}),"\n",(0,a.jsx)(n.h2,{id:"query-the-arbitration-service-information-of-a-cluster",children:"Query the Arbitration Service Information of a Cluster"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"SELECT\n  arbitration_service_key,\n  arbitration_service,\n  previous_arbitration_service,\n  type\nFROM\n  dba_ob_arbitration_service;\n"})}),"\n",(0,a.jsx)(n.h2,{id:"query-the-major-compaction-progress-of-tenants",children:"Query the Major Compaction Progress of Tenants"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"SELECT\n  tenant_id,\n  compaction_scn,\n  100 * (\n    1 - SUM(unfinished_tablet_count) / SUM(total_tablet_count)\n  ) progress_pct\nFROM\n  gv$ob_compaction_progress\nGROUP BY\n  tenant_id,\n  compaction_scn\nORDER BY\n  compaction_scn\nLIMIT\n  20;\n"})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(_,{...e})}):_(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>i});var a=t(96540);const r={},s=a.createContext(r);function o(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);