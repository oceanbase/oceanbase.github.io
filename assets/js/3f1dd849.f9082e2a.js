"use strict";(self.webpackChunkmy_docs_website=self.webpackChunkmy_docs_website||[]).push([[370],{58418:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>l});var s=o(74848),t=o(28453);const a={title:"Disk Issues",weight:6},i=void 0,r={id:"user_manual/operation_and_maintenance/en-US/emergency_handbook/disk_problem",title:"Disk Issues",description:"Business and Database Symptoms",source:"@site/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/06_disk_problem.md",sourceDirName:"user_manual/operation_and_maintenance/en-US/emergency_handbook",slug:"/user_manual/operation_and_maintenance/en-US/emergency_handbook/disk_problem",permalink:"/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/disk_problem",draft:!1,unlisted:!1,editUrl:"https://github.com/oceanbase/oceanbase.github.io/tree/main/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/06_disk_problem.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{title:"Disk Issues",weight:6},sidebar:"operation_and_maintenanceEnglishSidebar",previous:{title:"Network Jitter",permalink:"/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/network_problem"},next:{title:"Full Log/Data Disk",permalink:"/docs/user_manual/operation_and_maintenance/en-US/emergency_handbook/disk_capacity_problem"}},c={},l=[{value:"Business and Database Symptoms",id:"business-and-database-symptoms",level:2},{value:"Troubleshooting Approach",id:"troubleshooting-approach",level:2},{value:"Troubleshoot Disk Faults",id:"troubleshoot-disk-faults",level:2},{value:"Troubleshoot High Disk I/O",id:"troubleshoot-high-disk-io",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"business-and-database-symptoms",children:"Business and Database Symptoms"}),"\n",(0,s.jsx)(n.p,{children:"The database is not putting pressure on disk I/O, but the io_await value remains high."}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"io_await indicates the average amount of time an I/O request waits in a queue to be processed, which reflects the I/O processing efficiency. If the io_await value is small, the I/O queue is not congested."}),"\n",(0,s.jsx)(n.p,{children:"When the io_await value approaches the svctm value, waiting in the I/O queue is almost not required. The svctm metric reflects disk performance, which is usually lower than 20 ms."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting-approach",children:"Troubleshooting Approach"}),"\n",(0,s.jsxs)(n.p,{children:["OceanBase Cloud Platform (OCP) provides two io_await monitoring metrics: ",(0,s.jsx)(n.a,{href:"https://en.oceanbase.com/docs/common-ocp-10000000001899727",children:"os_tsar_nvme_ioawait"})," and ",(0,s.jsx)(n.a,{href:"https://en.oceanbase.com/docs/common-ocp-10000000001899731",children:"os_tsar_sda_ioawait"}),". If the value of any metric is abnormal, OCP reports an alert by default."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"image",src:o(93108).A+"",width:"3792",height:"1952"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"If the amount of business traffic is small and no other processes consume the disk I/O, the issue is due to data migration, replication, and major compaction. The common solution to this issue is to downgrade some tasks with high I/O load."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"If no such tasks exist, check whether the disk itself is faulty. In most cases, if an exception such as a disk recognition failure occurs, OCP reports an alert indicating that the OBServer node is unavailable, rather than an alert relevant to io_await."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"troubleshoot-disk-faults",children:"Troubleshoot Disk Faults"}),"\n",(0,s.jsx)(n.p,{children:"The troubleshooting procedure for disk faults is similar to that for node failures or network jitter."}),"\n",(0,s.jsx)(n.p,{children:"To put it simply, if faulty disks are the minority, you can troubleshoot the issue as follows:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Rely on the high-availability mechanism of OceanBase Database to implement self-healing."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"General disk faults cannot be fixed in a short period of time. You need to put new hosts online for the cluster."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Switch back to the original primary zone during off-peak hours for the tenant."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"It is rare for disk faults to occur on all the nodes where the majority of replicas reside. If you encounter this issue, switch to the standby cluster."}),"\n",(0,s.jsx)(n.h2,{id:"troubleshoot-high-disk-io",children:"Troubleshoot High Disk I/O"}),"\n",(0,s.jsx)(n.p,{children:"High disk I/O usually occurs due to major compactions, also known as daily compactions. You can check in OCP to see if the system is running a major compaction."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"image",src:o(12015).A+"",width:"3794",height:"1950"})}),"\n",(0,s.jsx)(n.p,{children:"If so, you can suspend the major compaction and then resume it during off-peak hours."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"-- Suspend the running major compaction.\nALTER SYSTEM SUSPEND MERGE [ZONE [=] 'zone'];\n\n-- Resume the major compaction.\nALTER SYSTEM RESUME MERGE [ZONE [=] 'zone'];\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Other causes, such as data import/export and backup, are rarely seen. For more information, see ",(0,s.jsx)(n.a,{href:"https://en.oceanbase.com/docs/common-oceanbase-database-10000000001717376",children:"Node disk I/O high"}),". However, the descriptions of parameter definitions and modifications in the reference topic may contain errors. We recommend that you visit the official website to learn about a parameter before you modify it."]}),"\n",(0,s.jsx)(n.p,{children:"We recommend that you do not manually modify parameters to limit the resources for major and minor compactions, as these parameters do not have recommended values, and your modifications may not have a positive effect. You can adjust the daily compaction time to avoid overlapping business peak hours, which may be an optimal method."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},93108:(e,n,o)=>{o.d(n,{A:()=>s});const s=o.p+"assets/images/1-6a58c553916ad33f0f5d8de8b6024fc6.png"},12015:(e,n,o)=>{o.d(n,{A:()=>s});const s=o.p+"assets/images/2-225154999f9e9b3594a791d647788fd5.png"},28453:(e,n,o)=>{o.d(n,{R:()=>i,x:()=>r});var s=o(96540);const t={},a=s.createContext(t);function i(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);