"use strict";(self.webpackChunkmy_docs_website=self.webpackChunkmy_docs_website||[]).push([[5245],{373:(e,a,s)=>{s.r(a),s.d(a,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>c});var i=s(74848),n=s(28453);const t={slug:"Loong-Airlines",title:"HTAP Practice of Loong Airlines: Unified Technology Stack for Efficient Online Services and A Lightweight Real-Time Data Warehouse",tags:["User Case"]},o=void 0,r={id:"blogs/users/Loong-Airlines",title:"HTAP Practice of Loong Airlines: Unified Technology Stack for Efficient Online Services and A Lightweight Real-Time Data Warehouse",description:"About the author: Lu Qiuxiao, System Operations Engineer at Loong Airlines",source:"@site/docs/blogs/users/Loong-Airlines.md",sourceDirName:"blogs/users",slug:"/blogs/users/Loong-Airlines",permalink:"/docs/blogs/users/Loong-Airlines",draft:!1,unlisted:!1,editUrl:"https://github.com/oceanbase/oceanbase.github.io/tree/main/docs/blogs/users/Loong-Airlines.md",tags:[{inline:!0,label:"User Case",permalink:"/docs/tags/user-case"}],version:"current",frontMatter:{slug:"Loong-Airlines",title:"HTAP Practice of Loong Airlines: Unified Technology Stack for Efficient Online Services and A Lightweight Real-Time Data Warehouse",tags:["User Case"]},sidebar:"blogsSidebar",previous:{title:"400TB Single Cluster: OceanBase Powers Kwai`s Core Business",permalink:"/docs/blogs/users/Kwai"},next:{title:"NetEase Games: Why We Chose OceanBase Database?",permalink:"/docs/blogs/users/NetEase-Games"}},l={},c=[{value:"Database HTAP Capabilities Required for the Aviation Business",id:"database-htap-capabilities-required-for-the-aviation-business",level:2},{value:"Research on the HTAP Capabilities of OceanBase Database",id:"research-on-the-htap-capabilities-of-oceanbase-database",level:2},{value:"Aviation Business Efficiency Improved by HTAP Capabilities",id:"aviation-business-efficiency-improved-by-htap-capabilities",level:2},{value:"1. Benefits: real-time, smooth, reliable, and cost-effective data processing",id:"1-benefits-real-time-smooth-reliable-and-cost-effective-data-processing",level:3},{value:"2. Lessons learned: disk IOPS optimization",id:"2-lessons-learned-disk-iops-optimization",level:3},{value:"Vision for the Future",id:"vision-for-the-future",level:2}];function d(e){const a={blockquote:"blockquote",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(a.blockquote,{children:["\n",(0,i.jsxs)(a.p,{children:[(0,i.jsx)(a.strong,{children:"About the author:"})," Lu Qiuxiao, System Operations Engineer at Loong Airlines"]}),"\n"]}),"\n",(0,i.jsx)(a.h2,{id:"database-htap-capabilities-required-for-the-aviation-business",children:"Database HTAP Capabilities Required for the Aviation Business"}),"\n",(0,i.jsx)(a.p,{children:'Zhejiang Loong Airlines Co., Ltd., the only airline headquartered in Zhejiang Province, China, provides public passenger and cargo services. It holds all domestic and international air transport licenses, and has developed into a medium-large sized airline ranking among the largest private airlines in China. Since its founding in 2011, it has operated up to 600 domestic and international passenger and cargo routes, covering the entire Chinese mainland and reaching over 170 cities in regions along the "Belt and Road" routes, such as Hong Kong, Macau, Japan, South Korea, Southeast Asia, and Central Asia.'}),"\n",(0,i.jsx)(a.p,{children:"Efficient data management and a reliable database system are key factors for successful modern aviation operations. Loong Airlines needs to process a significant amount of data, including flight information, ticket sales data, customer information, and seat allocation data. Its business not only has high demands for online transaction processing (OLTP) but also requires advanced online analytical processing (OLAP) of T+N, T+1, and even T+0 data, emphasizing real-time data handling and reliable data analysis. Our original database, based on a master-slave mode, posed risks to business continuity in case of faults and could not process or analyze data in real time. This drove us to seek new database solutions."}),"\n",(0,i.jsx)(a.h2,{id:"research-on-the-htap-capabilities-of-oceanbase-database",children:"Research on the HTAP Capabilities of OceanBase Database"}),"\n",(0,i.jsx)(a.p,{children:"Our market research results indicated that OceanBase Database offers excellent performance and reliability for both OLTP and OLAP without the need to build two systems. So, we delved into key factors such as scalability, performance, data security, and reliability based on our business system requirements."}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.strong,{children:"1. Distributed architecture and scalability"})}),"\n",(0,i.jsx)(a.p,{children:"Our extensive aviation business requires the database system to handle massive amounts of data and concurrent requests. OceanBase Database can be deployed in a distributed architecture, which stores data across multiple nodes. We can easily add more nodes to cope with growing data volume."}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.img,{alt:"1704793000",src:s(14126).A+"",width:"454",height:"606"})}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.strong,{children:"2. High performance and complex queries"})}),"\n",(0,i.jsx)(a.p,{children:"We often need to retrieve and analyze data based on multiple conditions and metrics to provide accurate flight information and sales data. The SQL layer of OceanBase Database efficiently handles complex queries and returns results in a short time, thanks to its SQL optimizer and execution engine."}),"\n",(0,i.jsx)(a.p,{children:"The SQL optimizer of OceanBase Database rewrites SQL queries based on rules and cost models, generating and selecting optimal query rewrite plans. It also optimizes various plans in distributed processing scenarios."}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.img,{alt:"1704793014",src:s(98196).A+"",width:"920",height:"402"})}),"\n",(0,i.jsx)(a.p,{children:"The SQL execution engine of OceanBase Database supports parallel execution and vectorized computing. Using the parallel execution framework, it adaptively handles both parallel execution on a standalone server and distributed parallel execution. While serial execution suffices for small business, OceanBase Database supports parallel execution on a standalone server when a large amount of data is involved. Many open source standalone databases lack this capability. However, with sufficient CPU resources, the processing time of an SQL query can be linearly reduced by parallel execution in OceanBase Database. For distributed execution plans in the same form, OceanBase Database can execute them in parallel on multiple servers to process larger amounts of data. It breaks the performance bottleneck limited by the number of CPU cores of a single server, allowing us to scale up to hundreds or even thousands of CPU cores."}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.img,{alt:"1704793030",src:s(1170).A+"",width:"920",height:"390"})}),"\n",(0,i.jsx)(a.p,{children:"Furthermore, OceanBase Database handles both OLAP and OLTP requests within a single cluster, and resource isolation therefore is crucial. OceanBase Database provides various resource isolation methods, such as physical isolation of multiple zones and isolation of database connections based on CPU resource groups. It also automatically identifies and isolates slow queries to prevent them from affecting the overall transaction response time."}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.img,{alt:"1704793067",src:s(90169).A+"",width:"920",height:"470"})}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.strong,{children:"3. Data security and reliability"})}),"\n",(0,i.jsx)(a.p,{children:"Airlines have stringent requirements for data security and reliability, and must ensure data safety and system reliability to avoid downtime. OceanBase Database ensures data integrity and reliability through multi-layered security measures, such as data backup, fault recovery, and fault tolerance mechanisms."}),"\n",(0,i.jsx)(a.p,{children:"To better support the storage, queries, and modifications of our ticket data, we decided to build the core database system of our new business based on OceanBase Database."}),"\n",(0,i.jsx)(a.h2,{id:"aviation-business-efficiency-improved-by-htap-capabilities",children:"Aviation Business Efficiency Improved by HTAP Capabilities"}),"\n",(0,i.jsx)(a.h3,{id:"1-benefits-real-time-smooth-reliable-and-cost-effective-data-processing",children:"1. Benefits: real-time, smooth, reliable, and cost-effective data processing"}),"\n",(0,i.jsx)(a.p,{children:"a. Unified technology stack with enhanced real-time analysis capabilities"}),"\n",(0,i.jsx)(a.p,{children:"As shown in the following figure, OceanBase Database is everywhere in the system, serving multiple roles within the ticketing architecture and providing robust data management and analysis capabilities."}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.img,{alt:"1704793089",src:s(7222).A+"",width:"902",height:"330"})}),"\n",(0,i.jsx)(a.p,{children:"The data collection layer collects data from multiple sources in real time and aggregates the data in OceanBase Database. The preprocessing layer cleanses business data, while the operational data store (ODS) layer performs data modeling and stores the results in OceanBase Database. Finally, the service and publishing layer provides AP and TP results from OceanBase Database to various business applications through APIs for cross-system data calls."}),"\n",(0,i.jsx)(a.p,{children:"The high-performance query engine and distributed computing framework of OceanBase Database provide exceptional data processing and analysis capabilities, allowing us to swiftly conduct large-scale data analysis and respond to complex queries in real time. As AP and TP requests are handled in a single database system to produce accurate outcomes in real time, we can make more informed strategic decisions. From passenger behavior analysis to flight scheduling and resource management, OceanBase Database has streamlined our data processing workflows, making them more efficient and stable."}),"\n",(0,i.jsx)(a.p,{children:"b. Stable and reliable operations with zero downtime"}),"\n",(0,i.jsx)(a.p,{children:"Since the launch of OceanBase Database, our system has been running with zero downtime. OceanBase Database not only ensures system stability and reliability but also facilitates seamless business operations by enabling smooth integration between different business units, allowing for uninterrupted data flow. This has significantly reduced potential downtime and business risks."}),"\n",(0,i.jsx)(a.p,{children:"c. 70% reduction in storage costs"}),"\n",(0,i.jsx)(a.p,{children:"Thanks to the outstanding data processing and compression capabilities of OceanBase Database, we achieved a 70% reduction in storage costs after migrating business from MySQL to OceanBase Database."}),"\n",(0,i.jsx)(a.p,{children:"In addition to lower storage costs, OceanBase Database offers other benefits, such as high scalability of its distributed architecture, data security, and simplified O&M due to its hybrid transaction/analytical processing (HTAP) capabilities. It provides us with a reliable data management solution, thus enhancing our operational efficiency and competitive edge."}),"\n",(0,i.jsx)(a.h3,{id:"2-lessons-learned-disk-iops-optimization",children:"2. Lessons learned: disk IOPS optimization"}),"\n",(0,i.jsx)(a.p,{children:"We deployed and comprehensively tested OceanBase Database based on the official documentation and, with satisfactory results, introduced it into our production environment. However, lacking familiarity with the database product, we began experiencing a regular spike in disk IOPS at 22:00 every day after a few months of operation, when a considerable amount of data had been accumulated."}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.img,{alt:"1704793121",src:s(49518).A+"",width:"920",height:"478"})}),"\n",(0,i.jsx)(a.p,{children:"When troubleshooting with OceanBase Technical Support, we identified several issues with our cluster deployment."}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsx)(a.li,{children:"We stored the /redo, /log, and /data directories on the same disk, rather than physically isolating them. The /redo directory in particular has high I/O performance requirements."}),"\n",(0,i.jsx)(a.li,{children:"Instead of SSDs, we installed HDDs, which provided unsatisfactory disk I/O capabilities. OceanBase Technical Support recommended SSDs for production environments because HDDs might result in performance bottlenecks during a major compaction in the backend."}),"\n",(0,i.jsx)(a.li,{children:"We set the primary_zone parameter of tenants to zone1, so that all leader replicas were stored on the same server, which became a read/write hotspot."}),"\n"]}),"\n",(0,i.jsx)(a.p,{children:"With the help of OceanBase Technical Support, we physically separated the /redo, /log, and /data directories by migrating them to different disks. This avoids contention of disk I/O resources and ensures optimal I/O performance for each directory."}),"\n",(0,i.jsx)(a.p,{children:"We also optimized parameter settings, especially the connection timeout, single-transaction time, and log level parameters, and managed accounts of our self-built operating system in OceanBase Cloud Platform (OCP)."}),"\n",(0,i.jsx)(a.p,{children:"The optimization measures brought a significant improvement in system performance with stable and efficient operations."}),"\n",(0,i.jsx)(a.h2,{id:"vision-for-the-future",children:"Vision for the Future"}),"\n",(0,i.jsx)(a.p,{children:"As our aviation business continues to grow and data volume increases, we will further expand the application scope of OceanBase Database. We will leverage its high scalability to enhance the system capacity and performance by adding more nodes as needed. To access the latest features and optimizations, we will also keep a close eye on the technological updates of OceanBase Database, and will collaborate with the OceanBase community."}),"\n",(0,i.jsx)(a.p,{children:"We believe that OceanBase Database, as an efficient and reliable distributed database product developed by a Chinese company, its successful application in our aviation ticketing system has set an example for companies in other industries. By optimizing our business data management and analysis capabilities based on OceanBase Database, we can further reduce O&M and storage costs while boosting business processing efficiency."})]})}function h(e={}){const{wrapper:a}={...(0,n.R)(),...e.components};return a?(0,i.jsx)(a,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},14126:(e,a,s)=>{s.d(a,{A:()=>i});const i=s.p+"assets/images/1704793000832-9c3e96886a12356742b186e593fc2281.png"},98196:(e,a,s)=>{s.d(a,{A:()=>i});const i=s.p+"assets/images/1704793014642-9f00363cbd92453f1025938e6fe67b87.png"},1170:(e,a,s)=>{s.d(a,{A:()=>i});const i=s.p+"assets/images/1704793030493-ba838c872d295d3c168785c805b66313.png"},90169:(e,a,s)=>{s.d(a,{A:()=>i});const i=s.p+"assets/images/1704793067111-c37ad6812d89891304670f7abc008148.png"},7222:(e,a,s)=>{s.d(a,{A:()=>i});const i=s.p+"assets/images/1704793089912-eaa8e142723deea562d9fe5f44774bdd.png"},49518:(e,a,s)=>{s.d(a,{A:()=>i});const i=s.p+"assets/images/1704793121478-1423e080fa16232926ec8c3b062218b9.png"},28453:(e,a,s)=>{s.d(a,{R:()=>o,x:()=>r});var i=s(96540);const n={},t=i.createContext(n);function o(e){const a=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function r(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),i.createElement(t.Provider,{value:a},e.children)}}}]);