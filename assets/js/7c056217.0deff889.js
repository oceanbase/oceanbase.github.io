"use strict";(self.webpackChunkmy_docs_website=self.webpackChunkmy_docs_website||[]).push([[7836],{27937:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>i,default:()=>h,frontMatter:()=>c,metadata:()=>l,toc:()=>o});var r=s(74848),d=s(28453);const c={title:"\u6392\u67e5 ODP \u8fde\u63a5\u95ee\u9898",weight:3},i=void 0,l={id:"user_manual/operation_and_maintenance/zh-CN/tool_emergency_handbook/odp_troubleshooting_guide/connection_diagnosis",title:"\u6392\u67e5 ODP \u8fde\u63a5\u95ee\u9898",description:"\u5f53\u524d\u4f7f\u7528 ODP \u65f6\uff0c\u8bf7\u6c42\u6267\u884c\u7684\u94fe\u8def\u4e3b\u8981\u4e3a\uff1a\u5ba2\u6237\u7aef\u53d1\u9001\u8bf7\u6c42\u5230 ODP --\x3e ODP \u5c06\u8bf7\u6c42\u8def\u7531\u5230\u5bf9\u5e94\u7684 OBServer \u8282\u70b9 --\x3e OBServer \u8282\u70b9\u5904\u7406\u8bf7\u6c42\u53d1\u9001\u56de\u5305\u7ed9 ODP --\x3e ODP \u56de\u5305\u7ed9\u5ba2\u6237\u7aef\u3002",source:"@site/docs/user_manual/operation_and_maintenance/zh-CN/tool_emergency_handbook/odp_troubleshooting_guide/03_connection_diagnosis.md",sourceDirName:"user_manual/operation_and_maintenance/zh-CN/tool_emergency_handbook/odp_troubleshooting_guide",slug:"/user_manual/operation_and_maintenance/zh-CN/tool_emergency_handbook/odp_troubleshooting_guide/connection_diagnosis",permalink:"/docs/user_manual/operation_and_maintenance/zh-CN/tool_emergency_handbook/odp_troubleshooting_guide/connection_diagnosis",draft:!1,unlisted:!1,editUrl:"https://github.com/oceanbase/oceanbase.github.io/tree/main/docs/user_manual/operation_and_maintenance/zh-CN/tool_emergency_handbook/odp_troubleshooting_guide/03_connection_diagnosis.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"\u6392\u67e5 ODP \u8fde\u63a5\u95ee\u9898",weight:3},sidebar:"operation_and_maintenanceSidebar",previous:{title:"\u6392\u67e5 ODP \u662f\u5426\u662f\u6027\u80fd\u74f6\u9888",permalink:"/docs/user_manual/operation_and_maintenance/zh-CN/tool_emergency_handbook/odp_troubleshooting_guide/show_trace"},next:{title:"\u6392\u67e5 ODP \u8def\u7531\u95ee\u9898",permalink:"/docs/user_manual/operation_and_maintenance/zh-CN/tool_emergency_handbook/odp_troubleshooting_guide/routing_diagnosis"}},t={},o=[{value:"\u6392\u67e5 ODP \u95ee\u9898\u7684\u57fa\u672c\u65b9\u6cd5",id:"\u6392\u67e5-odp-\u95ee\u9898\u7684\u57fa\u672c\u65b9\u6cd5",level:2},{value:"\u5e38\u89c1\u65ad\u8fde\u63a5\u573a\u666f",id:"\u5e38\u89c1\u65ad\u8fde\u63a5\u573a\u666f",level:2},{value:"\u767b\u5f55\u65ad\u8fde\u63a5",id:"\u767b\u5f55\u65ad\u8fde\u63a5",level:3},{value:"\u8d85\u65f6\u65ad\u8fde\u63a5",id:"\u8d85\u65f6\u65ad\u8fde\u63a5",level:3},{value:"OceanBase \u6570\u636e\u5e93\u4e3b\u52a8\u65ad\u5f00\u8fde\u63a5",id:"oceanbase-\u6570\u636e\u5e93\u4e3b\u52a8\u65ad\u5f00\u8fde\u63a5",level:3},{value:"\u5ba2\u6237\u7aef\u4e3b\u52a8\u65ad\u8fde\u63a5",id:"\u5ba2\u6237\u7aef\u4e3b\u52a8\u65ad\u8fde\u63a5",level:3},{value:"ODP \u6216 OceanBase \u6570\u636e\u5e93\u5185\u90e8\u9519\u8bef",id:"odp-\u6216-oceanbase-\u6570\u636e\u5e93\u5185\u90e8\u9519\u8bef",level:3},{value:"\u5176\u4ed6\u573a\u666f",id:"\u5176\u4ed6\u573a\u666f",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b",level:2},{value:"\u6b65\u9aa4\u4e00\uff1a\u786e\u5b9a\u65ad\u8fde\u63a5\u65b9",id:"\u6b65\u9aa4\u4e00\u786e\u5b9a\u65ad\u8fde\u63a5\u65b9",level:3},{value:"\u6b65\u9aa4\u4e8c\uff1a\u6392\u67e5\u65ad\u8fde\u63a5\u539f\u56e0",id:"\u6b65\u9aa4\u4e8c\u6392\u67e5\u65ad\u8fde\u63a5\u539f\u56e0",level:3},{value:"\u5ba2\u6237\u7aef\u65ad\u8fde\u63a5",id:"\u5ba2\u6237\u7aef\u65ad\u8fde\u63a5",level:4},{value:"ODP \u65ad\u8fde\u63a5",id:"odp-\u65ad\u8fde\u63a5",level:4},{value:"\u767b\u5f55\u5931\u8d25",id:"\u767b\u5f55\u5931\u8d25",level:4}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u5f53\u524d\u4f7f\u7528 ODP \u65f6\uff0c\u8bf7\u6c42\u6267\u884c\u7684\u94fe\u8def\u4e3b\u8981\u4e3a\uff1a\u5ba2\u6237\u7aef\u53d1\u9001\u8bf7\u6c42\u5230 ODP --\x3e ODP \u5c06\u8bf7\u6c42\u8def\u7531\u5230\u5bf9\u5e94\u7684 OBServer \u8282\u70b9 --\x3e OBServer \u8282\u70b9\u5904\u7406\u8bf7\u6c42\u53d1\u9001\u56de\u5305\u7ed9 ODP --\x3e ODP \u56de\u5305\u7ed9\u5ba2\u6237\u7aef\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u76ee\u524d\u6574\u6761\u94fe\u8def\u4e0a\u90fd\u53ef\u80fd\u53d1\u751f\u65ad\u8fde\u63a5\u7684\u573a\u666f\uff0c\u6bd4\u5982\uff1a\u8bf7\u6c42\u5904\u7406\u65f6\u95f4\u8f83\u957f\u5bfc\u81f4\u5ba2\u6237\u7aef\u957f\u65f6\u95f4\u6ca1\u6709\u6536\u5230\u56de\u5305\u800c\u65ad\u5f00\u8fde\u63a5\u3001\u7528\u6237\u767b\u5f55\u4fe1\u606f\u586b\u5199\u9519\u8bef\u7684\u96c6\u7fa4\u79df\u6237\u7b49\u5bfc\u81f4\u65e0\u6cd5\u767b\u5f55\u3001ODP \u4ee5\u53ca OceanBase \u6570\u636e\u5e93\u7684\u5185\u90e8\u9519\u8bef\u5bfc\u81f4\u65ad\u5f00\u8fde\u63a5\u7b49\u7b49\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u6392\u67e5-odp-\u95ee\u9898\u7684\u57fa\u672c\u65b9\u6cd5",children:"\u6392\u67e5 ODP \u95ee\u9898\u7684\u57fa\u672c\u65b9\u6cd5"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)("font",{color:"red",children:"\u4e2a\u4eba\u5efa\u8bae\u91cd\u70b9\u770b\u4e00\u4e0b \u201c\u6392\u67e5 ODP \u95ee\u9898\u7684\u57fa\u672c\u65b9\u6cd5\u201d \u8fd9\u4e00\u90e8\u5206\u7684\u5185\u5bb9\uff0c\u80fd\u6839\u636e trace id \u635e\u51fa\u65e5\u5fd7\uff0c\u5bf9\u4e8e\u5927\u591a\u6570\u573a\u666f\uff0c\u57fa\u672c\u4e5f\u5c31\u591f\u7528\u4e86\u3002"})})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u521d\u6b65\u6392\u67e5 ODP \u95ee\u9898\u7684\u65b9\u6cd5\uff0c\u548c\u6392\u67e5 observer \u95ee\u9898\u7684\u65b9\u6cd5\u7c7b\u4f3c\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u4f8b\u5982\u8fde\u63a5\u62a5\u9519\uff0c\u60f3\u770b\u8be6\u7ec6\u7684\u62a5\u9519\u65e5\u5fd7\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"[xiaofeng.lby@sqaobnoxdn011161204091.sa128 /home/xiaofeng.lby]\n$obclient -h 127.0.0.1 -P2883 -uroot@sys#xiaofeng_91_435 -Dtest\nERROR 4669 (HY000): cluster not exist\n"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u8fd9\u4e2a\u4f8b\u5b50\u4e3e\u7684\u4e0d\u592a\u597d\uff0c\u5728\u521d\u59cb\u62a5\u9519 cluster not exist \u7684\u65f6\u5019\u57fa\u672c\u5c31\u80fd\u770b\u51fa\u662f\u5565\u95ee\u9898\u4e86\uff0c\u5927\u5bb6\u91cd\u5728\u9886\u4f1a\u7cbe\u795e\u3002"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u4e00\u822c\u4e0d\u786e\u5b9a\u662f\u5426\u5c5e\u4e8e ODP \u7684\u8d23\u4efb\uff0c\u4f1a\u5148\u5728 ",(0,r.jsx)(n.code,{children:"/oceanbase/log"})," \u76ee\u5f55\u4e2d ",(0,r.jsx)(n.code,{children:'grep "ret=-4669" *'}),"\uff08\u5982\u679c log \u76ee\u5f55\u4e2d\u7684\u65e5\u5fd7\u8f83\u591a\uff0c\u53ef\u4ee5\u6839\u636e\u5b9e\u9645\u60c5\u51b5\uff0c\u628a grep \u540e\u9762\u7684 * \u6539\u6210 observer.log.202412171219* \u7b49\uff09\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'[xiaofeng.lby@sqaobnoxdn011161204091.sa128 /home/xiaofeng.lby/oceanbase/log]\n$sudo grep "ret=-4669" *\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u5982\u679c\u5728 observer \u76ee\u5f55\u4e2d grep \u4e0d\u5230\u4efb\u4f55\u9519\u8bef\u4fe1\u606f\uff0c\u5927\u6982\u7387\u5c31\u662f ODP \u7684\u95ee\u9898\u4e86\u3002\u53ef\u4ee5\u518d\u5230 ",(0,r.jsx)(n.code,{children:"/obproxy/log"})," \u4e0b\u9762\u53bb grep \u4e00\u628a\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'[xiaofeng.lby@sqaobnoxdn011161204091.sa128 /home/xiaofeng.lby/obproxy/log]\n$grep "ret=-4669" *\n\n# \u8fd9\u91cc\u7684\u8f93\u51fa\u539f\u672c\u662f\u4e00\u884c\uff0c\u4e3a\u4e86\u65b9\u4fbf\u5728\u7f51\u9875\u4e2d\u5c55\u793a\uff0c\u624b\u52a8\u62c6\u6210\u4e86\u591a\u884c\u3002\nobproxy.log:[2024-12-17 14:34:14.024891]\nWDIAG [PROXY.SM] setup_get_cluster_resource (ob_mysql_sm.cpp:1625) \n[125907][Y0-00007F630AAA2A70] [lt=0] [dc=0] \ncluster does not exist, this connection will disconnect\n(sm_id=26403246, is_clustername_from_default=false, cluster_name=xiaofeng_91_435, ret=-4669)\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u4e00\u822c\u5230\u8fd9\u6b65\u5c31\u80fd\u591f\u6839\u636e\u65e5\u5fd7\u770b\u51fa\u4e00\u4e9b\u7aef\u502a\u4e86\uff0c\u65e5\u5fd7\u91cc\u660e\u786e\u8bf4\u4e86\u8fd9\u4e2a cluster_name \u53eb xiaofeng_91_435 \u7684\u96c6\u7fa4\u4e0d\u5b58\u5728\uff0c\u6240\u4ee5 this connection will disconnect\u3002"}),"\n",(0,r.jsxs)(n.p,{children:["\u5728\u4e0a\u9762\u7684\u65e5\u5fd7\u91cc\uff0c\u8fd8\u53ef\u4ee5\u83b7\u5f97\u4e00\u4e2a trace id\uff1a",(0,r.jsx)(n.code,{children:"[Y0-00007F630AAA2A70]"}),"\uff0c\u5982\u679c\u5e0c\u671b\u8fdb\u4e00\u6b65\u83b7\u5f97\u66f4\u591a\u4fe1\u606f\uff0cgrep \u8fd9\u4e2a trace id \u5c31\u80fd\u591f\u83b7\u5f97\u6240\u6709\u8fd9\u6b21\u64cd\u4f5c\u76f8\u5173\u7684\u6240\u6709\u65e5\u5fd7\u4fe1\u606f\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'[xiaofeng.lby@sqaobnoxdn011161204091.sa128 /home/xiaofeng.lby/obproxy/log]\n$grep Y0-00007F630AAA2A70 *\n\nobproxy_diagnosis.log:[2024-12-17 14:34:14.024938] [125907][Y0-00007F630AAA2A70] [LOGIN]\n(trace_type="LOGIN_TRACE", \n   connection_diagnosis={\n      cs_id:278640, ss_id:0, proxy_session_id:0, server_session_id:0,\n      client_addr:"127.0.0.1:9988", server_addr:"*Not IP address [0]*:0", \n      cluster_name:"xiaofeng_91_435", tenant_name:"sys", user_name:"root", \n      error_code:-4669, error_msg:"cluster does not exist", \n      request_cmd:"OB_MYSQL_COM_LOGIN", sql_cmd:"OB_MYSQL_COM_LOGIN",\n       req_total_time(us):196}\n   {internal_sql:"", login_result:"failed"})\n\nobproxy_error.log:2024-12-17 \n14:34:14.024960,xiaofeng_cluster_430_proxy,,,,xiaofeng_91_435:sys:,OB_MYSQL,,,\nOB_MYSQL_COM_LOGIN,,failed,-4669,,194us,0us,0us,0us,\nY0-00007F630AAA2A70,,127.0.0.1:9988,,0,,cluster not exist,\n\nobproxy.log:[2024-12-17 14:34:13.584801] INFO  [PROXY.NET] accept (ob_mysql_session_accept.cpp:36)\n[125907][Y0-00007F630AAA2A70] [lt=0] [dc=0] [ObMysqlSessionAccept:main_event]\naccepted connection(netvc=0x7f630aa7d2e0, client_ip={127.0.0.1:9980})\n...\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u5f53\u53d1\u751f\u65ad\u8fde\u63a5\u4e4b\u540e\uff0cODP \u4f1a\u8bb0\u5f55\u4e00\u6bb5\u65ad\u8fde\u63a5\u65e5\u5fd7\u5230 ",(0,r.jsx)(n.code,{children:"obproxy_diagnosis.log"})," \u65e5\u5fd7\u6587\u4ef6\u4e2d\uff0c\u8fd9\u91cc\u4f1a\u8be6\u7ec6\u8bb0\u5f55\u65ad\u8fde\u63a5\u76f8\u5173\u7684\u4fe1\u606f\uff0c\u4ee5\u79df\u6237\u540d\u5199\u9519\u4e3a\u4f8b\uff1a"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'# \u8fd9\u91cc\u7684\u8f93\u51fa\u539f\u672c\u662f\u4e00\u884c\uff0c\u4e3a\u4e86\u65b9\u4fbf\u5728\u7f51\u9875\u4e2d\u5c55\u793a\uff0c\u624b\u52a8\u62c6\u6210\u4e86\u591a\u884c\u3002\n[2023-08-23 20:11:08.567425]\n[109316][Y0-00007F285BADB4E0] [CONNECTION]\n(trace_type="LOGIN_TRACE", \nconnection_diagnosis={\n    cs_id:1031798792, ss_id:0, proxy_session_id:0, server_session_id:0, \n    client_addr:"10.10.10.1:58218", server_addr:"*Not IP address [0]*:0", \n    cluster_name:"undefined", tenant_name:"test", user_name:"root", \n    error_code:-4043,\n    error_msg:"dummy entry is empty, please check if the tenant exists", \n    request_cmd:"COM_SLEEP", sql_cmd:"COM_LOGIN"}{internal_sql:""})\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u770b\u5230\u6700\u540e error_msg \u4e2d\u7684 ",(0,r.jsx)(n.code,{children:"please check if the tenant exists"}),"\uff0c\u57fa\u672c\u4e5f\u5c31\u80fd\u731c\u51fa\u65ad\u8fde\u63a5\u7684\u539f\u56e0\u4e86\u3002"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)("font",{color:"red",children:"\u5728\u8fd9\u4e2a\u6587\u6863\u4e2d\uff0c\u540e\u9762\u7684\u90e8\u5206\u90fd\u662f\u4e00\u4e9b \u201c\u7c7b\u5b57\u5178\u201d \u7684\u5185\u5bb9\uff0c\u53ea\u9700\u8981\u7c97\u7565\u8fc7\u4e00\u904d\uff08\u56e0\u4e3a\u8ba4\u771f\u770b\u5b8c\u4e5f\u8bb0\u4e0d\u4f4f\uff09\u3002"})})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:(0,r.jsx)("font",{color:"red",children:"\u5efa\u8bae\u5148\u6536\u85cf\u3002\u5982\u679c\u771f\u51fa\u4e86\u95ee\u9898\uff0c\u635e\u51fa\u65e5\u5fd7\uff0c\u62ff\u7740\u65e5\u5fd7\u91cc\u7684\u5173\u952e\u4fe1\u606f\uff0c\u5728\u4e0b\u9762\u67e5\u4e00\u4e0b\u5bf9\u5e94\u7684\u89e3\u51b3\u65b9\u6cd5\u5373\u53ef\u3002"})})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"obproxy_diagnosis \u65e5\u5fd7\u901a\u7528\u5185\u5bb9\u5982\u4e0b\uff1a"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["LOG_TIME\uff1a\u65e5\u5fd7\u6253\u5370\u65f6\u95f4\uff0c\u5373\u793a\u4f8b\u4e2d\u7684 ",(0,r.jsx)(n.code,{children:"2023-08-23 20:11:08.567425"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["TID\uff1a\u7ebf\u7a0b ID\uff0c\u5373\u793a\u4f8b\u4e2d\u7684 ",(0,r.jsx)(n.code,{children:"109316"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["TRACE_ID\uff1atrace_id\uff0c\u5373\u793a\u4f8b\u4e2d\u7684 ",(0,r.jsx)(n.code,{children:"Y0-00007F285BADB4E0"}),"\uff0c\u53ef\u4ee5\u901a\u8fc7 trace_id \u4e0e\u5176\u4ed6\u65e5\u5fd7\u8fdb\u884c\u5173\u8054"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"CONNECTION\uff1a\u8868\u793a\u8fd9\u6761\u65e5\u5fd7\u4e3a\u8fde\u63a5\u8bca\u65ad\u76f8\u5173\u7684\u65e5\u5fd7"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"trace_type\uff1a\u8bca\u65ad\u7c7b\u578b\uff0c\u76ee\u524d\u8bca\u65ad\u65e5\u5fd7\u6709\u4ee5\u4e0b\u51e0\u79cd\u7c7b\u578b\uff0c\u4e0d\u540c\u7684\u8bca\u65ad\u7c7b\u578b\u4e5f\u5bf9\u5e94\u4e0d\u540c\u7684\u65ad\u8fde\u63a5\u95ee\u9898"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"LOGIN_TRACE\uff1a\u767b\u5f55\u95ee\u9898\u76f8\u5173\u7684\u8bca\u65ad\u65e5\u5fd7"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"SERVER_INTERNAL_TRACE\uff1aOceanBase \u6570\u636e\u5e93\u5185\u90e8\u9519\u8bef\u7684\u8bca\u65ad\u4fe1\u606f"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"PROXY_INTERNAL_TRACE\uff1aODP \u5185\u90e8\u9519\u8bef\u5bfc\u81f4\u65ad\u8fde\u63a5\u7684\u8bca\u65ad\u4fe1\u606f"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"CLIENT_VC_TRACE\uff1a\u5ba2\u6237\u7aef\u4e3b\u52a8\u65ad\u8fde\u7684\u8bca\u65ad\u65e5\u5fd7"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"SERVER_VC_TRACE\uff1aOceanBase \u6570\u636e\u5e93\u4e3b\u52a8\u65ad\u8fde\u7684\u8bca\u65ad\u65e5\u5fd7"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"TIMEOUT_TRACE\uff1aODP \u6267\u884c\u8d85\u65f6\u7684\u8bca\u65ad\u65e5\u5fd7"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"CS_ID\uff1aODP \u5185\u90e8\u6807\u8bc6\u5ba2\u6237\u7aef\u8fde\u63a5\u7684 ID"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"SS_ID\uff1aODP \u5185\u90e8\u6807\u8bc6 ODP \u4e0e OceanBase \u6570\u636e\u5e93\u4e4b\u95f4\u8fde\u63a5\u7684 ID"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"PROXY_SS_ID\uff1a\u7531 ODP \u751f\u6210\u7684\u6807\u8bc6\u5ba2\u6237\u7aef\u8fde\u63a5\u7684 ID\uff0c\u4f1a\u4f20\u9012\u7ed9 OceanBase \u6570\u636e\u5e93\uff0c\u53ef\u4ee5\u7528\u6765\u7b5b\u9009 OceanBase \u6570\u636e\u5e93\u65e5\u5fd7\u6216\u8005 sql_audit \u8868"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"SERVER_SS_ID\uff1a\u7531 OceanBase \u6570\u636e\u5e93\u751f\u6210\u7684\u6807\u8bc6 ODP \u4e0e OceanBase \u6570\u636e\u5e93\u4e4b\u95f4\u8fde\u63a5\u7684 ID"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"CLIENT_ADDR\uff1a\u5ba2\u6237\u7aef\u7684 IP \u5730\u5740"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"SERVER_ADDR\uff1a\u51fa\u9519\u6216\u8005\u65ad\u8fde\u63a5\u65f6\u5bf9\u5e94\u7684 OBServer \u8282\u70b9\u7684\u5730\u5740"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"CLUSTER_NAME\uff1a\u96c6\u7fa4\u540d"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"TENANT_NAME\uff1a\u79df\u6237\u540d"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"USER_NAME\uff1a\u7528\u6237\u540d"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"ERROR_CODE\uff1a\u9519\u8bef\u7801"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"ERROR_MSG\uff1a\u9519\u8bef\u4fe1\u606f\uff0c\u8bca\u65ad\u65ad\u8fde\u63a5\u7684\u5173\u952e\u5185\u5bb9"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"REQUEST_CMD\uff1aODP \u5f53\u524d\u6b63\u5728\u6267\u884c\u7684 SQL \u8bed\u53e5\u7684\u7c7b\u578b\uff0c\u53ef\u80fd\u4e3a\u5185\u90e8\u8bf7\u6c42\u7684 SQL \u8bed\u53e5\u7c7b\u578b"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"SQL_CMD\uff1a\u7528\u6237 SQL \u8bed\u53e5\u7684\u7c7b\u578b"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u9664\u4e0a\u8ff0\u901a\u7528\u7684\u4fe1\u606f\u5916\uff0c\u8bca\u65ad\u65e5\u5fd7\u8fd8\u5305\u542b\u989d\u5916\u8bca\u65ad\u4fe1\u606f\uff0c\u5177\u4f53\u5185\u5bb9\u7531 trace_type \u51b3\u5b9a\u3002"}),"\n",(0,r.jsx)(n.h2,{id:"\u5e38\u89c1\u65ad\u8fde\u63a5\u573a\u666f",children:"\u5e38\u89c1\u65ad\u8fde\u63a5\u573a\u666f"}),"\n",(0,r.jsx)(n.p,{children:"\u63a5\u4e0b\u6765\u4e3a\u5927\u5bb6\u4ecb\u7ecd\u51e0\u79cd\u5e38\u89c1\u7684\u65ad\u8fde\u63a5\u573a\u666f\uff0c\u4ee5\u53ca\u5bf9\u5e94\u65ad\u8fde\u63a5\u573a\u666f\u7684\u6392\u67e5\u548c\u89e3\u51b3\u65b9\u6cd5\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"\u767b\u5f55\u65ad\u8fde\u63a5",children:"\u767b\u5f55\u65ad\u8fde\u63a5"}),"\n",(0,r.jsx)(n.p,{children:"\u767b\u5f55\u65ad\u8fde\u63a5\u5bf9\u5e94\u7684 trace_type \u4e3a LOGIN_TRACE\uff0c\u79df\u6237\u540d\u9519\u8bef\u5bfc\u81f4\u65ad\u8fde\u63a5\u7684\u8bca\u65ad\u65e5\u5fd7\u793a\u4f8b\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'[2023-09-08 10:37:21.028960] [90663][Y0-00007F8EB76544E0] [CONNECTION](\n   trace_type="LOGIN_TRACE", \n   connection_diagnosis={\n      cs_id:1031798785, ss_id:0, proxy_session_id:0, server_session_id:0, \n      client_addr:"10.10.10.1:44018", server_addr:"*Not IP address [0]*:0", \n      cluster_name:"undefined", tenant_name:"sys", user_name:"root", error_code:-10018, \n      error_msg:"fail to check observer version, empty result", request_cmd:"COM_SLEEP", \n      sql_cmd:"COM_LOGIN"}\n   {internal_sql:"SELECT ob_version() AS cluster_version"})\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u989d\u5916\u8bca\u65ad\u4fe1\u606f\u4e3a ",(0,r.jsx)(n.code,{children:"internal_sql"}),"\uff0c\u8868\u793a ODP \u5f53\u524d\u6267\u884c\u7684\u5185\u90e8\u8bf7\u6c42\u3002"]}),"\n",(0,r.jsx)(n.p,{children:"\u767b\u5f55\u65ad\u8fde\u63a5\u4ea7\u751f\u7684\u539f\u56e0\u6bd4\u8f83\u590d\u6742\uff0c\u672c\u6587\u4ece\u7528\u6237\u64cd\u4f5c\u548c OceanBase \u6570\u636e\u5e93\u4e24\u4e2a\u65b9\u9762\u4ecb\u7ecd\u4ea7\u751f\u539f\u56e0\u548c\u89e3\u51b3\u65b9\u6cd5\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u4ece\u7528\u6237\u64cd\u4f5c\u65b9\u9762\u6765\u770b\uff0c\u6709\u5982\u4e0b\u51e0\u79cd\u573a\u666f\u4f1a\u5bfc\u81f4\u4ea7\u751f\u65ad\u8fde\u63a5\uff1a"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u573a\u666f"}),(0,r.jsx)(n.th,{children:"\u9519\u8bef\u7801"}),(0,r.jsx)(n.th,{children:"\u9519\u8bef\u4fe1\u606f"}),(0,r.jsx)(n.th,{children:"\u89e3\u51b3\u65b9\u6cd5"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u96c6\u7fa4\u540d\u9519\u8bef"}),(0,r.jsx)(n.td,{children:"4669"}),(0,r.jsx)(n.td,{children:"cluster xxx does not exist"}),(0,r.jsxs)(n.td,{children:["\u786e\u4fdd\u5bf9\u5e94\u96c6\u7fa4\u5b58\u5728\u4e14\u96c6\u7fa4\u540d\u6b63\u786e\uff0c\u53ef\u76f4\u8fde OBServer \u8282\u70b9\u540e\u6267\u884c ",(0,r.jsx)(n.code,{children:"show parameters like 'cluster';"})," \u547d\u4ee4\u8fdb\u884c\u786e\u8ba4\uff0c\u8f93\u51fa\u4e2d ",(0,r.jsx)(n.code,{children:"value"})," \u503c\u5373\u4e3a\u5f85\u8fde\u63a5\u7684\u96c6\u7fa4\u540d\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u79df\u6237\u540d\u9519\u8bef"}),(0,r.jsx)(n.td,{children:"4043"}),(0,r.jsx)(n.td,{children:"dummy entry is empty, please check if the tenant exists"}),(0,r.jsxs)(n.td,{children:["\u786e\u4fdd\u5bf9\u5e94\u7684\u79df\u6237\u5b58\u5728\uff0c\u53ef\u4f7f\u7528\u7cfb\u7edf\u79df\u6237\uff08root@sys\uff09\u76f4\u8fde OBServer \u8282\u70b9\u540e\u6267\u884c ",(0,r.jsx)(n.code,{children:"SELECT * FROM DBA_OB_TENANTS;"})," \u547d\u4ee4\uff0c\u67e5\u770b\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u79df\u6237\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ODP \u767d\u540d\u5355\u6821\u9a8c\u5931\u8d25"}),(0,r.jsx)(n.td,{children:"8205"}),(0,r.jsx)(n.td,{children:"user xxx@xxx can not pass white list"}),(0,r.jsxs)(n.td,{children:["\u901a\u8fc7\u7ba1\u63a7\u53f0\u786e\u8ba4 ODP \u767d\u540d\u5355\u662f\u5426\u914d\u7f6e\u6b63\u786e\uff0c\u8be6\u7ec6\u64cd\u4f5c\u53ef\u53c2\u89c1 OB Cloud \u4e91\u6570\u636e\u5e93\u6587\u6863 ",(0,r.jsx)(n.a,{href:"https://www.oceanbase.com/docs/common-oceanbase-cloud-1000000000020209",children:"\u767d\u540d\u5355\u5206\u7ec4"}),"\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"OceanBase \u6570\u636e\u5e93\u767d\u540d\u5355\u6821\u9a8c\u5931\u8d25"}),(0,r.jsx)(n.td,{children:"1227"}),(0,r.jsx)(n.td,{children:"Access denied"}),(0,r.jsxs)(n.td,{children:["\u786e\u8ba4 OceanBase \u6570\u636e\u5e93\u767d\u540d\u5355\u662f\u5426\u914d\u7f6e\u6b63\u786e\uff0c\u53ef\u901a\u8fc7\u67e5\u770b ",(0,r.jsx)(n.a,{href:"https://www.oceanbase.com/docs/common-oceanbase-database-cn-1000000000220734",children:"ob_tcp_invited_nodes"})," \u53d8\u91cf\u8fdb\u884c\u786e\u8ba4\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u5ba2\u6237\u7aef\u8fde\u63a5\u6570\u8fbe\u4e0a\u9650"}),(0,r.jsx)(n.td,{children:"5059"}),(0,r.jsx)(n.td,{children:"too many sessions"}),(0,r.jsxs)(n.td,{children:["\u53ef\u901a\u8fc7\u6267\u884c ",(0,r.jsx)(n.code,{children:"ALTER proxyconfig SET <var_name> = <var_value>;"})," \u547d\u4ee4\u8c03\u6574 ODP \u7684\u914d\u7f6e\u9879 ",(0,r.jsx)(n.code,{children:"client_max_connections"})," \u505a\u6682\u65f6\u7684\u89c4\u907f\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ODP \u914d\u7f6e\u8981\u6c42\u4f7f\u7528 SSL \u534f\u8bae\uff0c\u4f46\u662f\u7528\u6237\u53d1\u8d77\u666e\u901a\u534f\u8bae\u8bf7\u6c42"}),(0,r.jsx)(n.td,{children:"8004"}),(0,r.jsx)(n.td,{children:"obproxy is configured to use ssl connection"}),(0,r.jsxs)(n.td,{children:["\u4fee\u6539 SSL \u534f\u8bae\u914d\u7f6e ",(0,r.jsx)(n.code,{children:"enable_client_ssl"})," \u4e3a\u4e0d\u4f7f\u7528 SSL \u534f\u8bae\u8fde\u63a5\uff08\u503c\u4e3a false\uff09\uff1b\u6216\u8005\u4f7f\u7528 SSL \u534f\u8bae\u8bbf\u95ee\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u76f4\u63a5\u8bbf\u95ee proxyro@sys"}),(0,r.jsx)(n.td,{children:"10021"}),(0,r.jsx)(n.td,{children:"user proxyro is rejected while proxyro_check on"}),(0,r.jsx)(n.td,{children:"\u4e0d\u5e94\u76f4\u63a5\u4f7f\u7528 proxyro@sys \u8bbf\u95ee\u6570\u636e\u5e93\u3002"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["\u4e91\u4e0a\u7528\u6237\u5728\u5173\u95ed ",(0,r.jsx)(n.code,{children:"enable_cloud_full_user_name"})," \u7684\u573a\u666f\u4e0b\u4f7f\u7528\u4e09\u6bb5\u5f0f\u8bbf\u95ee"]}),(0,r.jsx)(n.td,{children:"10021"}),(0,r.jsx)(n.td,{children:"connection with cluster name and tenant name is rejected while cloud_full_user_name_check off"}),(0,r.jsxs)(n.td,{children:["\u4e91\u4e0a\u7528\u6237\u5173\u95ed ",(0,r.jsx)(n.code,{children:"enable_cloud_full_user_name"})," \u65f6\uff0cODP \u4f1a\u9650\u5236\u4e09\u6bb5\u5f0f\u7684\u8bbf\u95ee\u3002\u60a8\u53ef\u5f00\u542f ",(0,r.jsx)(n.code,{children:"enable_cloud_full_user_name"})," \u914d\u7f6e\uff0c\u6216\u8005\u4f7f\u7528\u975e\u4e09\u6bb5\u5f0f\u8bbf\u95ee\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"proxyro \u5bc6\u7801\u914d\u7f6e\u9519\u8bef"}),(0,r.jsx)(n.td,{children:"10018"}),(0,r.jsxs)(n.td,{children:["fail to check observer version, proxyro@sys access denied, error resp ",(0,r.jsx)(n.code,{children:"{ code:1045, msg:Access denied for user xxx }"})]}),(0,r.jsxs)(n.td,{children:["\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cproxyro \u7684\u5bc6\u7801\u4e0d\u4f1a\u5b58\u5728\u95ee\u9898\u7684\uff0c\u5982\u679c\u624b\u52a8\u66f4\u6539\u8fc7 OceanBase \u6570\u636e\u5e93\u4e2d proxyro@sys \u7528\u6237\u7684\u5bc6\u7801\uff0c\u8bf7\u786e\u4fdd ODP \u7684\u914d\u7f6e\u9879 ",(0,r.jsx)(n.code,{children:"observer_sys_password"})," \u503c\u548c proxyro@sys \u7528\u6237\u5bc6\u7801\u4e00\u81f4\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u542f\u52a8 ODP \u65f6\u914d\u7f6e\u7684 rootservice_list \u4e0d\u53ef\u7528"}),(0,r.jsx)(n.td,{children:"10018"}),(0,r.jsx)(n.td,{children:"fail to check observer version, empty result"}),(0,r.jsxs)(n.td,{children:["\u8fd9\u91cc\u53ef\u4ee5\u901a\u8fc7\u76f4\u8fde OBServer \u8282\u70b9\uff0c\u901a\u8fc7 ",(0,r.jsx)(n.code,{children:"SHOW PARAMETERS LIKE 'rootservice_list';"})," \u547d\u4ee4\u67e5\u770b OceanBase \u6570\u636e\u5e93\u7684 Root Service\uff0c\u4ee5\u786e\u8ba4 ODP \u542f\u52a8\u65f6\u914d\u7f6e\u7684 server ip \u662f\u5426\u53ef\u7528\u3002"]})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"\u4ece OceanBase \u6570\u636e\u5e93\u65b9\u4fbf\u6765\u770b\uff0c\u6709\u5982\u4e0b\u51e0\u79cd\u573a\u666f\u4f1a\u5bfc\u81f4\u4ea7\u751f\u65ad\u8fde\u63a5\uff1a"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u573a\u666f"}),(0,r.jsx)(n.th,{children:"\u9519\u8bef\u7801"}),(0,r.jsx)(n.th,{children:"\u9519\u8bef\u4fe1\u606f"}),(0,r.jsx)(n.th,{children:"\u89e3\u51b3\u65b9\u6cd5"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u96c6\u7fa4\u4fe1\u606f\u67e5\u8be2\u4e3a\u7a7a"}),(0,r.jsx)(n.td,{children:"4669"}),(0,r.jsx)(n.td,{children:"cluster info is empty"}),(0,r.jsx)(n.td,{children:"\u76f4\u8fde OceanBase \u6570\u636e\u5e93\uff0c\u6267\u884c internal_sql \u5b57\u6bb5\u7684 SQL \u8bed\u53e5\u786e\u8ba4 OceanBase \u6570\u636e\u5e93\u8fd4\u56de\u7684\u96c6\u7fa4\u4fe1\u606f\u662f\u5426\u4e3a\u7a7a\u3002"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"\u96c6\u7fa4\u4fe1\u606f\u67e5\u8be2\u5931\u8d25"}),(0,r.jsx)(n.td,{children:"10018"}),(0,r.jsxs)(n.td,{children:["fail to check observer version",(0,r.jsx)("br",{}),"fail to check cluster info",(0,r.jsx)("br",{}),"fail to init server state"]}),(0,r.jsx)(n.td,{children:"\u76f4\u8fde OceanBase \u6570\u636e\u5e93\uff0c\u6267\u884c internal_sql \u5b57\u6bb5\u7684 SQL \u8bed\u53e5\u786e\u8ba4 OceanBase \u6570\u636e\u5e93\u8fd4\u56de\u7684\u96c6\u7fa4\u4fe1\u606f\u662f\u5426\u4e3a\u7a7a\u3002"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Config Server \u4fe1\u606f\u67e5\u8be2\u5931\u8d25"}),(0,r.jsx)(n.td,{children:"10301"}),(0,r.jsxs)(n.td,{children:["fail to fetch root server list from config server",(0,r.jsx)("br",{}),"fail to fetch root server list from local"]}),(0,r.jsxs)(n.td,{children:["\u53ef\u4ee5\u624b\u52a8\u62c9\u53d6\u542f\u52a8\u65f6\u914d\u7f6e\u7684 Config Server \u7684 URL\uff08",(0,r.jsx)(n.code,{children:"obproxy_config_server_url"})," \u7684\u503c\uff09\uff0c\u786e\u8ba4 Config Server \u8fd4\u56de\u7684\u4fe1\u606f\u662f\u5426\u6b63\u5e38\u3002"]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"\u8d85\u65f6\u65ad\u8fde\u63a5",children:"\u8d85\u65f6\u65ad\u8fde\u63a5"}),"\n",(0,r.jsx)(n.p,{children:"\u8d85\u65f6\u65ad\u8fde\u63a5\u5bf9\u5e94\u7684 trace_type \u4e3a TIMEOUT_TRACE\uff0c\u96c6\u7fa4\u4fe1\u606f\u8fc7\u671f\u5bfc\u81f4\u65ad\u8fde\u63a5\u7684\u8bca\u65ad\u65e5\u5fd7\u793a\u4f8b\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'[2023-08-17 17:10:46.834897] [119826][Y0-00007FBF120324E0] [CONNECTION](trace_type="TIMEOUT_TRACE", connection_diagnosis={cs_id:1031798785, ss_id:7, proxy_session_id:7230691830869983235, server_session_id:3221504994, client_addr:"10.10.10.1:42468", server_addr:"10.10.10.1:21100", cluster_name:"undefined", tenant_name:"sys", user_name:"root", error_code:-10022, error_msg:"OBProxy inactivity timeout", request_cmd:"COM_SLEEP", sql_cmd:"COM_END"}{timeout:1, timeout_event:"CLIENT_DELETE_CLUSTER_RESOURCE", total_time(us):21736})\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u989d\u5916\u8bca\u65ad\u4fe1\u606f\u6709\u5982\u4e0b\u4e24\u6761\u3002"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"timeout_event\uff1a\u8868\u793a\u8d85\u65f6\u4e8b\u4ef6"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"total_time\uff1a\u8868\u793a\u8bf7\u6c42\u6267\u884c\u65f6\u95f4"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u4e0b\u8868\u6839\u636e\u4e0d\u540c\u7684\u8d85\u65f6\u4e8b\u4ef6\u4ecb\u7ecd\u5982\u4f55\u89e3\u51b3\u65ad\u8fde\u63a5\u95ee\u9898\u3002"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u8d85\u65f6\u4e8b\u4ef6"}),(0,r.jsx)(n.th,{children:"\u573a\u666f"}),(0,r.jsx)(n.th,{children:"\u9519\u8bef\u7801"}),(0,r.jsx)(n.th,{children:"\u76f8\u5173\u914d\u7f6e"}),(0,r.jsx)(n.th,{children:"\u89e3\u51b3\u65b9\u6cd5"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"CLIENT_DELETE_CLUSTER_RESOURCE"}),(0,r.jsx)(n.td,{children:"\u96c6\u7fa4\u4fe1\u606f\u53d1\u751f\u53d8\u5316"}),(0,r.jsx)(n.td,{children:"10022"}),(0,r.jsxs)(n.td,{children:["ODP \u914d\u7f6e\u9879 ",(0,r.jsx)(n.a,{href:"https://www.oceanbase.com/docs/common-odp-doc-cn-1000000001601154",children:"cluster_expire_time"})]}),(0,r.jsxs)(n.td,{children:["\u53ef\u4ee5\u901a\u8fc7\u6267\u884c ",(0,r.jsx)(n.code,{children:"ALTER proxyconfig SET <var_name> = <var_value>;"})," \u547d\u4ee4\u8c03\u6574 ODP \u4e2d ",(0,r.jsx)(n.code,{children:"cluster_expire_time"})," \u914d\u7f6e\u9879\u6682\u65f6\u89c4\u907f\uff0c",(0,r.jsx)(n.code,{children:"cluster_expire_time"})," \u914d\u7f6e\u9879\u9ed8\u8ba4\u8fc7\u671f\u65f6\u95f4\u4e3a\u4e00\u5929\uff0c\u65b0\u7684\u8bf7\u6c42\u4f1a\u91cd\u7f6e\u8fc7\u671f\u65f6\u95f4\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"CLIENT_INTERNAL_CMD_TIMEOUT"}),(0,r.jsx)(n.td,{children:"\u5185\u90e8\u8bf7\u6c42\u6267\u884c\u8d85\u65f6"}),(0,r.jsx)(n.td,{children:"10022"}),(0,r.jsx)(n.td,{children:"\u56fa\u5b9a\u65f6\u95f4 30s"}),(0,r.jsx)(n.td,{children:"\u975e\u9884\u671f\u8d85\u65f6\uff0c\u5efa\u8bae\u8054\u7cfb\u6280\u672f\u652f\u6301\u4eba\u5458\u914d\u5408\u8bca\u65ad\u3002"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"CLIENT_CONNECT_TIMEOUT"}),(0,r.jsx)(n.td,{children:"\u5ba2\u6237\u7aef\u4e0e ODP \u5efa\u8fde\u8d85\u65f6"}),(0,r.jsx)(n.td,{children:"10022"}),(0,r.jsx)(n.td,{children:"\u56fa\u5b9a\u65f6\u95f4 10s"}),(0,r.jsx)(n.td,{children:"\u975e\u9884\u671f\u8d85\u65f6\uff0c\u5efa\u8bae\u8054\u7cfb\u6280\u672f\u652f\u6301\u4eba\u5458\u914d\u5408\u8bca\u65ad\u3002"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"CLIENT_NET_READ_TIMEOUT"}),(0,r.jsx)(n.td,{children:"ODP \u7b49\u5f85\u7528\u6237\u8bf7\u6c42\u6570\u636e\u8d85\u65f6"}),(0,r.jsx)(n.td,{children:"10022"}),(0,r.jsxs)(n.td,{children:["OceanBase \u6570\u636e\u5e93\u7cfb\u7edf\u53d8\u91cf ",(0,r.jsx)(n.a,{href:"https://www.oceanbase.com/docs/common-oceanbase-database-cn-1000000000220757",children:"net_read_timeout"})]}),(0,r.jsxs)(n.td,{children:["\u4fee\u6539\u7cfb\u7edf\u53d8\u91cf ",(0,r.jsx)(n.code,{children:"net_read_timeout"}),"\uff0c\u9700\u6ce8\u610f\u4fee\u6539 Global \u7ea7\u522b\u7684\u7cfb\u7edf\u53d8\u91cf\u4e0d\u4f1a\u5bf9\u5df2\u6709\u8fde\u63a5\u751f\u6548\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"CLIENT_NET_WRITE_TIMEOUT"}),(0,r.jsx)(n.td,{children:"ODP \u7b49\u5f85\u56de\u5305\u6570\u636e\u8d85\u65f6"}),(0,r.jsx)(n.td,{children:"10022"}),(0,r.jsxs)(n.td,{children:["OceanBase \u6570\u636e\u5e93\u7cfb\u7edf\u53d8\u91cf ",(0,r.jsx)(n.a,{href:"https://www.oceanbase.com/docs/common-oceanbase-database-cn-1000000000220772",children:"net_write_timeout"})]}),(0,r.jsxs)(n.td,{children:["\u4fee\u6539\u7cfb\u7edf\u53d8\u91cf ",(0,r.jsx)(n.code,{children:"net_write_timeout"}),"\uff0c\u9700\u6ce8\u610f\u4fee\u6539 Global \u7ea7\u522b\u7684\u7cfb\u7edf\u53d8\u91cf\u4e0d\u4f1a\u5bf9\u5df2\u6709\u8fde\u63a5\u751f\u6548\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"CLIENT_WAIT_TIMEOUT"}),(0,r.jsx)(n.td,{children:"\u7528\u6237\u8bf7\u6c42\u8fc7\u7a0b\u4e2d\uff0c\u5ba2\u6237\u7aef\u8fde\u63a5\u957f\u65f6\u95f4\u6ca1\u6709\u53d1\u751f\u4ea4\u4e92\u5bfc\u81f4\u8d85\u65f6"}),(0,r.jsx)(n.td,{children:"10022"}),(0,r.jsxs)(n.td,{children:["OceanBase \u6570\u636e\u5e93\u7cfb\u7edf\u53d8\u91cf ",(0,r.jsx)(n.a,{href:"https://www.oceanbase.com/docs/common-oceanbase-database-cn-1000000000220773",children:"wait_timeout"})]}),(0,r.jsxs)(n.td,{children:["\u4fee\u6539\u7cfb\u7edf\u53d8\u91cf ",(0,r.jsx)(n.code,{children:"wait_timeout"})," \u6682\u65f6\u89c4\u907f\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"SERVER_QUERY_TIMEOUT"}),(0,r.jsx)(n.td,{children:"\u7528\u6237\u8bf7\u6c42\u67e5\u8be2\u8d85\u65f6"}),(0,r.jsx)(n.td,{children:"10022"}),(0,r.jsxs)(n.td,{children:["OceanBase \u6570\u636e\u5e93\u7cfb\u7edf\u53d8\u91cf ",(0,r.jsx)(n.a,{href:"https://www.oceanbase.com/docs/common-oceanbase-database-cn-1000000000220700",children:"ob_query_timeout"}),"\u3001hint \u6307\u5b9a\u7684 ",(0,r.jsx)(n.a,{href:"https://www.oceanbase.com/docs/common-oceanbase-database-cn-1000000000222741",children:"query_timeout"})]}),(0,r.jsxs)(n.td,{children:["\u4fee\u6539\u7cfb\u7edf\u53d8\u91cf ",(0,r.jsx)(n.code,{children:"ob_query_timeout"})," \u6682\u65f6\u89c4\u907f\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"SERVER_TRX_TIMEOUT"}),(0,r.jsx)(n.td,{children:"\u7528\u6237\u4e8b\u52a1\u6267\u884c\u8d85\u65f6"}),(0,r.jsx)(n.td,{children:"10022"}),(0,r.jsxs)(n.td,{children:["OceanBase \u6570\u636e\u5e93\u7cfb\u7edf\u53d8\u91cf ",(0,r.jsx)(n.a,{href:"https://www.oceanbase.com/docs/common-oceanbase-database-cn-1000000000220720",children:"ob_trx_timeout"})]}),(0,r.jsxs)(n.td,{children:["\u4fee\u6539\u7cfb\u7edf\u53d8\u91cf ",(0,r.jsx)(n.code,{children:"ob_trx_timeout"})," \u6682\u65f6\u89c4\u907f\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"SERVER_WAIT_TIMEOUT"}),(0,r.jsx)(n.td,{children:"\u7528\u6237\u8bf7\u6c42\u8fc7\u7a0b\u4e2d\uff0cOceanBase \u6570\u636e\u5e93\u8fde\u63a5\u957f\u65f6\u95f4\u6ca1\u6709\u53d1\u751f\u4ea4\u4e92\u5bfc\u81f4\u8d85\u65f6"}),(0,r.jsx)(n.td,{children:"10022"}),(0,r.jsxs)(n.td,{children:["OceanBase \u6570\u636e\u5e93\u7cfb\u7edf\u53d8\u91cf ",(0,r.jsx)(n.a,{href:"https://www.oceanbase.com/docs/common-oceanbase-database-cn-1000000000220773",children:"wait_timeout"})]}),(0,r.jsxs)(n.td,{children:["\u4fee\u6539\u7cfb\u7edf\u53d8\u91cf ",(0,r.jsx)(n.code,{children:"wait_timeout"})," \u6682\u65f6\u89c4\u907f\u3002"]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"oceanbase-\u6570\u636e\u5e93\u4e3b\u52a8\u65ad\u5f00\u8fde\u63a5",children:"OceanBase \u6570\u636e\u5e93\u4e3b\u52a8\u65ad\u5f00\u8fde\u63a5"}),"\n",(0,r.jsx)(n.p,{children:"OceanBase \u6570\u636e\u5e93\u4e3b\u52a8\u65ad\u5f00\u8fde\u63a5\u5bf9\u5e94\u7684 trace_type \u4e3a SERVER_VC_TRACE\uff0cODP \u4e0e OceanBase \u6570\u636e\u5e93\u5efa\u8fde\u5931\u8d25\u7684\u8bca\u65ad\u65e5\u5fd7\u793a\u4f8b\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'[2023-08-10 23:35:00.132805] [32339][Y0-00007F74C9A244E0] [CONNECTION](trace_type="SERVER_VC_TRACE", connection_diagnosis={cs_id:838860809, ss_id:0, proxy_session_id:7230691830869983240, server_session_id:0, client_addr:"10.10.10.1:45765", server_addr:"", cluster_name:"undefined", tenant_name:"sys", user_name:"root", error_code:-10013, error_msg:"Fail to build connection to observer", request_cmd:"COM_QUERY", sql_cmd:"COM_HANDSHAKE"}{vc_event:"unknown event", total_time(us):2952626, user_sql:"select 1 from dual"})\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u989d\u5916\u8bca\u65ad\u4fe1\u606f\u6709\u5982\u4e0b\u4e09\u6761\u3002"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"vc_event\uff1a\u8868\u793a\u65ad\u8fde\u63a5\u76f8\u5173\u7684\u4e8b\u4ef6\uff0c\u60a8\u65e0\u9700\u592a\u8fc7\u5173\u6ce8"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"total_time\uff1a\u8868\u793a\u8bf7\u6c42\u6267\u884c\u65f6\u95f4"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"user_sql\uff1a\u8868\u793a\u7528\u6237\u8bf7\u6c42"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"OceanBase \u6570\u636e\u5e93\u4e3b\u52a8\u65ad\u8fde\u63a5\u6709\u5982\u4e0b\u51e0\u79cd\u573a\u666f\u3002"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u573a\u666f"}),(0,r.jsx)(n.th,{children:"\u9519\u8bef\u7801"}),(0,r.jsx)(n.th,{children:"\u9519\u8bef\u4fe1\u606f"}),(0,r.jsx)(n.th,{children:"\u89e3\u51b3\u65b9\u6cd5"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ODP \u4e0e OceanBase \u6570\u636e\u5e93\u5efa\u8fde\u5931\u8d25"}),(0,r.jsx)(n.td,{children:"10013"}),(0,r.jsx)(n.td,{children:"Fail to build connection to observer"}),(0,r.jsx)(n.td,{children:"\u9700\u4e0e OceanBase \u6570\u636e\u5e93\u914d\u5408\u8bca\u65ad\u3002"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ODP \u4f20\u8f93\u8bf7\u6c42\u7ed9 OceanBase \u6570\u636e\u5e93\u65f6\u8fde\u63a5\u65ad\u5f00"}),(0,r.jsx)(n.td,{children:"10016"}),(0,r.jsx)(n.td,{children:"An EOS event eceived while proxy transferring request"}),(0,r.jsx)(n.td,{children:"\u9700\u4e0e OceanBase \u6570\u636e\u5e93\u914d\u5408\u8bca\u65ad\u3002"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ODP \u4f20\u8f93 OceanBase \u6570\u636e\u5e93\u56de\u5305\u65f6\u8fde\u63a5\u65ad\u5f00"}),(0,r.jsx)(n.td,{children:"10014"}),(0,r.jsx)(n.td,{children:"An EOS event received while proxy reading response"}),(0,r.jsx)(n.td,{children:"\u9700\u4e0e OceanBase \u6570\u636e\u5e93\u914d\u5408\u8bca\u65ad\u3002"})]})]})]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u8bf4\u660e"}),"\n",(0,r.jsx)(n.p,{children:"OceanBase \u6570\u636e\u5e93\u4e3b\u52a8\u65ad\u8fde\u63a5\u7684\u573a\u666f\u4e0b\uff0cODP \u65e0\u6cd5\u6536\u96c6\u66f4\u4e3a\u8be6\u7ec6\u7684\u4fe1\u606f\uff0c\u5982\u679c ODP \u914d\u7f6e\u7684 OBServer \u8282\u70b9\u72b6\u6001\u6b63\u5e38\uff0c\u5219\u9700\u8981\u914d\u5408 OceanBase \u6570\u636e\u5e93\u7684\u65e5\u5fd7\u8fdb\u884c\u8bca\u65ad\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u5ba2\u6237\u7aef\u4e3b\u52a8\u65ad\u8fde\u63a5",children:"\u5ba2\u6237\u7aef\u4e3b\u52a8\u65ad\u8fde\u63a5"}),"\n",(0,r.jsx)(n.p,{children:"\u5ba2\u6237\u7aef\u4e3b\u52a8\u65ad\u8fde\u63a5\u5bf9\u5e94\u7684 trace_type \u4e3a CLIENT_VC_TRACE\uff0cODP \u8bfb\u8bf7\u6c42\u65f6\u5ba2\u6237\u7aef\u65ad\u5f00\u8fde\u63a5\u7684\u8bca\u65ad\u65e5\u5fd7\u793a\u4f8b\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'[2023-08-10 23:28:24.699168] [32339][Y0-00007F74C9A244E0] [CONNECTION](trace_type="CLIENT_VC_TRACE", connection_diagnosis={cs_id:838860807, ss_id:26, proxy_session_id:7230691830869983239, server_session_id:3221698209, client_addr:"10.10.10.1:44701", server_addr:"10.10.10.1:21100", cluster_name:"undefined", tenant_name:"sys", user_name:"root", error_code:-10010, error_msg:"An EOS event received from client while obproxy reading request", request_cmd:"COM_SLEEP", sql_cmd:"COM_END"}{vc_event:"VC_EVENT_EOS", total_time(us):57637, user_sql:""})\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u989d\u5916\u8bca\u65ad\u4fe1\u606f\u6709\u5982\u4e0b\u4e09\u6761\u3002"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"vc_event\uff1a\u8868\u793a\u65ad\u8fde\u63a5\u76f8\u5173\u7684\u4e8b\u4ef6\uff0c\u60a8\u65e0\u9700\u592a\u8fc7\u5173\u6ce8"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"total_time\uff1a\u8868\u793a\u8bf7\u6c42\u6267\u884c\u65f6\u95f4"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"user_sql\uff1a\u8868\u793a\u7528\u6237\u8bf7\u6c42"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u5ba2\u6237\u7aef\u4e3b\u52a8\u65ad\u8fde\u63a5\u6709\u5982\u4e0b\u51e0\u79cd\u573a\u666f\u3002"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u573a\u666f"}),(0,r.jsx)(n.th,{children:"\u9519\u8bef\u7801"}),(0,r.jsx)(n.th,{children:"\u9519\u8bef\u4fe1\u606f"}),(0,r.jsx)(n.th,{children:"\u89e3\u51b3\u65b9\u6cd5"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ODP \u6536\u53d1\u5305\u65f6\u5ba2\u6237\u7aef\u53d1\u751f\u65ad\u8fde\u63a5"}),(0,r.jsx)(n.td,{children:"10010"}),(0,r.jsx)(n.td,{children:"An EOS event received from client while obproxy reading request"}),(0,r.jsx)(n.td,{children:"\u9700\u5ba2\u6237\u7aef\u914d\u5408\u8bca\u65ad\u3002"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ODP \u5904\u7406\u8bf7\u6c42\u65f6\u5ba2\u6237\u7aef\u65ad\u8fde\u63a5"}),(0,r.jsx)(n.td,{children:"10011"}),(0,r.jsx)(n.td,{children:"An EOS event received from client while obproxy handling response"}),(0,r.jsx)(n.td,{children:"\u9700\u5ba2\u6237\u7aef\u914d\u5408\u8bca\u65ad\u3002"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ODP \u56de\u5305\u65f6\u5ba2\u6237\u7aef\u53d1\u9001\u65ad\u8fde\u63a5"}),(0,r.jsx)(n.td,{children:"10012"}),(0,r.jsx)(n.td,{children:"An EOS event received from client while obproxy transferring response"}),(0,r.jsx)(n.td,{children:"\u9700\u5ba2\u6237\u7aef\u914d\u5408\u8bca\u65ad\u3002"})]})]})]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"\u8bf4\u660e"}),"\n",(0,r.jsx)(n.p,{children:"\u5ba2\u6237\u7aef\u65ad\u8fde\u63a5\u7684\u573a\u666f\u4e0b\uff0cODP \u65e0\u6cd5\u6536\u96c6\u66f4\u4e3a\u8be6\u7ec6\u7684\u4fe1\u606f\uff0c\u53ea\u80fd\u6307\u51fa\u5ba2\u6237\u7aef\u65b9\u9762\u4e3b\u52a8\u65ad\u5f00\u8fde\u63a5\u7684\u64cd\u4f5c\u3002\u6bd4\u8f83\u5e38\u89c1\u7684\u65ad\u8fde\u63a5\u95ee\u9898\u6709\u9a71\u52a8\u8d85\u65f6\u4e3b\u52a8\u65ad\u5f00\u8fde\u63a5\u3001Druid / Hikaricp / Nginx \u7b49\u4e2d\u95f4\u4ef6\u4e3b\u52a8\u65ad\u8fde\u63a5\u3001\u7f51\u7edc\u6296\u52a8\u7b49\u95ee\u9898\uff0c\u5177\u4f53\u60c5\u51b5\u53ef\u4e0e\u5ba2\u6237\u7aef\u914d\u5408\u8bca\u65ad\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"odp-\u6216-oceanbase-\u6570\u636e\u5e93\u5185\u90e8\u9519\u8bef",children:"ODP \u6216 OceanBase \u6570\u636e\u5e93\u5185\u90e8\u9519\u8bef"}),"\n",(0,r.jsx)(n.p,{children:"ODP \u5185\u90e8\u9519\u8bef\u5bf9\u5e94\u7684 trace_type \u4e3a PROXY_INTERNAL_TRACE\uff0cOceanBase \u6570\u636e\u5e93\u5185\u90e8\u9519\u8bef\u5bf9\u5e94\u7684 trace_type \u4e3a SERVER_INTERNAL_TRACE\u3002ODP \u5185\u90e8\u9519\u8bef\u7684\u8bca\u65ad\u65e5\u5fd7\u793a\u4f8b\u5982\u4e0b\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'[2023-08-10 23:26:12.558201] [32339][Y0-00007F74C9A244E0] [CONNECTION](trace_type="PROXY_INTERNAL_TRACE", connection_diagnosis={cs_id:838860805, ss_id:0, proxy_session_id:7230691830869983237, server_session_id:0, client_addr:"10.10.10.1:44379", server_addr:"", cluster_name:"undefined", tenant_name:"sys", user_name:"root", error_code:-10019, error_msg:"OBProxy reached the maximum number of retrying request", request_cmd:"COM_QUERY", sql_cmd:"COM_QUERY"}{user_sql:"USE `\xfd<8f>\xfd<91>\xfd<92>`"})\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u989d\u5916\u8bca\u65ad\u4fe1\u606f\u4e3a ",(0,r.jsx)(n.code,{children:"user_sql"}),"\uff0c\u8868\u793a\u7528\u6237\u8bf7\u6c42 SQL\u3002"]}),"\n",(0,r.jsx)(n.p,{children:"ODP \u6216 OceanBase \u6570\u636e\u5e93\u5185\u90e8\u9519\u8bef\u6709\u5982\u4e0b\u51e0\u79cd\u573a\u666f\u3002"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u8bca\u65ad\u7c7b\u578b"}),(0,r.jsx)(n.th,{children:"\u573a\u666f"}),(0,r.jsx)(n.th,{children:"\u9519\u8bef\u7801"}),(0,r.jsx)(n.th,{children:"\u9519\u8bef\u4fe1\u606f"}),(0,r.jsx)(n.th,{children:"\u89e3\u51b3\u65b9\u6cd5"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"PROXY_INTERNAL_TRACE"}),(0,r.jsx)(n.td,{children:"\u79df\u6237\u5206\u533a\u4fe1\u606f\u67e5\u8be2\u5931\u8d25"}),(0,r.jsx)(n.td,{children:"4664"}),(0,r.jsx)(n.td,{children:"dummy entry is empty, disconnect"}),(0,r.jsxs)(n.td,{children:["\u672a\u9884\u671f\u9519\u8bef\u573a\u666f\uff0c\u60a8\u53ef\u8054\u7cfb\u6280\u672f\u652f\u6301\u4eba\u5458\u534f\u52a9\u6392\u67e5\u6216\u5728\u5f00\u6e90\u5b98\u7f51 ",(0,r.jsx)(n.a,{href:"https://ask.oceanbase.com/",children:"\u95ee\u7b54\u533a"})," \u63d0\u95ee\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"PROXY_INTERNAL_TRACE"}),(0,r.jsx)(n.td,{children:"ODP \u90e8\u5206\u5185\u90e8\u8bf7\u6c42\u6267\u884c\u5931\u8d25"}),(0,r.jsx)(n.td,{children:"10018"}),(0,r.jsx)(n.td,{children:"proxy execute internal request failed, received error resp, error_type: xxx"}),(0,r.jsxs)(n.td,{children:["\u672a\u9884\u671f\u9519\u8bef\u573a\u666f\uff0c\u60a8\u53ef\u8054\u7cfb\u6280\u672f\u652f\u6301\u4eba\u5458\u534f\u52a9\u6392\u67e5\u6216\u5728\u5f00\u6e90\u5b98\u7f51 ",(0,r.jsx)(n.a,{href:"https://ask.oceanbase.com/",children:"\u95ee\u7b54\u533a"})," \u63d0\u95ee\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"PROXY_INTERNAL_TRACE"}),(0,r.jsx)(n.td,{children:"ODP \u91cd\u8bd5\u8bf7\u6c42\u8fbe\u4e0a\u9650"}),(0,r.jsx)(n.td,{children:"10019"}),(0,r.jsx)(n.td,{children:"OBProxy reached the maximum number of retrying request"}),(0,r.jsxs)(n.td,{children:["\u672a\u9884\u671f\u9519\u8bef\u573a\u666f\uff0c\u60a8\u53ef\u8054\u7cfb\u6280\u672f\u652f\u6301\u4eba\u5458\u534f\u52a9\u6392\u67e5\u6216\u5728\u5f00\u6e90\u5b98\u7f51 ",(0,r.jsx)(n.a,{href:"https://ask.oceanbase.com/",children:"\u95ee\u7b54\u533a"})," \u63d0\u95ee\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"PROXY_INTERNAL_TRACE"}),(0,r.jsx)(n.td,{children:"ODP \u76ee\u6807 Session \u88ab\u5173\u95ed"}),(0,r.jsx)(n.td,{children:"10001"}),(0,r.jsx)(n.td,{children:"target session is closed, disconnect"}),(0,r.jsxs)(n.td,{children:["\u672a\u9884\u671f\u9519\u8bef\u573a\u666f\uff0c\u60a8\u53ef\u8054\u7cfb\u6280\u672f\u652f\u6301\u4eba\u5458\u534f\u52a9\u6392\u67e5\u6216\u5728\u5f00\u6e90\u5b98\u7f51 ",(0,r.jsx)(n.a,{href:"https://ask.oceanbase.com/",children:"\u95ee\u7b54\u533a"})," \u63d0\u95ee\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"PROXY_INTERNAL_TRACE"}),(0,r.jsx)(n.td,{children:"\u5176\u4ed6\u672a\u9884\u671f\u7684\u9519\u8bef\u573a\u666f"}),(0,r.jsx)(n.td,{children:"10001"}),(0,r.jsx)(n.td,{children:"\u8bca\u65ad\u4fe1\u606f\u4e3a\u7a7a"}),(0,r.jsxs)(n.td,{children:["\u672a\u9884\u671f\u9519\u8bef\u573a\u666f\uff0c\u60a8\u53ef\u8054\u7cfb\u6280\u672f\u652f\u6301\u4eba\u5458\u534f\u52a9\u6392\u67e5\u6216\u5728\u5f00\u6e90\u5b98\u7f51 ",(0,r.jsx)(n.a,{href:"https://ask.oceanbase.com/",children:"\u95ee\u7b54\u533a"})," \u63d0\u95ee\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"SERVER_INTERNAL_TRACE"}),(0,r.jsx)(n.td,{children:"CheckSum \u6821\u9a8c\u51fa\u9519"}),(0,r.jsx)(n.td,{children:"10001"}),(0,r.jsx)(n.td,{children:"ora fatal error"}),(0,r.jsxs)(n.td,{children:["\u672a\u9884\u671f\u9519\u8bef\u573a\u666f\uff0c\u60a8\u53ef\u8054\u7cfb\u6280\u672f\u652f\u6301\u4eba\u5458\u534f\u52a9\u6392\u67e5\u6216\u5728\u5f00\u6e90\u5b98\u7f51 ",(0,r.jsx)(n.a,{href:"https://ask.oceanbase.com/",children:"\u95ee\u7b54\u533a"})," \u63d0\u95ee\u3002"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"SERVER_INTERNAL_TRACE"}),(0,r.jsx)(n.td,{children:"\u4e3b\u5907\u5e93\u5207\u6362\u573a\u666f"}),(0,r.jsx)(n.td,{children:"10001"}),(0,r.jsx)(n.td,{children:"primary cluster switchover to standby, disconnect"}),(0,r.jsx)(n.td,{children:"\u4e3b\u5907\u5e93\u5207\u6362\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u5b58\u5728\u7684\u65ad\u8fde\u63a5\u95ee\u9898\uff0c\u7b26\u5408\u9884\u671f\u7684\u573a\u666f\u3002"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"\u5176\u4ed6\u573a\u666f",children:"\u5176\u4ed6\u573a\u666f"}),"\n",(0,r.jsx)(n.p,{children:"\u9664\u4e0a\u8ff0\u573a\u666f\u5916\uff0c\u8bca\u65ad\u65e5\u5fd7\u4e2d\u8fd8\u4f1a\u5b58\u5728\u5982\u4e0b\u4e24\u79cd\u7b26\u5408\u9884\u671f\u7684\u573a\u666f\uff0c\u5bf9\u5e94\u7684 trace_type \u4e3a PROXY_INTERNAL_TRACE\u3002"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u573a\u666f"}),(0,r.jsx)(n.th,{children:"\u9519\u8bef\u7801"}),(0,r.jsx)(n.th,{children:"\u9519\u8bef\u4fe1\u606f"}),(0,r.jsx)(n.th,{children:"\u5907\u6ce8"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"kil \u5f53\u524d\u4f1a\u8bdd"}),(0,r.jsx)(n.td,{children:"5065"}),(0,r.jsx)(n.td,{children:"connection was killed by user self, cs_id: xxx"}),(0,r.jsx)(n.td,{children:"\u7b26\u5408\u9884\u671f\u7684\u573a\u666f\uff0c\u8bca\u65ad\u65e5\u5fd7\u4f5c\u8bb0\u5f55\u3002"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"kill \u5176\u4ed6\u4f1a\u8bdd"}),(0,r.jsx)(n.td,{children:"5065"}),(0,r.jsx)(n.td,{children:"connection was killed by user session xxx"}),(0,r.jsx)(n.td,{children:"\u7b26\u5408\u9884\u671f\u7684\u573a\u666f\uff0c\u8bca\u65ad\u65e5\u5fd7\u4f5c\u8bb0\u5f55\u3002"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["\u8bca\u65ad\u65e5\u5fd7\u793a\u4f8b\u5982\u4e0b\uff0c\u989d\u5916\u8bca\u65ad\u4fe1\u606f\u4e3a ",(0,r.jsx)(n.code,{children:"user_sql"}),"\uff0c\u8868\u793a\u7528\u6237\u8bf7\u6c42 SQL\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'[2023-08-10 23:27:15.107427] [32339][Y0-00007F74CAAE84E0] [CONNECTION](trace_type="PROXY_INTERNAL_TRACE", connection_diagnosis={cs_id:838860806, ss_id:21, proxy_session_id:7230691830869983238, server_session_id:3221695443, client_addr:"10.10.10.1:44536", server_addr:"10.10.10.1:21100", cluster_name:"undefined", tenant_name:"sys", user_name:"", error_code:-5065, error_msg:"connection was killed by user self, cs_id: 838860806", request_cmd:"COM_QUERY", sql_cmd:"COM_QUERY"}{user_sql:"kill 838860806"})\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u793a\u4f8b",children:"\u793a\u4f8b"}),"\n",(0,r.jsx)(n.p,{children:"\u5ba2\u6237\u7aef\u8bf7\u6c42\u5230 OceanBase \u6570\u636e\u5e93\u7684\u94fe\u8def\u6bd4\u8f83\u5e38\u89c1\u7684\u6709\u4e0b\u56fe\u4e24\u79cd\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"\u94fe\u8def\u56fe",src:s(97833).A+"",width:"1195",height:"260"})}),"\n",(0,r.jsx)(n.p,{children:"\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u5230 OceanBase \u6570\u636e\u5e93\u4e4b\u95f4\u7684\u94fe\u8def\u9700\u8981\u7ecf\u8fc7\u591a\u4e2a\u8282\u70b9\uff0c\u4efb\u4e00\u8282\u70b9\u51fa\u73b0\u95ee\u9898\u90fd\u6709\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\u65ad\u5f00\u3002\u6240\u4ee5\u5f53\u53d1\u751f\u65ad\u8fde\u63a5\u4e14\u5ba2\u6237\u7aef\u6ca1\u6709\u6536\u5230\u660e\u786e\u7684\u9519\u8bef\u5305\u63d0\u793a\u65ad\u8fde\u63a5\u539f\u56e0\u65f6\uff0c\u6392\u67e5\u65ad\u8fde\u63a5\u95ee\u9898\u9700\u5148\u786e\u5b9a\u65ad\u8fde\u63a5\u65b9\uff0c\u4e4b\u540e\u518d\u6839\u636e\u65ad\u8fde\u63a5\u65b9\u5bf9\u5e94\u6392\u67e5\u65ad\u8fde\u63a5\u539f\u56e0\u3002\u5177\u4f53\u64cd\u4f5c\u5982\u4e0b\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"\u6b65\u9aa4\u4e00\u786e\u5b9a\u65ad\u8fde\u63a5\u65b9",children:"\u6b65\u9aa4\u4e00\uff1a\u786e\u5b9a\u65ad\u8fde\u63a5\u65b9"}),"\n",(0,r.jsxs)(n.p,{children:["\u5982\u679c\u5f53\u524d\u4f7f\u7528\u7684 ODP \u5177\u5907\u8fde\u63a5\u8bca\u65ad\u80fd\u529b\uff0c\u53ef\u901a\u8fc7\u8bca\u65ad\u65e5\u5fd7 ",(0,r.jsx)(n.code,{children:"obproxy_diagnosis.log"})," \u5feb\u901f\u5224\u65ad\u51fa\u73b0\u65ad\u8fde\u63a5\u95ee\u9898\u7684\u4e00\u65b9\u3002\u60a8\u53ef\u6839\u636e\u7528\u6237\u540d\u3001\u79df\u6237\u540d\u3001\u96c6\u7fa4\u540d\u3001\u4ece\u9a71\u52a8\u4e2d\u62ff\u5230\u7684 thread_id\uff08\u5bf9\u5e94\u65e5\u5fd7 cs_id\uff09\u3001\u65ad\u8fde\u63a5\u65f6\u95f4\u7b49\u4fe1\u606f\u4ece\u65e5\u5fd7\u4e2d\u5feb\u901f\u7b5b\u9009\u51fa\u5bf9\u5e94\u7684\u65ad\u8fde\u63a5\u65e5\u5fd7\uff0c\u6839\u636e trace_type \u5b57\u6bb5\u5224\u65ad\u65ad\u8fde\u63a5\u65b9\uff0ctrace_type \u5b57\u6bb5\u548c\u65ad\u8fde\u63a5\u65b9\u7684\u5bf9\u5e94\u60c5\u51b5\u5982\u4e0b\u3002"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"CLIENT_VC_TRACE\uff1a\u5ba2\u6237\u7aef\u65ad\u8fde\u63a5"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"SERVER_VC_TRACE\uff1aOceanBase \u6570\u636e\u5e93\u4e3b\u52a8\u65ad\u5f00\u8fde\u63a5"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"SERVER_INTERNAL_TRACE\uff1aOceanBase \u6570\u636e\u5e93\u5185\u90e8\u9519\u8bef"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"PROXY_INTERNAL_TRACE\uff1aODP \u5185\u90e8\u9519\u8bef"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"LOGIN_TRACE\uff1a\u767b\u5f55\u5931\u8d25"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"TIMEOUT_TRACE\uff1a\u6267\u884c\u8d85\u65f6"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u6b65\u9aa4\u4e8c\u6392\u67e5\u65ad\u8fde\u63a5\u539f\u56e0",children:"\u6b65\u9aa4\u4e8c\uff1a\u6392\u67e5\u65ad\u8fde\u63a5\u539f\u56e0"}),"\n",(0,r.jsx)(n.p,{children:"\u6839\u636e\u4e0d\u540c\u7684\u65ad\u8fde\u63a5\u65b9\uff0c\u6709\u5982\u4e0b\u51e0\u79cd\u4e0d\u540c\u7684\u6392\u67e5\u65b9\u6cd5\u3002"}),"\n",(0,r.jsx)(n.h4,{id:"\u5ba2\u6237\u7aef\u65ad\u8fde\u63a5",children:"\u5ba2\u6237\u7aef\u65ad\u8fde\u63a5"}),"\n",(0,r.jsxs)(n.p,{children:["JDBC \u9ed8\u8ba4\u7684 socketTimeout \u914d\u7f6e\u4e3a 0\uff0c\u5373\u4e0d\u4f1a\u4ea7\u751f socketTimeout \u8d85\u65f6\uff0c\u4f46\u662f\u90e8\u5206\u5ba2\u6237\u7aef\u6bd4\u5982 Druid/MyBatis \u81ea\u8eab\u6709\u63a7\u5236 socketTimeout \u7684\u53c2\u6570\uff0c\u5982\u679c\u53d1\u751f\u8bf7\u6c42\u6267\u884c\u65f6\u95f4\u8fc7\u957f\u5bfc\u81f4\u7684\u65ad\u8fde\u63a5\uff0c\u53ef\u4ee5\u4f18\u5148\u786e\u8ba4 socketTimeout \u7684\u914d\u7f6e\uff0c\u8be6\u7ec6\u4fe1\u606f\u53ef\u53c2\u89c1 OceanBase \u6570\u636e\u5e93\u6587\u6863 ",(0,r.jsx)(n.a,{href:"https://www.oceanbase.com/docs/common-oceanbase-database-cn-1000000000218815",children:"\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u914d\u7f6e"}),"\u3002"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u67e5\u770b\u5bf9\u5e94\u7684 ODP \u8fde\u63a5\u8bca\u65ad\u65e5\u5fd7\uff0c\u786e\u5b9a\u65ad\u8fde\u63a5\u7684\u57fa\u672c\u4fe1\u606f\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'[2023-09-07 15:59:52.308553] [122701][Y0-00007F7071D194E0] [CONNECTION](trace_type="CLIENT_VC_TRACE", connection_diagnosis={cs_id:524328, ss_id:0, proxy_session_id:7230691833961840700, server_session_id:0, client_addr:"10.10.10.1:38877", server_addr:"10.10.10.2:50110", cluster_name:"ob1.changluo.cc.10.10.10.2", tenant_name:"mysql", user_name:"root", error_code:-10011, error_msg:"An unexpected connection event received from client while obproxy handling request", request_cmd:"COM_QUERY", sql_cmd:"COM_QUERY"}{vc_event:"VC_EVENT_EOS", total_time(us):5016353, user_sql:"select sleep(20) from dual"})\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u4e3b\u8981\u8bca\u65ad\u4fe1\u606f\u5982\u4e0b\u3002"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["trace_type: \u793a\u4f8b\u4e2d\u8bca\u65ad\u7c7b\u578b\u4e3a ",(0,r.jsx)(n.code,{children:"CLIENT_VC_TRACE"}),"\uff0c\u53ef\u5224\u65ad\u51fa\u662f\u5ba2\u6237\u7aef\u4e3b\u52a8\u65ad\u5f00\u7684\u8fde\u63a5\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["error_msg : \u793a\u4f8b\u4e2d\u9519\u8bef\u4fe1\u606f\u4e3a ",(0,r.jsx)(n.code,{children:"An unexpected connection event received from client while obproxy handling request"}),"\uff0c\u53ef\u5224\u65ad\u51fa\u5ba2\u6237\u7aef\u5728 ODP \u5904\u7406\u8bf7\u6c42\u65f6\u65ad\u5f00\u8fde\u63a5\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["total_time: \u793a\u4f8b\u4e2d\u8bf7\u6c42\u6267\u884c\u65f6\u95f4\u4e3a ",(0,r.jsx)(n.code,{children:"5016353"}),"\uff0c\u8868\u793a\u8bf7\u6c42\u603b\u7684\u6267\u884c\u65f6\u95f4\u4e3a 5s \u5de6\u53f3\uff0c\u53ef\u4ee5\u901a\u8fc7 total_time \u53bb\u5339\u914d\u5ba2\u6237\u7aef\u7684\u8d85\u65f6\u53c2\u6570\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u6839\u636e ODP \u8fde\u63a5\u8bca\u65ad\u65e5\u5fd7\u4fe1\u606f\u786e\u5b9a\u662f\u5ba2\u6237\u7aef\u4e3b\u52a8\u65ad\u5f00\u4e86\u8fde\u63a5\uff0c\u4ece\u5ba2\u6237\u7aef\u5165\u624b\u6392\u67e5\uff0c\u67e5\u770b JDBC \u5806\u6808\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"The last packet successfully received from the server was 5,016 milliseconds ago.\nThe last packet sent successfully to the server was 5,011 milliseconds ago.\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n        at java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n        at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)\n        at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1129)\n        at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3720)\n        at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3609)\n        at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:4160)\n        at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2617)\n        at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2778)\n        at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2819)\n        at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2768)\n        at com.mysql.jdbc.StatementImpl.execute(StatementImpl.java:949)\n        at com.mysql.jdbc.StatementImpl.execute(StatementImpl.java:795)\n        at odp.Main.main(Main.java:12)\nCaused by: java.net.SocketTimeoutException: Read timed out\n        at java.net.SocketInputStream.socketRead0(Native Method)\n        at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)\n        at java.net.SocketInputStream.read(SocketInputStream.java:170)\n        at java.net.SocketInputStream.read(SocketInputStream.java:141)\n        at com.mysql.jdbc.util.ReadAheadInputStream.fill(ReadAheadInputStream.java:114)\n        at com.mysql.jdbc.util.ReadAheadInputStream.readFromUnderlyingStreamIfNecessary(ReadAheadInputStream.java:161)\n        at com.mysql.jdbc.util.ReadAheadInputStream.read(ReadAheadInputStream.java:189)\n        at com.mysql.jdbc.MysqlIO.readFully(MysqlIO.java:3163)\n        at com.mysql.jdbc.MysqlIO.reuseAndReadPacket(MysqlIO.java:3620)\n     9 more\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u4ece\u5806\u6808\u4ee5\u53ca\u6536\u53d1\u5305\u65f6\u95f4\u53ef\u5927\u81f4\u5224\u65ad\u51fa\u793a\u4f8b\u4e2d\u4e3a socketTimeout \u89e6\u53d1\u7684\u95ee\u9898\u3002"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"odp-\u65ad\u8fde\u63a5",children:"ODP \u65ad\u8fde\u63a5"}),"\n",(0,r.jsxs)(n.p,{children:["ODP \u4f1a\u8bfb\u53d6 OceanBase \u6570\u636e\u5e93\u8bbe\u7f6e\u7684 ",(0,r.jsx)(n.code,{children:"net_write_timeout"})," \u914d\u7f6e\uff0c\u63a7\u5236\u6536\u5305\u548c\u53d1\u5305\u65f6\u4f20\u5305\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u8be5\u914d\u7f6e\u9ed8\u8ba4\u65f6\u95f4\u4e3a 60s\u3002\u5f53\u7f51\u7edc\u73af\u5883\u6bd4\u8f83\u6781\u7aef\u6216\u8005 OceanBase \u6570\u636e\u5e93\u56de\u5305\u5904\u7406\u8f83\u6162\u65f6\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0 ODP \u7b49\u5f85\u56de\u5305\u6570\u636e\u8d85\u65f6\u65ad\u8fde\u63a5\u7684\u95ee\u9898\u3002\u6b64\u5904\u4ee5 ODP \u7b49\u5f85\u56de\u5305\u6570\u636e\u8d85\u65f6\u573a\u666f\u4e3a\u4f8b\u4ecb\u7ecd\u5982\u4f55\u6392\u67e5\u65ad\u8fde\u63a5\u539f\u56e0\u3002"]}),"\n",(0,r.jsx)(n.p,{children:"\u6839\u636e ODP \u65ad\u8fde\u63a5\u8bca\u65ad\u65e5\u5fd7\u5224\u65ad\u65ad\u8fde\u63a5\u65b9\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'[2023-09-08 01:22:17.229436] [81506][Y0-00007F455197E4E0] [CONNECTION](trace_type="TIMEOUT_TRACE", connection_diagnosis={cs_id:1031798827, ss_id:342, proxy_session_id:7230691830869983244, server_session_id:3221753829, client_addr:"10.10.10.1:34901", server_addr:"10.10.10.1:21102", cluster_name:"undefined", tenant_name:"mysql", user_name:"root", error_code:-10022, error_msg:"OBProxy inactivity timeout", request_cmd:"COM_QUERY", sql_cmd:"COM_QUERY"}{timeout(us):6000000, timeout_event:"CLIENT_NET_WRITE_TIMEOUT", total_time(us):31165295})\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u4e3b\u8981\u8bca\u65ad\u4fe1\u606f\u5982\u4e0b\u3002"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["trace_type: \u793a\u4f8b\u4e2d\u8bca\u65ad\u7c7b\u578b\u4e3a ",(0,r.jsx)(n.code,{children:"TIMEOUT_TRACE"}),"\uff0c \u53ef\u5224\u65ad\u51fa\u662f\u56e0\u4e3a ODP \u6267\u884c\u8d85\u65f6\u5bfc\u81f4\u65ad\u8fde\u63a5\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["timeout_event: \u793a\u4f8b\u4e2d\u8d85\u65f6\u4e8b\u4ef6\u4e3a ",(0,r.jsx)(n.code,{children:"CLIENT_NET_WRITE_TIMEOUT"}),"\uff0c\u53ef\u5224\u65ad\u51fa ODP \u56e0\u4e3a\u7b49\u5f85\u56de\u5305\u6570\u636e\u8d85\u65f6\u800c\u53d1\u751f\u65ad\u8fde\u63a5\u3002"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u6839\u636e\u8bca\u65ad\u4fe1\u606f\u53ef\u4ee5\u786e\u5b9a\u89e6\u53d1\u4e86 net_write_timeout\uff0c\u5ba2\u6237\u7aef\u8fde\u63a5\u7b49\u5f85\u6570\u636e\u8d85\u8fc7 6s\uff08\u975e\u9ed8\u8ba4\u503c\uff09\uff0c\u5bfc\u81f4\u8fde\u63a5\u65ad\u5f00\uff0c\u901a\u8fc7\u4fee\u6539\u7cfb\u7edf\u53d8\u91cf\u5ef6\u957f\u8d85\u65f6\u9650\u5236\u53ef\u6682\u65f6\u89c4\u907f\u3002"}),"\n",(0,r.jsx)(n.h4,{id:"\u767b\u5f55\u5931\u8d25",children:"\u767b\u5f55\u5931\u8d25"}),"\n",(0,r.jsx)(n.p,{children:"\u6b64\u5904\u4ee5\u4e24\u79cd\u573a\u666f\u4ecb\u7ecd\u5982\u4f55\u6392\u67e5\u65ad\u8fde\u63a5\u539f\u56e0\u3002"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u4ee5 rootservice_list \u6307\u5b9a\u7684 OBServer \u8282\u70b9\u4e0d\u53ef\u7528\u4e3a\u4f8b\u4ecb\u7ecd\u5982\u4f55\u6392\u67e5\u65ad\u8fde\u63a5\u539f\u56e0\uff0c\u8fde\u63a5\u8bca\u65ad\u65e5\u5fd7\u5982\u4e0b\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'[2023-09-08 10:37:21.028960] [90663][Y0-00007F8EB76544E0] [CONNECTION](trace_type="LOGIN_TRACE", connection_diagnosis={cs_id:1031798785, ss_id:0, proxy_session_id:0, server_session_id:0, client_addr:"10.10.10.1:44018", server_addr:"*Not IP address [0]*:0", cluster_name:"undefined", tenant_name:"sys", user_name:"root", error_code:-10018, error_msg:"fail to check observer version, empty result", request_cmd:"COM_SLEEP", sql_cmd:"COM_LOGIN"}{internal_sql:"SELECT ob_version() AS cluster_version"})\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u4e3b\u8981\u8bca\u65ad\u4fe1\u606f\u5982\u4e0b\u3002"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["trace_type\uff1a\u793a\u4f8b\u4e2d\u8bca\u65ad\u7c7b\u578b\u4e3a ",(0,r.jsx)(n.code,{children:"LOGIN_TRACE"}),"\uff0c\u53ef\u786e\u5b9a\u662f\u767b\u5f55\u5931\u8d25\u7684\u95ee\u9898\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["internal_sql\uff1a\u793a\u4f8b\u4e2d ODP \u5f53\u524d\u6267\u884c\u7684\u5185\u90e8\u8bf7\u6c42\u4e3a ",(0,r.jsx)(n.code,{children:"SELECT ob_version() AS cluster_version"}),"\uff0c\u53ef\u786e\u5b9a\u767b\u5f55\u8fc7\u7a0b\u4e2d ODP \u6267\u884c\u8be5\u5185\u90e8\u8bf7\u6c42\u5931\u8d25\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["error_msg\uff1a\u793a\u4f8b\u4e2d\u9519\u8bef\u4fe1\u606f\u4e3a ",(0,r.jsx)(n.code,{children:"fail to check observer version, empty result"}),"\uff0c\u53ef\u786e\u5b9a\u5185\u90e8\u8bf7\u6c42\u5931\u8d25\u7684\u539f\u56e0\u4e3a\u7ed3\u679c\u96c6\u4e3a\u7a7a\u3002"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u8bca\u65ad\u4fe1\u606f\u603b\u7ed3\u5373\u4e3a\uff1aODP \u6267\u884c\u5185\u90e8\u8bf7\u6c42 ",(0,r.jsx)(n.code,{children:"SELECT ob_version() AS cluster_version"})," \u5931\u8d25\uff0c\u7ed3\u679c\u96c6\u4e3a\u7a7a\u3002",(0,r.jsx)(n.code,{children:"SELECT ob_version() AS cluster_version"})," \u8fd9\u6761 SQL \u662f ODP \u67e5\u8be2\u96c6\u7fa4\u7248\u672c\u7684\u8bf7\u6c42\uff0c\u5728\u60a8\u9996\u6b21\u767b\u5f55\u65f6 ODP \u4f1a\u6267\u884c\u8fd9\u6761\u8bf7\u6c42\u6821\u9a8c\u96c6\u7fa4\u4fe1\u606f\uff0c\u5f53 ODP \u542f\u52a8\u65f6\u914d\u7f6e\u7684 rootservice_list \u9519\u8bef\u6216\u8005 OBServer \u8282\u70b9\u5b95\u673a\u65f6\uff0cODP \u67e5\u8be2\u5931\u8d25\uff0c\u4fbf\u4f1a\u5bfc\u81f4\u767b\u5f55\u5931\u8d25\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u4ee5\u5ba2\u6237\u7aef\u8fde\u63a5\u8fbe\u5230 ODP \u4e0a\u9650\u4e3a\u4f8b\u4ecb\u7ecd\u5982\u4f55\u6392\u67e5\u65ad\u8fde\u63a5\u539f\u56e0\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u5ba2\u6237\u7aef\u8fde\u63a5\u8fbe\u5230 ODP \u4e0a\u7ebf\u5bfc\u81f4\u65ad\u8fde\u63a5\u6709\u5982\u4e0b\u4e24\u79cd\u6392\u67e5\u65b9\u6cd5\u3002"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u65b9\u6cd5\u4e00\uff1a\u6392\u67e5\u8fde\u63a5\u8bca\u65ad\u65e5\u5fd7\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'[2023-09-08 11:19:26.617385] [110562][Y0-00007FE1F06AC4E0] [CONNECTION](trace_type="LOGIN_TRACE", connection_diagnosis={cs_id:1031798805, ss_id:0, proxy_session_id:0, server_session_id:0, client_addr:"127.0.0.1:40004", server_addr:"*Not IP address [0]*:0", cluster_name:"undefined", tenant_name:"sys", user_name:"root", error_code:-5059, error_msg:"Too many sessions", request_cmd:"COM_SLEEP", sql_cmd:"COM_LOGIN"}{internal_sql:""})\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u4e3b\u8981\u8bca\u65ad\u4fe1\u606f\u5982\u4e0b\u3002"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["trace_type\uff1a\u793a\u4f8b\u4e2d\u8bca\u65ad\u7c7b\u578b\u4e3a ",(0,r.jsx)(n.code,{children:"LOGIN_TRACE"}),"\uff0c\u53ef\u786e\u5b9a\u662f\u767b\u5f55\u5931\u8d25\u7684\u95ee\u9898\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["error_msg\uff1a\u793a\u4f8b\u4e2d\u9519\u8bef\u4fe1\u606f\u4e3a ",(0,r.jsx)(n.code,{children:"Too many session"}),"\uff0c\u53ef\u786e\u5b9a\u662f\u56e0\u4e3a\u8fde\u63a5\u6570\u8fbe\u5230\u4e0a\u9650\u5bfc\u81f4\u767b\u5f55\u5931\u8d25\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["\u65b9\u6cd5\u4e8c\uff1a\u76f4\u63a5\u6839\u636e\u9519\u8bef\u5305\u5224\u65ad\uff0c\u6267\u884c\u8fde\u63a5\u547d\u4ee4\uff0c\u8f93\u51fa ",(0,r.jsx)(n.code,{children:"Too many sessions"}),"\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"$ obclient -h127.0.0.1 -P2899 -uroot@sys -Dtest -A -c \nERROR 1203 (42000): Too many sessions\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},97833:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/001-5e7b43587e7137e785432f90d804b333.png"},28453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>l});var r=s(96540);const d={},c=r.createContext(d);function i(e){const n=r.useContext(c);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:i(e.components),r.createElement(c.Provider,{value:n},e.children)}}}]);