"use strict";(self.webpackChunkmy_docs_website=self.webpackChunkmy_docs_website||[]).push([[4784],{9060:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>t,metadata:()=>o,toc:()=>d});var r=s(4848),l=s(8453);const t={title:"\u5e38\u7528\u64cd\u4f5c",weight:1},i="\u5e38\u7528\u64cd\u4f5c",o={id:"user_manual/user_best_practices/operation_maintenance/common_operation",title:"\u5e38\u7528\u64cd\u4f5c",description:"\u521b\u5efa\u79df\u6237",source:"@site/docs/user_manual/user_best_practices/operation_maintenance/common_operation.md",sourceDirName:"user_manual/user_best_practices/operation_maintenance",slug:"/user_manual/user_best_practices/operation_maintenance/common_operation",permalink:"/docs/user_manual/user_best_practices/operation_maintenance/common_operation",draft:!1,unlisted:!1,editUrl:"https://github.com/oceanbase/oceanbase.github.io/tree/main/docs/user_manual/user_best_practices/operation_maintenance/common_operation.md",tags:[],version:"current",frontMatter:{title:"\u5e38\u7528\u64cd\u4f5c",weight:1},sidebar:"legacySidebar",previous:{title:"\u96c6\u7fa4\u8d44\u6e90\u5347\u914d",permalink:"/docs/user_manual/user_best_practices/operation_maintenance/cluster_resource_upgrade"},next:{title:"\u5e38\u7528\u53c2\u6570\u914d\u7f6e",permalink:"/docs/user_manual/user_best_practices/operation_maintenance/common_parameter"}},c={},d=[{value:"<strong>\u521b\u5efa\u79df\u6237</strong>",id:"\u521b\u5efa\u79df\u6237",level:2},{value:"<strong>\u8fde\u63a5\u6570\u636e\u5e93</strong>",id:"\u8fde\u63a5\u6570\u636e\u5e93",level:2},{value:"<strong>\u53c2\u6570\u548c\u53d8\u91cf</strong>",id:"\u53c2\u6570\u548c\u53d8\u91cf",level:2},{value:"<strong>RootService \u5207\u4e3b</strong>",id:"rootservice-\u5207\u4e3b",level:2},{value:"<strong>\u6e05\u7406\u79df\u6237\u5e76\u91ca\u653e\u7a7a\u95f4</strong>",id:"\u6e05\u7406\u79df\u6237\u5e76\u91ca\u653e\u7a7a\u95f4",level:2},{value:"<strong>\u666e\u901a\u7528\u6237\u79df\u6237\u67e5\u770b\u81ea\u5df1\u79df\u6237\u4e0b\u6240\u6709\u7684\u8868</strong>",id:"\u666e\u901a\u7528\u6237\u79df\u6237\u67e5\u770b\u81ea\u5df1\u79df\u6237\u4e0b\u6240\u6709\u7684\u8868",level:2},{value:"<strong>\u6e05\u7406 OBD \u7ba1\u7406\u7684\u96c6\u7fa4\u4fe1\u606f</strong>",id:"\u6e05\u7406-obd-\u7ba1\u7406\u7684\u96c6\u7fa4\u4fe1\u606f",level:2},{value:"<strong>\u65e5\u5fd7\u6253\u5370\u76f8\u5173</strong>",id:"\u65e5\u5fd7\u6253\u5370\u76f8\u5173",level:2},{value:"<strong>\u8c03\u6574\u65e5\u5fd7\u6587\u4ef6\u4ee5\u53ca\u8bb0\u5f55\u6570\u91cf</strong>",id:"\u8c03\u6574\u65e5\u5fd7\u6587\u4ef6\u4ee5\u53ca\u8bb0\u5f55\u6570\u91cf",level:3},{value:"<strong>\u8c03\u6574\u6162\u67e5\u8be2\u65e5\u5fd7\u8bb0\u5f55\u914d\u7f6e</strong>",id:"\u8c03\u6574\u6162\u67e5\u8be2\u65e5\u5fd7\u8bb0\u5f55\u914d\u7f6e",level:3},{value:"<strong>OBProxy \u65e5\u5fd7\u6253\u5370</strong>",id:"obproxy-\u65e5\u5fd7\u6253\u5370",level:3},{value:"<strong>SQL \u5e76\u884c\u6267\u884c</strong>",id:"sql-\u5e76\u884c\u6267\u884c",level:2}];function a(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"\u5e38\u7528\u64cd\u4f5c",children:(0,r.jsx)(n.strong,{children:"\u5e38\u7528\u64cd\u4f5c"})}),"\n",(0,r.jsx)(n.h2,{id:"\u521b\u5efa\u79df\u6237",children:(0,r.jsx)(n.strong,{children:"\u521b\u5efa\u79df\u6237"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u65b9\u6cd5\u4e00\uff1aOCP \u521b\u5efa"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\u786e\u8ba4\u53ef\u5206\u914d\u8d44\u6e90"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u5177\u4f53\u53ef\u4ee5\u5206\u914d\u591a\u5c11\u5185\u5b58\uff0c\u53ef\u4ee5\u901a\u8fc7\u3010\u8d44\u6e90\u7ba1\u7406\u3011\u67e5\u770b\u5404\u8282\u70b9\u7684\u5269\u4f59\u8d44\u6e90\n",(0,r.jsx)(n.img,{alt:"image.png",src:s(8810).A+"",width:"1118",height:"647"}),"\n2. \u65b0\u5efa\u79df\u6237"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image.png",src:s(9921).A+"",width:"1103",height:"620"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"\u586b\u5199\u79df\u6237\u4fe1\u606f"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"image.png",src:s(6056).A+"",width:"1101",height:"662"})}),"\n",(0,r.jsx)(n.p,{children:"zone \u4f18\u5148\u7ea7\u4e3b\u8981\u662f primary_zone \u8bbe\u7f6e leader\u4f18\u5148\u7ea7\uff0c\u5982\u679c\u4f18\u5148\u7ea7\u5168\u90e8\u76f8\u540c\uff0c\u90a3\u4e48 leader \u4f1a\u6253\u6563\u5230\u6240\u6709\u8282\u70b9\u4e0a\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u65b9\u6cd5\u4e8c\uff1a\u624b\u52a8\u521b\u5efa"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\u786e\u8ba4\u53ef\u5206\u914d\u8d44\u6e90"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u65b0\u79df\u6237\u53ef\u4ee5\u5206\u914d\u7684\u5185\u5b58\u5927\u5c0f\u4e3a memory_limit - system_memory - sys \u79df\u6237\u5185\u5b58\uff0cCPU \u6570\u91cf\u4e3a cpu_count - sys \u79df\u6237 cpu\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# \u67e5\u8be2\u53c2\u6570\nshow parameters where name in ('memory_limit','system_memory','cpu_count');\n# \u67e5\u8be2 sys \u79df\u6237\u8d44\u6e90\nselect * from DBA_OB_UNIT_CONFIGS;\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"\u521b\u5efa\u79df\u6237"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# \u521b\u5efa\u8d44\u6e90\u89c4\u683c\uff0c5C14G\uff0c\u65e5\u5fd740G\uff0cIOPS 10000000\u3002\ncreate resource unit unit_1 max_cpu 5, min_cpu 5, memory_size '15G', log_disk_size '50G', max_iops 10000000;\n# \u521b\u5efa\u8d44\u6e90\u6c60\uff0c\u6307\u5b9a \u8d44\u6e90\u89c4\u683c\u4ee5\u53ca zone_list\u3002\ncreate resource pool pool_1 unit = 'unit_1', unit_num = 1, zone_list = ('zone1','zone2','zone3');\n# \u521b\u5efa\u79df\u6237\uff0c\u6307\u5b9a\u526f\u672c\u6570\u91cf3\uff0cprimary_zone\uff0c\u4ee5\u53ca\u8d44\u6e90\u6c60\u548c\u767d\u540d\u5355\u3002\ncreate tenant perf replica_num = 3,primary_zone='RANDOM', resource_pool_list=('pool_1') set ob_tcp_invited_nodes='%';\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"\u4fee\u6539 root \u7528\u6237\u5bc6\u7801"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u521b\u5efa\u5b8c\u79df\u6237\uff0c\u9ed8\u8ba4\u7684 root \u5bc6\u7801\u4e3a\u7a7a\uff0c\u5982\u679c\u9700\u8981\u53ef\u4ee5\u4fee\u6539\u5bc6\u7801\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# \u79df\u6237\u7684 root \u7528\u6237\u767b\u9646\u540e\u6267\u884c\u4fee\u6539 sql\nset password for root=password('xxx');\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u8fde\u63a5\u6570\u636e\u5e93",children:(0,r.jsx)(n.strong,{children:"\u8fde\u63a5\u6570\u636e\u5e93"})}),"\n",(0,r.jsx)(n.p,{children:"\u4e3b\u8981\u6709\u4e24\u79cd\u8fde\u63a5\u65b9\u5f0f\uff1a"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\u901a\u8fc7 OBServer \u76f4\u8fde\uff08\u9ed8\u8ba4\u7aef\u53e3 2881\uff09"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"mysql -h xxx.xxx.xxx.xxx -uroot@sys -P2881 -p -c -A oceanbase\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"\u901a\u8fc7 OBProxy \u8fde\u63a5\uff08\u9ed8\u8ba4\u7aef\u53e32883\uff09"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"mysql -h xxx.xxx.xxx.xxx -uroot@sys#obdemo -P2883 -p -c -A oceanbase\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u4f7f\u7528 OBProxy \u8fde\u63a5\u65f6\uff0c\u7528\u6237\u4fe1\u606f\u9700\u8981\u5305\u62ec\u3010\u7528\u6237\u540d@\u79df\u6237\u540d#\u96c6\u7fa4\u540d\u3011\uff1b\u5982\u679c\u662f OBServer \u8fde\u63a5\uff0c\u90a3\u4e48\u53ea\u9700\u8981\u5305\u62ec\u3010\u7528\u6237\u540d@\u79df\u6237\u540d\u3011\u3002"}),"\n",(0,r.jsx)(n.h2,{id:"\u53c2\u6570\u548c\u53d8\u91cf",children:(0,r.jsx)(n.strong,{children:"\u53c2\u6570\u548c\u53d8\u91cf"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u533a\u522b\uff1a"})}),"\n",(0,r.jsx)(n.p,{children:"\u53c2\u6570\uff08parameter\uff09\u53ef\u4ee5\u63a7\u5236\u96c6\u7fa4\u7684\u8d1f\u8f7d\u5747\u8861\u3001\u5408\u5e76\u65f6\u95f4\u3001\u5408\u5e76\u65b9\u5f0f\u3001\u8d44\u6e90\u5206\u914d\u548c\u6a21\u5757\u5f00\u5173\u7b49\u529f\u80fd\uff0c\u4e3b\u8981\u9488\u5bf9\u96c6\u7fa4\u3001Zone\u3001OBServer \u548c \u79df\u6237\u7ea7\u522b\u8fdb\u884c\u914d\u7f6e\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u53d8\u91cf\uff08variable\uff09\u53ef\u4ee5\u63a7\u5236\u6570\u636e\u5e93\u7cfb\u7edf\u7684\u5404\u79cd\u884c\u4e3a\uff0c\u5982\u7f13\u5b58\u5927\u5c0f\u3001\u5e76\u53d1\u8fde\u63a5\u6570\u7b49\uff0c\u4e3b\u8981\u662f\u9488\u5bf9\u79df\u6237\u7ea7\u522b\u5185 Global \u548c Session \u7ea7\u522b\u8fdb\u884c\u8bbe\u7f6e\u3002"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u67e5\u770b\u53c2\u6570\u548c\u53d8\u91cf"})}),"\n",(0,r.jsx)(n.p,{children:"OBServer \u53c2\u6570 \uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# \u65b9\u6cd5\u4e00\nshow parameters like '%enable_rebalance%';\n# \u65b9\u6cd5\u4e8c\nshow parameters where name in ('memstore_limit_percentage','freeze_trigger_percentage','writing_throttling_trigger_percentage');\n# \u65b9\u6cd5\u4e09\nselect * from oceanbase.GV$OB_PARAMETERS where NAME in ('memstore_limit_percentage','freeze_trigger_percentage','writing_throttling_trigger_percentage');\n"})}),"\n",(0,r.jsx)(n.p,{children:"OBProxy \u53c2\u6570\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"show proxyconfig like '%query_digest_time_threshold%';\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u67e5\u770b\u53d8\u91cf"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"show variables like '%timeout%';\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u4fee\u6539\u53c2\u6570\u548c\u53d8\u91cf"})}),"\n",(0,r.jsx)(n.p,{children:"\u8981\u6ce8\u610f\uff0c\u8fd9\u91cc\u7684\u53c2\u6570\u4fee\u6539\u4f1a\u81ea\u52a8\u53d8\u66f4\u5230\u5b89\u88c5\u76ee\u5f55\u7684 etc \u4e0b\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u4f46\u662f\u5982\u679c\u662f OBD \u521b\u5efa\u7684\u96c6\u7fa4\uff0c\u4e0d\u4f1a\u81ea\u52a8\u540c\u6b65\u5230 OBD \u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u5982\u679c\u540e\u7eed\u9700\u8981\u4f7f\u7528 OBD \u91cd\u542f\uff0c\u90a3\u4e48\u9700\u8981\u624b\u52a8\u4fee\u6539 OBD \u7684\u914d\u7f6e\uff0c\u9632\u6b62\u542f\u52a8\u540e\u914d\u7f6e\u6709\u5dee\u5f02\u5f71\u54cd\u4e1a\u52a1\u3002"}),"\n",(0,r.jsx)(n.p,{children:"OBServer \u53c2\u6570 \uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"alter system set enable_rebalance=False;\n"})}),"\n",(0,r.jsx)(n.p,{children:"OBProxy \u53c2\u6570\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"alter proxyconfig set query_digest_time_threshold='101ms';\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u4fee\u6539\u53d8\u91cf\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# \u8bbe\u7f6e\u5168\u5c40\u7ea7\u522b\u53d8\u91cf\uff0c\u5f53\u524d session \u4e0d\u751f\u6548\uff0c\u65b0 session \u751f\u6548\u3002\nset global ob_query_timeout=10000000;\n# \u8bbe\u7f6e\u4f1a\u8bdd\u7ea7\u522b\u53d8\u91cf\uff0c\u5f53\u524d session \u751f\u6548\uff0c\u5176\u4ed6 session \u4e0d\u751f\u6548\u3002\nset session ob_query_timeout=10000000;\n"})}),"\n",(0,r.jsx)(n.h2,{id:"rootservice-\u5207\u4e3b",children:(0,r.jsx)(n.strong,{children:"RootService \u5207\u4e3b"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- \u64cd\u4f5c\nALTER SYSTEM SWITCH REPLICA leader LS=1 SERVER='\u76ee\u6807ip:rpc_port' TENANT ='sys';\n-- \u5b9e\u4f8b\nALTER SYSTEM SWITCH REPLICA leader LS=1 SERVER ='x.x.x.x:2882' TENANT ='sys'\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u6e05\u7406\u79df\u6237\u5e76\u91ca\u653e\u7a7a\u95f4",children:(0,r.jsx)(n.strong,{children:"\u6e05\u7406\u79df\u6237\u5e76\u91ca\u653e\u7a7a\u95f4"})}),"\n",(0,r.jsxs)(n.p,{children:["\u901a\u8fc7\u6e05\u7406\u79df\u6237\u91ca\u653e\u7a7a\u95f4\u65f6\u9700\u5148\u6267\u884c ",(0,r.jsx)(n.code,{children:"drop tenant xxx force;"})," \u547d\u4ee4\u5220\u9664\u79df\u6237\uff0c\u518d\u6267\u884c ",(0,r.jsx)(n.code,{children:"drop resource pool xxx;"})," \u547d\u4ee4\u5220\u9664\u5bf9\u5e94\u7684\u8d44\u6e90\u6c60\uff0c\u4e24\u6761\u547d\u4ee4\u5747\u6210\u529f\u6267\u884c\u624d\u7b97\u91ca\u653e\u7a7a\u95f4\u3002"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u6ce8\u610f"})}),"\n",(0,r.jsx)(n.p,{children:"\u8be5\u64cd\u4f5c\u4f1a\u6e05\u7406\u79df\u6237\u4e0b\u7684\u6240\u6709\u6570\u636e\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u666e\u901a\u7528\u6237\u79df\u6237\u67e5\u770b\u81ea\u5df1\u79df\u6237\u4e0b\u6240\u6709\u7684\u8868",children:(0,r.jsx)(n.strong,{children:"\u666e\u901a\u7528\u6237\u79df\u6237\u67e5\u770b\u81ea\u5df1\u79df\u6237\u4e0b\u6240\u6709\u7684\u8868"})}),"\n",(0,r.jsx)(n.p,{children:"\u60a8\u53ef\u901a\u8fc7\u5982\u4e0b\u547d\u4ee4\u67e5\u8be2\u8868\u7c7b\u578b\uff0c\u4e4b\u540e\u6839\u636e\u8868\u7c7b\u578b\u67e5\u8be2\u8868\u540d\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- \u67e5\u8be2\u8868\u7c7b\u578b\nselect distinct(OBJECT_TYPE) from DBA_OBJECTS;  \n-- \u6839\u636e\u8868\u7c7b\u578b\u67e5\u8868\u540d\nselect OBJECT_NAME from DBA_OBJECTS where OBJECT_TYPE='table' ;\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u6e05\u7406-obd-\u7ba1\u7406\u7684\u96c6\u7fa4\u4fe1\u606f",children:(0,r.jsx)(n.strong,{children:"\u6e05\u7406 OBD \u7ba1\u7406\u7684\u96c6\u7fa4\u4fe1\u606f"})}),"\n",(0,r.jsx)(n.p,{children:"\u5f53 OBD \u7ba1\u7406\u7684\u96c6\u7fa4\u88ab\u9500\u6bc1\u540e\uff0c\u76f4\u63a5\u5220\u9664 OBD \u4e2d\u8be5\u96c6\u7fa4\u7684\u5b58\u50a8\u4fe1\u606f\u5373\u53ef\u5f7b\u5e95\u6e05\u7406\u8be5\u96c6\u7fa4\uff0c\u6709\u5982\u4e0b\u4e24\u79cd\u65b9\u6cd5\u3002"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["\u65b9\u6cd5\u4e00\uff1a\u60a8\u53ef\u6267\u884c ",(0,r.jsx)(n.code,{children:"obd cluster list"})," \u547d\u4ee4\u67e5\u770b\u96c6\u7fa4\u6240\u5728\u7684\u76ee\u5f55\uff0c\u901a\u8fc7 rm \u547d\u4ee4\u6e05\u7406\u76ee\u5f55\u5373\u53ef\uff0c\u793a\u4f8b\u5982\u4e0b\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"[admin@obtest ~]$ obd cluster list\n+----------------------------------------------------------------------+\n|                             Cluster List                             |\n+-------------+--------------------------------------+-----------------+\n| Name        | Configuration Path                   | Status (Cached) |\n+-------------+--------------------------------------+-----------------+\n| test1       | /home/admin/.obd/cluster/test1       | destroyed       |\n| myoceanbase | /home/admin/.obd/cluster/myoceanbase | running         |\n+-------------+--------------------------------------+-----------------+\n\n[admin@obtest ~]$ rm -rf /home/admin/.obd/cluster/test1\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["\u65b9\u6cd5\u4e8c\uff1a\u60a8\u53ef\u901a\u8fc7 ",(0,r.jsx)(n.code,{children:"cd  ~/.obd/cluster"})," \u547d\u4ee4\u8fdb\u5165\u5230 OBD \u7684\u96c6\u7fa4\u4fe1\u606f\u76ee\u5f55\u4e0b\uff0c\u5220\u9664\u5bf9\u5e94\u7684 Name \u76ee\u5f55\uff0c\u793a\u4f8b\u5982\u4e0b\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"[admin@obtest ~]$ cd ~/.obd/cluster/\n[admin@obtest cluster]$ ll\ntotal 12\ndrwxr-xr-x 2 admin admin 4096 Jun  1 12:04 myoceanbase\ndrwxr-xr-x 2 admin admin 4096 May 26 14:22 test1\n\n[admin@obtest ~]$ rm -rf test1\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u65e5\u5fd7\u6253\u5370\u76f8\u5173",children:(0,r.jsx)(n.strong,{children:"\u65e5\u5fd7\u6253\u5370\u76f8\u5173"})}),"\n",(0,r.jsx)(n.h3,{id:"\u8c03\u6574\u65e5\u5fd7\u6587\u4ef6\u4ee5\u53ca\u8bb0\u5f55\u6570\u91cf",children:(0,r.jsx)(n.strong,{children:"\u8c03\u6574\u65e5\u5fd7\u6587\u4ef6\u4ee5\u53ca\u8bb0\u5f55\u6570\u91cf"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- \u5f00\u542f\u65e5\u5fd7\u56de\u6536\nalter system set enable_syslog_recycle=true\n-- \u5173\u95ed wf \u65e5\u5fd7\u6253\u5370\nalter system set enable_syslog_wf=false\n-- \u9650\u5236\u65e5\u5fd7\u4e2a\u6570\uff0c\u6309\u9700\u8c03\u6574\uff08\u5355\u4e2a\u65e5\u5fd7 256M\uff09\nalter system set max_syslog_file_count=10\n-- \u8bbe\u7f6e\u7cfb\u7edf\u65e5\u5fd7\u7ea7\u522b\nsyslog_level (DEBUG/TRACE/INFO/WARN/USER_ERR/ERROR)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u8c03\u6574\u6162\u67e5\u8be2\u65e5\u5fd7\u8bb0\u5f55\u914d\u7f6e",children:(0,r.jsx)(n.strong,{children:"\u8c03\u6574\u6162\u67e5\u8be2\u65e5\u5fd7\u8bb0\u5f55\u914d\u7f6e"})}),"\n",(0,r.jsx)(n.p,{children:"SQL \u6267\u884c\u65f6\u95f4\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u8d85\u8fc7 1s \u5c31\u4f1a\u8bb0\u5f55\u5230 observer.log \u65e5\u5fd7\u6216\u8005\u5728 OCP \u767d\u5c4f\u76d1\u63a7\u6709\u8bb0\u5f55\u3002"}),"\n",(0,r.jsxs)(n.p,{children:["\u8be5\u914d\u7f6e\u53d7\u79df\u6237\u53c2\u6570 ",(0,r.jsx)(n.code,{children:"trace_log_slow_query_watermark"})," \u63a7\u5236\uff0c\u53ef\u901a\u8fc7\u5982\u4e0b\u547d\u4ee4\u4fee\u6539\u914d\u7f6e\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- \u67e5\u770b\u53c2\u6570\u914d\u7f6e\nshow parameters like '%trace_log_slow_query_watermark%';\n-- \u4fee\u6539\u53c2\u6570\nalter system set trace_log_slow_query_watermark='2s';\n"})}),"\n",(0,r.jsx)(n.h3,{id:"obproxy-\u65e5\u5fd7\u6253\u5370",children:(0,r.jsx)(n.strong,{children:"OBProxy \u65e5\u5fd7\u6253\u5370"})}),"\n",(0,r.jsx)(n.p,{children:"\u60a8\u53ef\u901a\u8fc7\u7cfb\u7edf\u79df\u6237\uff08root@sys\uff09\u6216\u8005 root@proxysys \u8fde\u63a5\u96c6\u7fa4\u4fee\u6539 OBProxy \u65e5\u5fd7\u6253\u5370\u76f8\u5173\u914d\u7f6e\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- \u67e5\u8be2\u53c2\u6570\nshow proxyconfig like '%log_file_percentage%';\n-- \u4fee\u6539\u53c2\u6570\nalter proxyconfig set log_file_percentage=75;\n"})}),"\n",(0,r.jsx)(n.p,{children:"OBProxy \u65e5\u5fd7\u76f8\u5173\u53c2\u6570\u5982\u4e0b\u8868\u6240\u793a\u3002"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"\u53c2\u6570"}),(0,r.jsx)(n.th,{children:"\u9ed8\u8ba4\u503c"}),(0,r.jsx)(n.th,{children:"\u53d6\u503c\u8303\u56f4"}),(0,r.jsx)(n.th,{children:"\u89e3\u91ca"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"log_file_percentage"})}),(0,r.jsx)(n.td,{children:"80"}),(0,r.jsx)(n.td,{children:"[0, 100]"}),(0,r.jsx)(n.td,{children:"OBProxy \u65e5\u5fd7\u767e\u5206\u6bd4\u9608\u503c\uff0c\u8d85\u8fc7\u9608\u503c\u5373\u8fdb\u884c\u65e5\u5fd7\u6e05\u7406\u3002"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"log_dir_size_threshold"})}),(0,r.jsx)(n.td,{children:"64GB"}),(0,r.jsx)(n.td,{children:"[256MB, 1T]"}),(0,r.jsx)(n.td,{children:"OBProxy \u65e5\u5fd7\u5927\u5c0f\u9608\u503c\u3002\u8d85\u8fc7\u9608\u503c\u5373\u8fdb\u884c\u65e5\u5fd7\u6e05\u7406\u3002"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"max_log_file_size"})}),(0,r.jsx)(n.td,{children:"256MB"}),(0,r.jsx)(n.td,{children:"[1MB, 1G]"}),(0,r.jsx)(n.td,{children:"\u5355\u4e2a\u65e5\u5fd7\u6587\u4ef6\u7684\u6700\u5927\u5c3a\u5bf8\u3002"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"syslog_level"})}),(0,r.jsx)(n.td,{children:"INFO"}),(0,r.jsx)(n.td,{children:"DEBUG, TRACE, INFO, WARN, USER_ERR, ERROR"}),(0,r.jsx)(n.td,{children:"\u65e5\u5fd7\u7ea7\u522b\u3002"})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"sql-\u5e76\u884c\u6267\u884c",children:(0,r.jsx)(n.strong,{children:"SQL \u5e76\u884c\u6267\u884c"})}),"\n",(0,r.jsx)(n.p,{children:"\u60a8\u53ef\u901a\u8fc7\u589e\u52a0\u5e76\u884c\u52a0\u5feb\u7d22\u5f15\u521b\u5efa\uff0c\u5177\u4f53\u547d\u4ee4\u5982\u4e0b\u6240\u793a\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- \u589e\u52a0 SQL \u6267\u884c\u5185\u5b58\u767e\u5206\u6bd4\nSET GLOBAL OB_SQL_WORK_AREA_PERCENTAGE = 30; \n-- \u8bbe\u7f6e DDL \u5e76\u884c\u5ea6\nSET SESSION _FORCE_PARALLEL_DDL_DOP = 32;\n-- \u5e76\u884c\u5ea6\u589e\u52a0\u9700\u8981\u8bbe\u7f6e\u8be5\u53c2\u6570\uff0c\u6bd4\u6240\u6709\u5e76\u884c\u5ea6\u548c\u5927\u5373\u53ef\nSET GLOBAL PARALLEL_SERVERS_TARGET = 64;\n"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u8bf4\u660e"})}),"\n",(0,r.jsx)(n.p,{children:"\u6301\u7eed\u66f4\u65b0\u4e2d\uff0c\u656c\u8bf7\u671f\u5f85..."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8810:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/p1-7f6418e617f6406a4ff034efd17469e5.png"},9921:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/p2-16586b3467da32df2f3677b93fff5ef0.png"},6056:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/p3-ae25684a39e82f6ada3c1f5350ea0954.png"},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>o});var r=s(6540);const l={},t=r.createContext(l);function i(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);