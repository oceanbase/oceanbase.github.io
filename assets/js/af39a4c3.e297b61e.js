"use strict";(self.webpackChunkmy_docs_website=self.webpackChunkmy_docs_website||[]).push([[2959],{38350:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>r,toc:()=>l});var s=t(74848),c=t(28453);const a={title:"Character Set Usage Specifications",weight:1},i=void 0,r={id:"user_manual/operation_and_maintenance/en-US/development_specification/charset_specification",title:"Character Set Usage Specifications",description:"Note:",source:"@site/docs/user_manual/operation_and_maintenance/en-US/development_specification/02_charset_specification.md",sourceDirName:"user_manual/operation_and_maintenance/en-US/development_specification",slug:"/user_manual/operation_and_maintenance/en-US/development_specification/charset_specification",permalink:"/docs/user_manual/operation_and_maintenance/en-US/development_specification/charset_specification",draft:!1,unlisted:!1,editUrl:"https://github.com/oceanbase/oceanbase.github.io/tree/main/docs/user_manual/operation_and_maintenance/en-US/development_specification/02_charset_specification.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Character Set Usage Specifications",weight:1},sidebar:"operation_and_maintenanceEnglishSidebar",previous:{title:"Database Object Design and Usage Specifications",permalink:"/docs/user_manual/operation_and_maintenance/en-US/development_specification/object_specification"},next:{title:"SQL Development Specifications",permalink:"/docs/user_manual/operation_and_maintenance/en-US/development_specification/sql_specification"}},o={},l=[{value:"Basic Knowledge",id:"basic-knowledge",level:2},{value:"Character set",id:"character-set",level:3},{value:"Collation",id:"collation",level:3},{value:"Set Character Sets for Database Objects",id:"set-character-sets-for-database-objects",level:2},{value:"Set the Client (Link) Character Set",id:"set-the-client-link-character-set",level:2},{value:"Set the Client Character Set",id:"set-the-client-character-set",level:2},{value:"Indexes Do Not Work When Columns with Different Collations Are Joined",id:"indexes-do-not-work-when-columns-with-different-collations-are-joined",level:2}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Note:"}),"\n",(0,s.jsxs)(n.p,{children:["At present, ",(0,s.jsx)(n.em,{children:"OceanBase Advanced Tutorial for DBAs"})," applies only to MySQL tenants of OceanBase Database Community Edition. Features of Oracle tenants of OceanBase Database Enterprise Edition are not described in this topic. For more information about the differences between the two editions, see ",(0,s.jsx)(n.a,{href:"https://en.oceanbase.com/docs/common-oceanbase-database-10000000001714481",children:"Differences between Enterprise Edition and Community Edition"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"basic-knowledge",children:"Basic Knowledge"}),"\n",(0,s.jsx)(n.p,{children:"This section describes two terms: character set and collation. If you have understood the terms, you can ignore the section."}),"\n",(0,s.jsx)(n.h3,{id:"character-set",children:"Character set"}),"\n",(0,s.jsx)(n.p,{children:"To put it simply, character sets define how characters are encoded and stored. Here are some examples:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["If the character set is ",(0,s.jsx)(n.code,{children:"utf8"}),', the uppercase letter "A" is encoded as the byte 0100 0001, which is represented as 0x41 in hexadecimal.']}),"\n",(0,s.jsxs)(n.li,{children:["If the character set is ",(0,s.jsx)(n.code,{children:"utf16"}),', the uppercase letter "A" is encoded as two bytes 0000 0100 0000 0001, which is represented as 0x0041 in hexadecimal.']}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Different character sets support storage of different types and ranges of characters. For example, the ",(0,s.jsx)(n.code,{children:"utf8"})," character set can store all Unicode characters, whereas the ",(0,s.jsx)(n.code,{children:"latin1"})," character set supports storage of only characters from Western European languages."]}),"\n",(0,s.jsx)(n.h3,{id:"collation",children:"Collation"}),"\n",(0,s.jsxs)(n.p,{children:["A collation is an attribute of character sets. It defines a set of rules for comparing and sorting characters. For example, the ",(0,s.jsx)(n.code,{children:"utf8mb4"})," character set supports collations such as ",(0,s.jsx)(n.code,{children:"utf8mb4_general_ci"}),", ",(0,s.jsx)(n.code,{children:"utf8mb4_bin"}),", and ",(0,s.jsx)(n.code,{children:"utf8mb4_unicode_ci"}),"."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"utf8mb4_general_ci"}),": the case-insensitive general collation of ",(0,s.jsx)(n.code,{children:"utf8mb4"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"utf8mb4_bin"}),": the case-sensitive binary collation of ",(0,s.jsx)(n.code,{children:"utf8mb4"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"utf8mb4_unicode_ci"}),": the Unicode-based case-insensitive collation of ",(0,s.jsx)(n.code,{children:"utf8mb4"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"utf8mb4"})," also supports collations for different languages, such as ",(0,s.jsx)(n.code,{children:"utf8mb4_zh_pinyin_ci"}),", which sorts data by Pinyin."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["A character set can have multiple collations. However, a collation belongs to only one character set. For example, if you define a column as ",(0,s.jsx)(n.code,{children:"c3 varchar(200) COLLATE utf8mb4_bin"}),", the character set of the column is automatically set to ",(0,s.jsx)(n.code,{children:"utf8mb4"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"set-character-sets-for-database-objects",children:"Set Character Sets for Database Objects"}),"\n",(0,s.jsx)(n.p,{children:"This section describes the specifications for setting character sets in OceanBase Database."}),"\n",(0,s.jsxs)(n.p,{children:["You can set character sets at the tenant, database, table, column, or session level. OceanBase Database supports character sets such as ",(0,s.jsx)(n.code,{children:"utf8mb4"}),", ",(0,s.jsx)(n.code,{children:"gbk"}),", ",(0,s.jsx)(n.code,{children:"gb18030"}),", ",(0,s.jsx)(n.code,{children:"binary"}),", ",(0,s.jsx)(n.code,{children:"utf16"}),", and ",(0,s.jsx)(n.code,{children:"latin1"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"obclient [test]> show charset;\n+--------------+-----------------------+-------------------------+--------+\n| Charset      | Description           | Default collation       | Maxlen |\n+--------------+-----------------------+-------------------------+--------+\n| binary       | Binary pseudo charset | binary                  |      1 |\n| utf8mb4      | UTF-8 Unicode         | utf8mb4_general_ci      |      4 |\n| gbk          | GBK charset           | gbk_chinese_ci          |      2 |\n| utf16        | UTF-16 Unicode        | utf16_general_ci        |      2 |\n| gb18030      | GB18030 charset       | gb18030_chinese_ci      |      4 |\n| latin1       | cp1252 West European  | latin1_swedish_ci       |      1 |\n| gb18030_2022 | GB18030-2022 charset  | gb18030_2022_chinese_ci |      4 |\n+--------------+-----------------------+-------------------------+--------+\n7 rows in set (0.008 sec)\n\nobclient [test]> show collation;;\n+-------------------------+--------------+-----+---------+----------+---------+\n| Collation               | Charset      | Id  | Default | Compiled | Sortlen |\n+-------------------------+--------------+-----+---------+----------+---------+\n| utf8mb4_general_ci      | utf8mb4      |  45 | Yes     | Yes      |       1 |\n| utf8mb4_bin             | utf8mb4      |  46 |         | Yes      |       1 |\n| binary                  | binary       |  63 | Yes     | Yes      |       1 |\n| gbk_chinese_ci          | gbk          |  28 | Yes     | Yes      |       1 |\n| gbk_bin                 | gbk          |  87 |         | Yes      |       1 |\n| utf16_general_ci        | utf16        |  54 | Yes     | Yes      |       1 |\n| utf16_bin               | utf16        |  55 |         | Yes      |       1 |\n| gb18030_chinese_ci      | gb18030      | 248 | Yes     | Yes      |       1 |\n| gb18030_bin             | gb18030      | 249 |         | Yes      |       1 |\n| latin1_swedish_ci       | latin1       |   8 | Yes     | Yes      |       1 |\n| latin1_bin              | latin1       |  47 |         | Yes      |       1 |\n| gb18030_2022_bin        | gb18030_2022 | 216 |         | Yes      |       1 |\n| gb18030_2022_chinese_ci | gb18030_2022 | 217 | Yes     | Yes      |       1 |\n| gb18030_2022_chinese_cs | gb18030_2022 | 218 |         | Yes      |       1 |\n| gb18030_2022_radical_ci | gb18030_2022 | 219 |         | Yes      |       1 |\n| gb18030_2022_radical_cs | gb18030_2022 | 220 |         | Yes      |       1 |\n| gb18030_2022_stroke_ci  | gb18030_2022 | 221 |         | Yes      |       1 |\n| gb18030_2022_stroke_cs  | gb18030_2022 | 222 |         | Yes      |       1 |\n+-------------------------+--------------+-----+---------+----------+---------+\n18 rows in set (0.007 sec)\n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Note:"}),"\n",(0,s.jsxs)(n.p,{children:["To support seamless migration, OceanBase Database recognizes ",(0,s.jsx)("code",{children:"UTF8"})," as a synonym of ",(0,s.jsx)("code",{children:"UTF8MB4"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"You cannot modify the database character set."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["In the following examples, the ",(0,s.jsx)(n.code,{children:"gbk"})," character set is used:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Set the character set when you create a tenant"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Select ",(0,s.jsx)(n.strong,{children:"gbk"})," as the character set when you create a tenant in OceanBase Cloud Platform (OCP)."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"image",src:t(52112).A+"",width:"3812",height:"1970"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Add ",(0,s.jsx)(n.code,{children:'"charset=gbk"'})," in the ",(0,s.jsx)(n.code,{children:"create tenant"})," statement to set the character set."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"create tenant zlatan replica_num = 1,\n    resource_pool_list =('pool1'),\n    charset = gbk\n        set\n        ob_tcp_invited_nodes = '%',\n        ob_compatibility_mode = 'mysql',\n        parallel_servers_target = 10,\n        ob_sql_work_area_percentage = 20,\n        secure_file_priv = \"\";\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"You can also specify a character set and collation when you create a database, table, or column. If not specified, the character set and collation of the higher-level database object are used. The object levels, from highest to lowest, are tenant, database, table, and column."})}),"\n",(0,s.jsx)(n.p,{children:"The syntax for creating these database objects will not be described in this section."}),"\n",(0,s.jsx)(n.h2,{id:"set-the-client-link-character-set",children:"Set the Client (Link) Character Set"}),"\n",(0,s.jsx)(n.p,{children:"The client (link) character set is used for the interaction between the client and the server."}),"\n",(0,s.jsx)(n.p,{children:"The client sends SQL statements to the server for execution. The server then returns the execution results to the client."}),"\n",(0,s.jsx)(n.p,{children:"In this process, the server must recognize the character set used by the client to correctly parse and execute the SQL statements and return the execution results."}),"\n",(0,s.jsx)(n.p,{children:"In different environments, the client can be OceanBase Command-Line Client (OBClient), Java Database Connectivity (JDBC), or Oracle Call Interface (OCI). The client character set is also called the link character set."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"The tenant character set and the client character set are independent of each other."}),"\n",(0,s.jsxs)(n.p,{children:["A tenant with the ",(0,s.jsx)(n.code,{children:"gbk"})," character set can be accessed by a client with the ",(0,s.jsx)(n.code,{children:"gbk"})," or ",(0,s.jsx)(n.code,{children:"utf8"})," character set."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["If the client character set is ",(0,s.jsx)(n.code,{children:"gbk"}),", the server parses and executes the received SQL statements based on ",(0,s.jsx)(n.code,{children:"gbk"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["If the client character set is ",(0,s.jsx)(n.code,{children:"utf8"}),", the server parses and executes the received SQL statements based on ",(0,s.jsx)(n.code,{children:"utf8"}),"."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Configuration methods"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Permanent configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"set global character_set_client = gbk;\nset global character_set_connection = gbk;\nset global character_set_results = gbk;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"character_set_client"}),": the client character set."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"character_set_connection"}),": the connection character set."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"character_set_results"}),": the character set of the results returned by the server to the client."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["In most cases, the strings sent by the client to the server and those returned by the server to the client use the same character set. In MySQL mode, these three variables are provided for flexible configuration. ",(0,s.jsx)(n.strong,{children:(0,s.jsx)("font",{color:"red",children:"In general scenarios, you can set the three variables to the client character set"})}),"."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Temporary configuration (valid only for the current session)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Method 1:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"set character_set_client = gbk;\nset character_set_connection = gbk;\nset character_set_results = gbk;\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Method 2:"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"set names gbk;\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"set-the-client-character-set",children:"Set the Client Character Set"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["When you use the JDBC driver to connect to an OceanBase database, add ",(0,s.jsx)(n.code,{children:"characterEncoding=gbk"})," to the URL to create a GBK link."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:'String url = "jdbc:oceanbase://xxx.xxx.xxx.xxx:xxxx?useSSL=false&useUnicode=true&characterEncoding=gbk&connectTimeout=30000&rewriteBatchedStatements=true";\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["When you use OBClient to connect to an OceanBase database, we recommend that you use the ",(0,s.jsx)(n.code,{children:"zh_CN.GB18030"})," superset of ",(0,s.jsx)(n.code,{children:"zh_CN.GBK"})," for the bash environment variables of the GBK link."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Modify the bash environment variables."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"export LANG=zh_CN.GB18030\nexport LC_ALL=zh_CN.GB18030\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Modify the character set configuration of the terminal to set the character set of the current window to ",(0,s.jsx)(n.code,{children:"gbk"}),". Follow the instructions on the terminal."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Notice"}),"\n",(0,s.jsx)(n.p,{children:"You must set the client and driver accordingly. Otherwise, garbled characters may occur."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"indexes-do-not-work-when-columns-with-different-collations-are-joined",children:"Indexes Do Not Work When Columns with Different Collations Are Joined"}),"\n",(0,s.jsxs)(n.p,{children:["As reported by many users in the community, indexes cannot be used for joining two columns with the same data type (such as ",(0,s.jsx)(n.code,{children:"varchar"}),") and the same character set."]}),"\n",(0,s.jsxs)(n.p,{children:["This issue usually occurs when different database administrators (DBAs) create the table and columns and set different collations for them. For more information about how to analyze and troubleshoot the issue, see ",(0,s.jsx)(n.a,{href:"https://oceanbase.github.io/docs/blogs/tech/failure-by-collation",children:"SQL Tuning Practices - Index Failure Caused by Collations"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:(0,s.jsx)("font",{color:"red",children:"Note that if tables in the production environment are created by different DBAs, you must check the collations set for these tables when using them. Otherwise, query performance may be compromised due to non-optimal plans. "})})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:(0,s.jsx)("font",{color:"red",children:"If you have no special requirements, we recommend that you set the same collation for columns to be joined when creating them. "})})})]})}function d(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},52112:(e,n,t)=>{t.d(n,{A:()=>s});const s=t.p+"assets/images/001-cebbb7dabcee6d9c45a941940b2a8f31.png"},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>r});var s=t(96540);const c={},a=s.createContext(c);function i(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:i(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);