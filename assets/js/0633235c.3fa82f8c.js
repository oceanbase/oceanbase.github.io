"use strict";(self.webpackChunkmy_docs_website=self.webpackChunkmy_docs_website||[]).push([[6962],{53519:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var s=n(74848),t=n(28453);const i={slug:"trading-system",title:"Practice of Applying OceanBase Database in a Futures Company\u2018s Production Environment",tags:["User Case"]},r="Practice of Applying OceanBase Database in a Futures Company's Production Environment",o={id:"blogs/users/trading-system",title:"Practice of Applying OceanBase Database in a Futures Company\u2018s Production Environment",description:"Introduction",source:"@site/docs/blogs/users/trading-system.md",sourceDirName:"blogs/users",slug:"/blogs/users/trading-system",permalink:"/docs/blogs/users/trading-system",draft:!1,unlisted:!1,editUrl:"https://github.com/oceanbase/oceanbase.github.io/tree/main/docs/blogs/users/trading-system.md",tags:[{inline:!0,label:"User Case",permalink:"/docs/tags/user-case"}],version:"current",frontMatter:{slug:"trading-system",title:"Practice of Applying OceanBase Database in a Futures Company\u2018s Production Environment",tags:["User Case"]},sidebar:"blogsSidebar",previous:{title:"Momo \u2014\u2014 Exploration and practice of persistent cache based on OceanBase KV storage",permalink:"/docs/blogs/users/momo"},next:{title:"Handling Two Trading Scenarios with One OceanBase Cluster",permalink:"/docs/blogs/users/two-trading-one-cluster"}},c={},d=[];function l(e){const a={h1:"h1",header:"header",p:"p",strong:"strong",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.header,{children:(0,s.jsx)(a.h1,{id:"practice-of-applying-oceanbase-database-in-a-futures-companys-production-environment",children:"Practice of Applying OceanBase Database in a Futures Company's Production Environment"})}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.strong,{children:"Introduction"})}),"\n",(0,s.jsx)(a.p,{children:"As the financial industry evolves and markets grow increasingly complex, futures trading systems face challenges such as handling massive transaction volumes, ensuring low latency, and maintaining system reliability. Conventional standalone and distributed databases are struggling to keep up. Futures companies and exchanges have been looking for next-generation distributed database technologies to boost the scalability, reliability, and performance of their systems. OceanBase Database, a distributed database system developed by Alibaba Group, is becoming a key part of the infrastructure in the financial sector, particularly for futures trading systems, thanks to its high availability, performance, and scalability."}),"\n",(0,s.jsx)(a.p,{children:"In this article, we'll explore how a futures company runs its core trading system on OceanBase Database, covering everything from database architecture design to performance optimization, transaction management, and fault recovery."}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.strong,{children:"1. Background and Requirements"})}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.strong,{children:"1.1 Unique demands of futures trading systems"})}),"\n",(0,s.jsx)(a.p,{children:"As irreplaceable components of financial markets, futures trading systems must provide some key features:"}),"\n",(0,s.jsx)(a.p,{children:"High concurrency: Futures markets are where highly frequent transactions take place, especially during periods of high volatility when transaction requests can reach millions per second."}),"\n",(0,s.jsx)(a.p,{children:"Low latency: Speed is everything in futures trading. Even the slightest delay can have a significant impact on trade execution."}),"\n",(0,s.jsx)(a.p,{children:"High availability and disaster recovery: Futures trading systems must be highly available and capable of recovering quickly from disasters, as a short downtime can result in substantial financial losses."}),"\n",(0,s.jsx)(a.p,{children:"Strong consistency: With large amounts of funds and real-time market data updates involved, futures trading systems must ensure strong data consistency and the atomicity of transactions."}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.strong,{children:"1.2 Challenges for conventional databases"})}),"\n",(0,s.jsx)(a.p,{children:"Conventional relational databases, with their single-node architecture and vertical scaling mode, struggle to cope with highly concurrent transactions and massive amounts of data. Here are some of the issues they face:"}),"\n",(0,s.jsx)(a.p,{children:"Performance bottlenecks: As the data volume and concurrency increase, conventional databases experience poorer query and write performance, leading to response lags of databases and delays in transaction processing."}),"\n",(0,s.jsx)(a.p,{children:"Scalability issues: When traffic soars, conventional standalone databases can hardly be scaled horizontally."}),"\n",(0,s.jsx)(a.p,{children:"Poor fault recovery: Conventional databases often rely on a primary/standby model. If the primary node fails, manual intervention is required to switch services to the standby nodes, which may result in prolonged downtime and reduced availability."}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.strong,{children:"1.3 Why OceanBase Database"})}),"\n",(0,s.jsx)(a.p,{children:"OceanBase Database, as a distributed relational database system, offers several benefits that address the shortcomings of their conventional cousins:"}),"\n",(0,s.jsx)(a.p,{children:"High concurrency support: The distributed architecture of OceanBase Database can be scaled horizontally in a moment, making it ideal for high-concurrency trading scenarios."}),"\n",(0,s.jsx)(a.p,{children:"Low latency: Through table sharding and optimized query paths, OceanBase Database controls the response time in milliseconds."}),"\n",(0,s.jsx)(a.p,{children:"High availability and disaster recovery: With its multi-replica mechanism and automatic failover capabilities, OceanBase Database ensures high availability even in the event of node failures."}),"\n",(0,s.jsx)(a.p,{children:"Strong consistency: OceanBase Database supports distributed transactions, ensuring data consistency across nodes, which is critical for the accuracy of futures trading systems."}),"\n",(0,s.jsx)(a.p,{children:"Given these benefits, the futures company decided to migrate its core trading system to OceanBase Database, aiming to solve issues related to scalability, performance, and fault recovery."}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.strong,{children:"2. OceanBase Database's Role in the Architecture of the Futures Trading System"})}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.strong,{children:"2.1 Overview"})}),"\n",(0,s.jsx)(a.p,{children:"In the architecture of the futures trading system, OceanBase Database is deployed at the database layer to store and manage all trading data, market data, fund data, and user account information. The system architecture consists of the following layers:"}),"\n",(0,s.jsx)(a.p,{children:"(1) Frontend trading layer: This layer includes user trading terminals and order processing modules. It receives trading requests from users and passes them through message queues to the core trading engine."}),"\n",(0,s.jsx)(a.p,{children:"(2) Core trading engine: This layer handles the actual trading logic, such as order matching, trade execution, and risk control. It interacts with OceanBase Database through database interfaces."}),"\n",(0,s.jsx)(a.p,{children:"(3) Database layer: In this layer, OceanBase Database stores and manages all trading-related data, such as order information, trade records, and position data."}),"\n",(0,s.jsx)(a.p,{children:"(4) Data synchronization and monitoring layer: This layer handles data backup, real-time data synchronization, monitoring, and alerting, ensuring high availability and data integrity of the system."}),"\n",(0,s.jsx)(a.p,{children:"In this architecture, the primary role of OceanBase Database is to provide efficient and stable data storage and processing capabilities."}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.strong,{children:"2.2 Table sharding and distributed architecture design"})}),"\n",(0,s.jsx)(a.p,{children:"OceanBase Database divides a data table into shards based on specific rules and distributes them across multiple nodes. To better fit the needs of the futures trading system, the following sharding and distribution strategies are implemented:"}),"\n",(0,s.jsx)(a.p,{children:"Order table: The order table is sharded by order ID. Shards of different orders are distributed across different physical nodes to prevent any node from being overloaded."}),"\n",(0,s.jsx)(a.p,{children:"Trade record table: This table is sharded by trade time and trading pair, ensuring efficient data locating during queries."}),"\n",(0,s.jsx)(a.p,{children:"Fund flow table: This table is sharded by user ID, allowing for quick access to a user's fund changes."}),"\n",(0,s.jsx)(a.p,{children:"These sharding strategies allow OceanBase Database to deliver excellent query performance while maintaining high availability and scalability."}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.strong,{children:"3. Application of OceanBase Database in Futures Trading"})}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.strong,{children:"3.1 Order processing and transaction management"})}),"\n",(0,s.jsx)(a.p,{children:"In the futures trading system, order processing requires strong data consistency and the atomicity of transactions. OceanBase Database ensures this through its distributed transaction protocol while handling order operations as follows:"}),"\n",(0,s.jsx)(a.p,{children:"Order creation: When a user submits an order, OceanBase Database ensures the order data is successfully written to the database and immediately fed back to the trading system."}),"\n",(0,s.jsx)(a.p,{children:"Order matching and execution: During order matching, OceanBase Database performs joint queries on multiple tables such as the order table and trade record table, while maintaining data consistency to avoid matching failures or inconsistencies."}),"\n",(0,s.jsx)(a.p,{children:"Fund deduction and settlement: The execution of each order involves fund deductions and position updates. OceanBase Database supports cross-table and distributed transactions, ensuring accurate fund settlement and preventing issues like insufficient funds or settlement errors."}),"\n",(0,s.jsx)(a.p,{children:"The transaction management capabilities of OceanBase Database play a crucial role in futures trading, especially in high-concurrency scenarios, where it ensures the consistency of every order and the atomicity of trading operations."}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.strong,{children:"3.2 Optimizations for high-concurrency trading scenarios"})}),"\n",(0,s.jsx)(a.p,{children:"Futures markets experience considerable fluctuations in trading volume and data flow. During periods of high volatility, in particular, the trading system faces rocketing concurrent requests. In response, OceanBase Database implements the following optimizations:"}),"\n",(0,s.jsx)(a.p,{children:"Table sharding: By dividing tables into shards and distributing them across multiple nodes, OceanBase Database parallelizes request processing, avoiding performance bottlenecks on any single node."}),"\n",(0,s.jsx)(a.p,{children:"Multi-level caching: OceanBase Database adopts a multi-level caching mechanism that can cache data in memory and disks. Frequently accessed data, such as real-time market data for certain trading products, is cached to reduce direct database access and improve performance."}),"\n",(0,s.jsx)(a.p,{children:"Query execution: OceanBase Database provides a highly optimized query execution engine. It minimizes the query latency by selecting the optimal execution plan, especially for complex queries and large datasets."}),"\n",(0,s.jsx)(a.p,{children:"These optimizations enable OceanBase Database to maintain a low latency and a high throughput in high-concurrency trading scenarios, ensuring the futures trading system remains stable even under tremendous load."}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.strong,{children:"3.3 High availability and disaster recovery design"})}),"\n",(0,s.jsx)(a.p,{children:"The futures trading system must operate around the clock, making high availability a top priority. OceanBase Database guarantees high availability and disaster recovery by leveraging the following mechanisms:"}),"\n",(0,s.jsx)(a.p,{children:"Multi-replica mechanism: Each data node stores multiple replicas of the data, distributed across different physical servers. If a node fails, OceanBase Database automatically switches to another replica."}),"\n",(0,s.jsx)(a.p,{children:"Automatic fault recovery: Relying on its monitoring and fault detection mechanisms, OceanBase Database quickly identifies node failures and automatically initiates failover and recovery processes."}),"\n",(0,s.jsx)(a.p,{children:"Cross-IDC disaster recovery: To prevent system crashes from single points of failure, OceanBase Database can be deployed in multiple active IDCs across different regions."}),"\n",(0,s.jsx)(a.p,{children:"This high availability and disaster recovery design ensures that the futures trading system remains stable and operational, even in the face of hardware or network failures."})]})}function h(e={}){const{wrapper:a}={...(0,t.R)(),...e.components};return a?(0,s.jsx)(a,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},28453:(e,a,n)=>{n.d(a,{R:()=>r,x:()=>o});var s=n(96540);const t={},i=s.createContext(t);function r(e){const a=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(i.Provider,{value:a},e.children)}}}]);