"use strict";(self.webpackChunkmy_docs_website=self.webpackChunkmy_docs_website||[]).push([[9358],{40875:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>l});var s=n(74848),a=n(28453);const i={title:"Resource Isolation Effects",weight:4},o=void 0,r={id:"user_manual/operation_and_maintenance/en-US/scenario_best_practices/chapter_01_multi_tenants/resource_isolation_within_a_tenant/effect_of_resource_isolation",title:"Resource Isolation Effects",description:"CPU Isolation Effects",source:"@site/docs/user_manual/operation_and_maintenance/en-US/scenario_best_practices/chapter_01_multi_tenants/04_resource_isolation_within_a_tenant/05_effect_of_resource_isolation.md",sourceDirName:"user_manual/operation_and_maintenance/en-US/scenario_best_practices/chapter_01_multi_tenants/04_resource_isolation_within_a_tenant",slug:"/user_manual/operation_and_maintenance/en-US/scenario_best_practices/chapter_01_multi_tenants/resource_isolation_within_a_tenant/effect_of_resource_isolation",permalink:"/docs/user_manual/operation_and_maintenance/en-US/scenario_best_practices/chapter_01_multi_tenants/resource_isolation_within_a_tenant/effect_of_resource_isolation",draft:!1,unlisted:!1,editUrl:"https://github.com/oceanbase/oceanbase.github.io/tree/main/docs/user_manual/operation_and_maintenance/en-US/scenario_best_practices/chapter_01_multi_tenants/04_resource_isolation_within_a_tenant/05_effect_of_resource_isolation.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{title:"Resource Isolation Effects",weight:4},sidebar:"operation_and_maintenanceEnglishSidebar",previous:{title:"Configure Resource Isolation Within a Tenant",permalink:"/docs/user_manual/operation_and_maintenance/en-US/scenario_best_practices/chapter_01_multi_tenants/resource_isolation_within_a_tenant/dbms_resource_manager"},next:{title:"Introduction",permalink:"/docs/user_manual/operation_and_maintenance/en-US/scenario_best_practices/chapter_02_archive_database/introduction"}},c={},l=[{value:"CPU Isolation Effects",id:"cpu-isolation-effects",level:2},{value:"IOPS Isolation Effects",id:"iops-isolation-effects",level:2},{value:"References",id:"references",level:2}];function d(e){const t={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"cpu-isolation-effects",children:"CPU Isolation Effects"}),"\n",(0,s.jsx)(t.p,{children:"We have noted that customers tend to run batch processing tasks during off-peak hours, such as midnight or early morning, when online transaction processing (OLTP) is unlikely affected by online analytical processing (OLAP), and most resources of a cluster can be allocated to OLAP with minimal resources reserved to support essential OLTP tasks. During peak hours in the daytime, the resource isolation plan can be adjusted to ensure sufficient resources for OLTP with minimal resources reserved to support essential OLAP tasks."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"OceanBase Database allows you to set two plans for resource management in the daytime and at night. You can activate the plans as needed to ensure isolation and maximize resource utilization."})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"image",src:n(82459).A+"",width:"707",height:"378"})}),"\n",(0,s.jsx)(t.p,{children:"For example, the following syntax defines a daytime resource plan where OLTP (interactive_group) and OLAP (batch_group) are respectively allocated with 80% and 20% of the resources."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"DBMS_RESOURCE_MANAGER.CREATE_PLAN(\n   PLAN    => 'DAYTIME',\n   COMMENT => 'More resources for OLTP applications');\n\nDBMS_RESOURCE_MANAGER.CREATE_PLAN_DIRECTIVE (\n   PLAN             => 'DAYTIME',\n   GROUP_OR_SUBPLAN => 'interactive_group',\n   COMMENT          => 'OLTP group',\n   MGMT_P1          => 80,\n   UTILIZATION_LIMIT => 100);\n\nDBMS_RESOURCE_MANAGER.CREATE_PLAN_DIRECTIVE (\n   PLAN             => 'DAYTIME',\n   GROUP_OR_SUBPLAN => 'batch_group',\n   COMMENT          => 'OLAP group',\n   MGMT_P1          => 20,\n   UTILIZATION_LIMIT => 20);\n\n-- After the plan is ready, you can execute the following statement to activate it:\nALTER SYSTEM SET RESOURCE_MANAGER_PLAN = 'DAYTIME';\n"})}),"\n",(0,s.jsx)(t.p,{children:"Similarly, you can define a night resource plan and activate it during off-peak hours."}),"\n",(0,s.jsx)(t.p,{children:"OceanBase Database also supports user-based SQL categorization, which makes resource isolation more fine-grained, simple, and effective. You can create a user dedicated to executing analytical SQL queries, so that all SQL queries initiated by this user are processed as OLAP workloads. Furthermore, OceanBase Database identifies requests whose execution time exceeds the specified value, such as 5s, as large queries, and downgrades their priorities."}),"\n",(0,s.jsx)(t.p,{children:"We mentioned that a dedicated user can be created for OLAP. Therefore, create two test users respectively named AP and TP. Bind OLAP tasks to AP_GROUP and OLTP tasks to TP_GROUP. Assume that the test business involves heavy OLTP workloads during daytime and most OLAP workloads are handled at night. Therefore, we set two resource plans for daytime and night. The daytime plan schedules 80% of the resources for OLTP and 20% for OLAP, and the night plan schedules 50% of the resources for OLTP and 50% for OLAP."}),"\n",(0,s.jsx)(t.p,{children:"The test result in the following figure shows that the queries per second (QPS) for OLAP increases significantly while the OLTP QPS decreases after the plan switchover because a larger portion of CPU resources are allocated to OLAP in the night plan. In the following figure, you can see the turning points of OLAP and OLTP QPS curves caused by the plan switchover."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"image",src:n(84896).A+"",width:"1080",height:"521"})}),"\n",(0,s.jsx)(t.p,{children:"It seems that the change in the OLTP QPS is not as noticeable in comparison to OLAP QPS. This is actually a result as expected. The percentage of resources for OLAP is increased from 20% to 50%, an increase of 150%, and that for OLTP is reduced from 80% to 50%, a decrease of 37.5%. In ideal conditions, the QPS fluctuation amplitude of OLTP is smaller than that of OLAP."}),"\n",(0,s.jsx)(t.h2,{id:"iops-isolation-effects",children:"IOPS Isolation Effects"}),"\n",(0,s.jsx)(t.p,{children:"We performed a simulation test to verify the IOPS isolation effects."}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Create four tenants for the simulation test. Each tenant starts 64 threads to send I/O requests that perform 16 KB random reads."}),"\n",(0,s.jsx)(t.li,{children:"The loads of tenants 1, 2, and 4 last for 20 seconds, and the load of tenant 3 begins from the 10th second and lasts for 10 seconds."}),"\n",(0,s.jsx)(t.li,{children:"In this test, the maximum IOPS is about 60,000. Without limitations, any tenant can use up the disk resources."}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["We first verified the disk I/O isolation between tenants. The following figures respectively show the resource configurations and test results of the tenants.\n",(0,s.jsx)(t.img,{alt:"image",src:n(9097).A+"",width:"1820",height:"652"})]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"image",src:n(59126).A+"",width:"1858",height:"1472"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["When the disk resources are used up, the newly joined tenant 3 still has an IOPS of 10,000, which is reserved by using the ",(0,s.jsx)(t.code,{children:"MIN_IOPS"})," parameter."]}),"\n",(0,s.jsxs)(t.li,{children:["The IOPS of tenant 4 does not exceed 5,000 because its maximum IOPS is limited by using the ",(0,s.jsx)(t.code,{children:"MAX_IOPS"})," parameter."]}),"\n",(0,s.jsx)(t.li,{children:"Regardless of the load changes, the IOPS ratio between tenant 1 and tenant 2 is always 2:1 as defined."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Then, we verified the disk I/O isolation between loads in a tenant. Set four types of loads in tenant 2. The following figures respectively show the resource configurations and test results of the loads."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"image",src:n(12927).A+"",width:"1792",height:"628"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"image",src:n(27652).A+"",width:"1698",height:"1370"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["The IOPS of Load B remains about 2,000, even if its weight is 0. This is because 97% of the minimum IOPS resources of the tenant are reserved for Load B by using the ",(0,s.jsx)(t.code,{children:"MIN_PERCENT"})," parameter."]}),"\n",(0,s.jsxs)(t.li,{children:["The IOPS of Load A remains about 1,000. This is because the ",(0,s.jsx)(t.code,{children:"MAX_PERCENT"})," parameter is set to ",(0,s.jsx)(t.code,{children:"1"})," for Load A. In this way, Load A can use only 1% of the maximum resources of the tenant."]}),"\n",(0,s.jsx)(t.li,{children:"The IOPS ratio between Load C and Load D is always 2:1, which conforms to their weight ratio of 50:25."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"The preceding two tests show that OceanBase Database supports disk I/O isolation between tenants and between loads in a tenant, and meets the three isolation semantics of reservation, limitation, and proportion."}),"\n",(0,s.jsx)(t.h2,{id:"references",children:"References"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{href:"https://en.oceanbase.com/blog/2615023872",children:"Why Resource Isolation Matters in Databases: Take HTAP as an Example"})}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.a,{href:"https://open.oceanbase.com/blog/3105048832",children:"Flexible and Simple I/O Isolation Experience"})}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},82459:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/001-57f885f81b24e2445730b2d4d24cae8a.png"},84896:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/002-e0ecec8e243acca24fda007561c308ea.png"},9097:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/003-dc674b5f10754415c0f26b230c48deb0.png"},59126:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/004-8a44757b60215333f3b5fd9bb8a4bb22.png"},12927:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/005-2bac05e1ff249114ea6838d024d2d74c.png"},27652:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/006-981a26f23079407b4f999566f73980bc.png"},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>r});var s=n(96540);const a={},i=s.createContext(a);function o(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);